import{u as oe,a as o,b as ce,j as e,H as me,r as M}from"./app-C4SmtXzs.js";import{D as ue,P as A}from"./DashboardLayout-CMBsVX61.js";import{C}from"./card-CGBAZfCO.js";import{B as S}from"./button-CPi2Vosb.js";import{I as l}from"./input-qDfbrajX.js";import{s as h}from"./use-toast-B9HC7Yw7.js";import{S as he,M as xe}from"./ScaffoldSelector-CnQI66K9.js";import{A as ge}from"./arrow-left-vgf7Q5lf.js";import{T as Q}from"./trash-2-BFFXdZS-.js";import{S as be}from"./save-uAZOBswd.js";/* empty css            */import"./user-BFbh6T51.js";import"./eye-pcZE0Q26.js";function Me({contract:n,customers:B}){const{flash:p}=oe().props,O=B.find(t=>t.id===n.customer_id)||null,[j,P]=o.useState(O?.name||""),[K,f]=o.useState(!1),[N,$]=o.useState(O),[x,v]=o.useState(n.equipment.map(t=>({id:`equipment-${t.id}`,scaffoldId:t.scaffold_id||void 0,scaffold:t.scaffold||null,itemCode:t.item_code||"",itemDescription:t.item_description||"",startDate:t.start_date,endDate:t.end_date,duration:Number(t.duration)||1,durationType:t.duration_type,quantity:Number(t.quantity)||1,dailyRate:Number(t.daily_rate)||0,monthlyRate:Number(t.monthly_rate)||0,total:Number(t.total)||0}))),[_,k]=o.useState(n.payments.length>0?n.payments.map(t=>({id:`payment-${t.id}`,paymentMethod:t.payment_method,paymentDate:t.payment_date,amount:Number(t.amount)||0,checkNumber:t.check_number||"",bankName:t.bank_name||"",checkDate:t.check_date||"",checkImage:null,checkImagePath:t.check_image_path||null})):[{id:Date.now().toString(),paymentMethod:"cash",paymentDate:new Date().toISOString().split("T")[0],amount:0,checkNumber:"",bankName:"",checkDate:"",checkImage:null,checkImagePath:null}]),[w,W]=o.useState(Number(n.transport_and_installation_cost)||0),[D,G]=o.useState(Number(n.total_discount)||0),[y,J]=o.useState(n.delivery_address||""),[I,U]=o.useState(n.location_map_link||"");o.useEffect(()=>{p?.success&&h.success("نجح",p.success),p?.error&&h.error("خطأ",p.error)},[p]);const X=(t,a,s)=>{if(!t||!a)return"";const r=new Date(t);return s==="daily"?r.setDate(r.getDate()+a):r.setMonth(r.getMonth()+a),r.toISOString().split("T")[0]},F=t=>t.durationType==="daily"?t.quantity*t.dailyRate*t.duration:t.quantity*t.monthlyRate*t.duration,g=(t,a,s)=>{v(r=>r.map(d=>{if(d.id===t){const i={...d,[a]:s};return(a==="startDate"||a==="duration"||a==="durationType")&&(i.endDate=X(a==="startDate"?s:i.startDate,a==="duration"?s:i.duration,a==="durationType"?s:i.durationType)),(a==="quantity"||a==="dailyRate"||a==="monthlyRate"||a==="duration"||a==="durationType")&&(i.total=F(i)),i}return d}))},Y=(t,a)=>{v(s=>s.map(r=>r.id===t&&a?{...r,scaffoldId:a.id,scaffold:a,itemCode:a.scaffold_number,itemDescription:a.description_ar||a.description_en||"",dailyRate:a.daily_rental_price||0,monthlyRate:a.monthly_rental_price||0,total:F({...r,dailyRate:a.daily_rental_price||0,monthlyRate:a.monthly_rental_price||0})}:r))},Z=()=>{v(t=>[...t,{id:Date.now().toString(),scaffoldId:void 0,scaffold:null,itemCode:"",itemDescription:"",startDate:new Date().toISOString().split("T")[0],endDate:"",duration:1,durationType:"monthly",quantity:1,dailyRate:0,monthlyRate:0,total:0}])},ee=t=>{v(a=>a.filter(s=>s.id!==t))},te=()=>{k(t=>[...t,{id:Date.now().toString(),paymentMethod:"cash",paymentDate:new Date().toISOString().split("T")[0],amount:0,checkNumber:"",bankName:"",checkDate:"",checkImage:null,checkImagePath:null}])},b=(t,a,s)=>{k(r=>r.map(d=>{if(d.id===t){const i={...d,[a]:s};return a==="paymentMethod"&&s!=="check"&&(i.checkNumber="",i.bankName="",i.checkDate="",i.checkImage=null),i}return d}))},ae=(t,a)=>{k(s=>s.map(r=>r.id===t?{...r,checkImage:a}:r))},se=t=>{k(a=>a.filter(s=>s.id!==t))},L=x.reduce((t,a)=>t+a.total,0)+w-D,E=_.reduce((t,a)=>t+a.amount,0),H=L-E,re=()=>!N||!n.contract_date||!n.contract_number||!y||x.length===0?!1:x.every(t=>t.scaffoldId&&t.startDate&&t.duration>0&&t.quantity>0),{data:le,setData:c,put:ne,processing:R,errors:je}=ce({contract_number:n.contract_number,contract_date:n.contract_date,customer_id:N?.id||"",delivery_address:y,location_map_link:I,transport_and_installation_cost:w,total_discount:D,contract_notes:n.contract_notes||"",rental_details:x.map(t=>({scaffold_id:t.scaffoldId,item_code:t.itemCode,item_description:t.itemDescription,start_date:t.startDate,end_date:t.endDate,duration:t.duration,duration_type:t.durationType,quantity:t.quantity,daily_rate:t.dailyRate,monthly_rate:t.monthlyRate,total:t.total})),payments:_.map(t=>({payment_method:t.paymentMethod,payment_date:t.paymentDate,amount:t.amount}))}),ie=t=>{if(t.preventDefault(),!re()||!y){h.error("خطأ","يرجى ملء جميع الحقول المطلوبة وإضافة معدة واحدة على الأقل");return}c("customer_id",N?.id||""),c("delivery_address",y),c("location_map_link",I),c("transport_and_installation_cost",w),c("total_discount",D),c("rental_details",x.map(a=>({scaffold_id:a.scaffoldId,item_code:a.itemCode,item_description:a.itemDescription,start_date:a.startDate,end_date:a.endDate,duration:a.duration,duration_type:a.durationType,quantity:a.quantity,daily_rate:a.dailyRate,monthly_rate:a.monthlyRate,total:a.total}))),c("payments",_.map(a=>({payment_method:a.paymentMethod,payment_date:a.paymentDate,amount:a.amount,check_number:a.checkNumber||null,bank_name:a.bankName||null,check_date:a.checkDate||null,check_image:a.checkImage||null}))),ne(`/contracts/${n.id}`,{onSuccess:()=>{h.success("تم التحديث بنجاح","تم تحديث العقد بنجاح"),M.visit("/contracts")},onError:a=>{const s=[],r={customer_id:"العميل",contract_number:"رقم العقد",contract_date:"تاريخ العقد",delivery_address:"عنوان الموقع",location_map_link:"رابط الموقع",transport_and_installation_cost:"تكلفة النقل والتركيب",total_discount:"الخصم الإجمالي",contract_notes:"ملاحظات العقد",rental_details:"تفاصيل الإيجار",scaffold_id:"المعدة",item_code:"رمز المعدة",item_description:"وصف المعدة",start_date:"تاريخ بداية الإيجار",end_date:"تاريخ نهاية الإيجار",duration:"المدة",duration_type:"نوع المدة",quantity:"الكمية",daily_rate:"السعر اليومي",monthly_rate:"السعر الشهري",total:"الإجمالي",payments:"المدفوعات",payment_method:"طريقة الدفع",payment_date:"تاريخ الدفع",amount:"المبلغ",check_number:"رقم الشيك",bank_name:"البنك",check_date:"تاريخ الشيك",check_image:"صورة الشيك"},d=(i,V="")=>{Object.keys(i).forEach(m=>{const T=V?`${V}.${m}`:m,u=i[m];if(Array.isArray(u))u.forEach(q=>{const de=r[m]||r[T]||m;s.push(`${de}: ${q}`)});else if(typeof u=="string"){const q=r[m]||r[T]||m;s.push(`${q}: ${u}`)}else u&&typeof u=="object"&&d(u,T)})};d(a),s.length>0?h.error("خطأ في التحديث",s[0]):a.message?h.error("خطأ في التحديث",a.message):h.error("خطأ في التحديث","يرجى التحقق من البيانات المدخلة")}})},z=B.filter(t=>t.name?.toLowerCase().includes(j.toLowerCase())||t.phone?.includes(j)||t.customer_number?.includes(j));return e.jsxs(ue,{children:[e.jsx(me,{title:"تعديل العقد"}),e.jsxs("div",{className:"space-y-6 pb-8 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>M.visit("/contracts"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 transition-colors",children:[e.jsx(ge,{className:"h-4 w-4"}),"العودة"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"تعديل عقد"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"تعديل عقد تأجير"})]})]})}),e.jsxs("form",{onSubmit:ie,children:[e.jsxs(C,{className:"p-6 mb-6",children:[e.jsx("div",{className:"border-b border-gray-200 pb-4 mb-6",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"معلومات العقد الأساسية"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ العقد *"}),e.jsx(l,{type:"date",value:n.contract_date,readOnly:!0,className:"w-full",dir:"ltr",lang:"en",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم العقد *"}),e.jsx(l,{type:"text",value:n.contract_number,readOnly:!0,className:"w-full",dir:"ltr",lang:"en",required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العميل *"}),e.jsxs("div",{className:"relative",children:[e.jsx(l,{type:"text",value:j||N?.name||"",onChange:t=>{P(t.target.value),f(!0),t.target.value||$(null)},onFocus:()=>f(!0),placeholder:"ابحث عن العميل بالاسم أو الهاتف...",required:!0}),e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),K&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>f(!1)}),e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto z-20",children:z.length>0?z.map(t=>e.jsxs("button",{type:"button",onClick:()=>{$(t),P(t.name),f(!1)},className:"w-full text-right px-4 py-3 hover:bg-[#58d2c8]/10 transition-colors border-b border-gray-100 last:border-b-0",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.name}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[t.customer_number&&e.jsx("div",{className:"text-xs text-gray-600",children:t.customer_number}),t.phone&&e.jsx("div",{className:"text-sm text-gray-500",dir:"ltr",children:t.phone})]})]},t.id)):e.jsx("div",{className:"px-4 py-3 text-center text-gray-500",children:"لا توجد نتائج"})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان الموقع (موقع تنزيل المعدات) *"}),e.jsx(l,{type:"text",value:y,onChange:t=>J(t.target.value),placeholder:"أدخل عنوان موقع تنزيل المعدات",dir:"ltr",lang:"en",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط الموقع قوقل ماب"}),e.jsx(l,{type:"url",value:I,onChange:t=>U(t.target.value),placeholder:"https://maps.google.com/...",dir:"ltr",lang:"en"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"اختياري - يمكنك لصق رابط الموقع من قوقل ماب"})]})]})]}),e.jsxs(C,{className:"p-6 mb-6",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"تفاصيل الإيجار"}),e.jsxs(S,{type:"button",onClick:Z,className:"bg-[#58d2c8] hover:bg-[#4AB8B3] text-white flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"إضافة معدة"]})]}),e.jsx("div",{className:"space-y-6",children:x.map((t,a)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-lg",children:["المعدة ",a+1]}),e.jsx("button",{type:"button",onClick:()=>ee(t.id),className:"text-red-600 hover:text-red-800 hover:bg-red-50 p-2 rounded-lg transition-colors",children:e.jsx(Q,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المعدة *"}),e.jsx(he,{value:t.scaffoldId,onChange:s=>Y(t.id,s),disabled:R})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ بداية الإيجار *"}),e.jsx(l,{type:"date",value:t.startDate,onChange:s=>g(t.id,"startDate",s.target.value),className:"w-full bg-white",dir:"ltr",lang:"en",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدة *"}),e.jsxs("select",{value:t.durationType,onChange:s=>g(t.id,"durationType",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#58d2c8] focus:border-transparent bg-white",required:!0,children:[e.jsx("option",{value:"monthly",children:"شهري"}),e.jsx("option",{value:"daily",children:"يومي"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[t.durationType==="monthly"?"اختر عدد الأشهر":"اختر عدد الأيام"," *"]}),e.jsx(l,{type:"number",value:t.duration,onChange:s=>g(t.id,"duration",Number(s.target.value)),min:"1",placeholder:t.durationType==="monthly"?"بالأشهر":"بالأيام",dir:"ltr",lang:"en",required:!0,className:"bg-white"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t.durationType==="monthly"?"(1 شهر = 30 يوم)":"حساب يومي"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكمية *"}),e.jsx(l,{type:"number",value:t.quantity,onChange:s=>g(t.id,"quantity",Number(s.target.value)),min:"1",dir:"ltr",lang:"en",required:!0,className:"bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الإيجار اليومي (ر.ع)"}),e.jsx(l,{type:"number",value:t.dailyRate,onChange:s=>g(t.id,"dailyRate",Number(s.target.value)),min:"0",step:"0.01",dir:"ltr",lang:"en",className:"bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الإيجار الشهري (ر.ع)"}),e.jsx(l,{type:"number",value:t.monthlyRate,onChange:s=>g(t.id,"monthlyRate",Number(s.target.value)),min:"0",step:"0.01",dir:"ltr",lang:"en",className:"bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ النهاية"}),e.jsx(l,{type:"date",value:t.endDate,className:"w-full bg-gray-100",dir:"ltr",lang:"en",readOnly:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"محسوب تلقائياً"})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الإجمالي (ر.ع)"}),e.jsx(l,{type:"number",value:typeof t.total=="number"?t.total.toFixed(2):Number(t.total||0).toFixed(2),className:"w-full bg-gray-100 font-bold text-[#58d2c8]",dir:"ltr",lang:"en",readOnly:!0})]})]})]},t.id))}),e.jsx("div",{className:"mt-6 p-6 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"قيمة النقل والتحميل والتنزيل (ر.ع)"}),e.jsx(l,{type:"number",value:w,onChange:t=>W(Number(t.target.value)),min:"0",step:"0.01",dir:"ltr",lang:"en",className:"bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"إجمالي الخصم (ر.ع)"}),e.jsx(l,{type:"number",value:D,onChange:t=>G(Number(t.target.value)),min:"0",step:"0.01",dir:"ltr",lang:"en",className:"bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"إجمالي العقد بعد الخصم (ر.ع)"}),e.jsx(l,{type:"number",value:L.toFixed(2),className:"w-full bg-gray-100 font-bold text-[#58d2c8] text-lg",dir:"ltr",lang:"en",readOnly:!0})]})]})})]}),e.jsxs(C,{className:"p-6 mb-6",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"المدفوعات"}),e.jsxs(S,{type:"button",onClick:te,className:"bg-[#58d2c8] hover:bg-[#4AB8B3] text-white flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"إضافة دفعة"]})]}),e.jsx("div",{className:"space-y-4",children:_.map((t,a)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold",children:["الدفعة ",a+1]}),e.jsx("button",{type:"button",onClick:()=>se(t.id),className:"text-red-600 hover:text-red-800 hover:bg-red-50 p-2 rounded-lg transition-colors",children:e.jsx(Q,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"طريقة الدفع"}),e.jsxs("select",{value:t.paymentMethod,onChange:s=>b(t.id,"paymentMethod",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#58d2c8] focus:border-transparent bg-white",children:[e.jsx("option",{value:"cash",children:"نقداً"}),e.jsx("option",{value:"check",children:"شيكات"}),e.jsx("option",{value:"credit_card",children:"بطاقة ائتمان"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الدفع"}),e.jsx(l,{type:"date",value:t.paymentDate,onChange:s=>b(t.id,"paymentDate",s.target.value),className:"w-full bg-white",dir:"ltr",lang:"en"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المبلغ (ر.ع)"}),e.jsx(l,{type:"number",value:t.amount,onChange:s=>b(t.id,"amount",Number(s.target.value)),min:"0",step:"0.01",dir:"ltr",lang:"en",className:"bg-white"})]}),t.paymentMethod==="check"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الشيك"}),e.jsx(l,{type:"text",value:t.checkNumber||"",onChange:s=>b(t.id,"checkNumber",s.target.value),placeholder:"أدخل رقم الشيك",dir:"ltr",lang:"en",className:"bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البنك"}),e.jsxs("select",{value:t.bankName||"",onChange:s=>b(t.id,"bankName",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#58d2c8] focus:border-transparent bg-white",children:[e.jsx("option",{value:"",children:"اختر البنك"}),e.jsx("option",{value:"بنك مسقط",children:"بنك مسقط"}),e.jsx("option",{value:"البنك الوطني العماني",children:"البنك الوطني العماني"}),e.jsx("option",{value:"بنك عمان العربي",children:"بنك عمان العربي"}),e.jsx("option",{value:"بنك الإمارات دبي الوطني",children:"بنك الإمارات دبي الوطني"}),e.jsx("option",{value:"بنك HSBC عمان",children:"بنك HSBC عمان"}),e.jsx("option",{value:"بنك ستاندرد تشارترد",children:"بنك ستاندرد تشارترد"}),e.jsx("option",{value:"بنك المشرق",children:"بنك المشرق"}),e.jsx("option",{value:"بنك أبوظبي الإسلامي",children:"بنك أبوظبي الإسلامي"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الشيك"}),e.jsx(l,{type:"date",value:t.checkDate||"",onChange:s=>b(t.id,"checkDate",s.target.value),className:"w-full bg-white",dir:"ltr",lang:"en"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"صورة الشيك"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{accept:"image/*",className:"hidden",id:`check-image-${t.id}`,type:"file",onChange:s=>{const r=s.target.files?.[0]||null;ae(t.id,r)}}),e.jsxs("label",{htmlFor:`check-image-${t.id}`,className:"cursor-pointer bg-[#58d2c8] text-white px-4 py-2 rounded-lg hover:bg-[#4AB8B3] transition-colors flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"رفع صورة الشيك"]}),t.checkImage&&e.jsx("span",{className:"text-sm text-gray-600",children:t.checkImage.name}),t.checkImagePath&&!t.checkImage&&e.jsx("span",{className:"text-sm text-gray-600",children:"صورة موجودة"})]})})]})]})]})]},t.id))}),e.jsx("div",{className:"mt-6 p-6 bg-green-50 rounded-lg border border-green-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"إجمالي المدفوعات (ر.ع)"}),e.jsx(l,{type:"number",value:E.toFixed(2),className:"w-full bg-gray-100 font-bold text-green-600",dir:"ltr",lang:"en",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المبلغ المتبقي (ر.ع)"}),e.jsx(l,{type:"number",value:H.toFixed(2),className:`w-full bg-gray-100 font-bold ${H>0?"text-orange-600":"text-green-600"}`,dir:"ltr",lang:"en",readOnly:!0})]})]})})]}),e.jsxs(C,{className:"p-6 mb-6",children:[e.jsx("div",{className:"border-b border-gray-200 pb-4 mb-6",children:e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5"}),"ملاحظات العقد"]})}),e.jsx("textarea",{value:le.contract_notes,onChange:t=>c("contract_notes",t.target.value),rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#58d2c8] focus:border-transparent",placeholder:"أدخل أي ملاحظات إضافية حول العقد..."})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(S,{type:"button",variant:"outline",onClick:()=>M.visit("/contracts"),children:"إلغاء"}),e.jsxs(S,{type:"submit",disabled:R,className:"bg-[#58d2c8] hover:bg-[#4AB8B3] text-white flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4"}),R?"جاري الحفظ...":"تخزين بيانات العقد"]})]})]})]})]})}export{Me as default};
