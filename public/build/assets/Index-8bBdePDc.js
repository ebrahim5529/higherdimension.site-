import{u as K,a as d,b as v,j as e,H as L,r as q}from"./app-8gmTTw34.js";import{D as A,K as w,P as U,i as G,a as J}from"./DashboardLayout-DhkYYcHy.js";import{B as r}from"./button-jR2lg-Ad.js";import{I as S}from"./input-BTjsHf1Q.js";import{D as y,b as M,a as T,c as k,d as O,e as P,f as E}from"./dialog-CsJ_Z5g7.js";import{T as Q,a as V,b as u,c as o,d as W,e as n}from"./table-Ci-zSf9g.js";import{C as p,b as f,c as g,a as b,d as X}from"./card-DbSr2bDZ.js";import{s as m}from"./use-toast-C82IQcBD.js";import{S as Y}from"./square-pen-BsQ6z3hd.js";import{T as Z}from"./trash-2-DuAL4r7_.js";/* empty css            */import"./user-DAMzRv9g.js";import"./eye-BHi5eQqe.js";function je({permissions:N,allRoles:ee,stats:D}){const{flash:c}=K().props,[H,h]=d.useState(!1),[F,i]=d.useState(!1),[R,j]=d.useState(!1),[t,x]=d.useState(null),l=v({name:""}),a=v({name:""});d.useEffect(()=>{c?.success&&(m.success("نجح",c.success),h(!1),i(!1),l.reset(),a.reset()),c?.error&&m.error("خطأ",c.error)},[c]);const $=()=>{l.post("/permissions",{onSuccess:()=>{l.reset()}})},B=s=>{x(s),a.setData({name:s.name}),i(!0)},I=()=>{t&&a.put(`/permissions/${t.id}`,{onSuccess:()=>{i(!1),x(null),a.reset()}})},_=s=>{x(s),j(!0)},z=()=>{t&&q.delete(`/permissions/${t.id}`,{onSuccess:()=>{m.success("تم الحذف بنجاح",`تم حذف الصلاحية "${t.name}" بنجاح`),j(!1),x(null)},onError:s=>{m.error("فشل الحذف",s?.message||"حدث خطأ أثناء حذف الصلاحية")}})};return e.jsxs(A,{children:[e.jsx(L,{title:"إدارة الصلاحيات"}),e.jsxs("div",{className:"w-full space-y-6 mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-5 w-5"}),e.jsx("h2",{className:"text-xl font-semibold",children:"إدارة الصلاحيات"})]}),e.jsxs(y,{open:H,onOpenChange:h,children:[e.jsx(M,{asChild:!0,children:e.jsxs(r,{children:[e.jsx(U,{className:"h-4 w-4"}),"إضافة صلاحية جديدة"]})}),e.jsxs(T,{children:[e.jsxs(k,{children:[e.jsx(O,{children:"إضافة صلاحية جديدة"}),e.jsx(P,{children:"قم بإنشاء صلاحية جديدة"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"اسم الصلاحية"}),e.jsx(S,{value:l.data.name,onChange:s=>l.setData("name",s.target.value),placeholder:"مثال: create-users, edit-contracts"}),l.errors.name&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:l.errors.name})]})}),e.jsxs(E,{children:[e.jsx(r,{variant:"outline",onClick:()=>h(!1),children:"إلغاء"}),e.jsx(r,{onClick:$,disabled:l.processing,children:l.processing?"جاري الحفظ...":"حفظ"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(p,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"إجمالي الصلاحيات"}),e.jsx(w,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(b,{children:e.jsx("div",{className:"text-2xl font-bold",children:D.totalPermissions})})]}),e.jsxs(p,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"إجمالي الأدوار"}),e.jsx(G,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(b,{children:e.jsx("div",{className:"text-2xl font-bold",children:D.totalRoles})})]})]}),e.jsxs(p,{children:[e.jsxs(f,{children:[e.jsx(g,{children:"قائمة الصلاحيات"}),e.jsx(X,{children:"إدارة جميع الصلاحيات في النظام"})]}),e.jsx(b,{children:e.jsxs(Q,{children:[e.jsx(V,{children:e.jsxs(u,{children:[e.jsx(o,{children:"اسم الصلاحية"}),e.jsx(o,{children:"عدد الأدوار"}),e.jsx(o,{children:"الأدوار المرتبطة"}),e.jsx(o,{children:"تاريخ الإنشاء"}),e.jsx(o,{className:"text-left",children:"الإجراءات"})]})}),e.jsx(W,{children:N.length===0?e.jsx(u,{children:e.jsx(n,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"لا توجد صلاحيات"})}):N.map(s=>e.jsxs(u,{children:[e.jsx(n,{className:"font-medium",children:s.name}),e.jsx(n,{children:s.roles_count}),e.jsx(n,{children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.roles.length>0?s.roles.map(C=>e.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 rounded",children:C.name},C.id)):e.jsx("span",{className:"text-muted-foreground text-sm",children:"لا توجد أدوار"})})}),e.jsx(n,{children:new Date(s.created_at).toLocaleDateString("ar-SA")}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>B(s),children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>_(s),children:e.jsx(Z,{className:"h-4 w-4 text-red-500"})})]})})]},s.id))})]})})]}),e.jsx(y,{open:F,onOpenChange:i,children:e.jsxs(T,{children:[e.jsxs(k,{children:[e.jsx(O,{children:"تعديل الصلاحية"}),e.jsx(P,{children:"قم بتعديل اسم الصلاحية"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"اسم الصلاحية"}),e.jsx(S,{value:a.data.name,onChange:s=>a.setData("name",s.target.value),placeholder:"مثال: create-users, edit-contracts"}),a.errors.name&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.errors.name})]})}),e.jsxs(E,{children:[e.jsx(r,{variant:"outline",onClick:()=>i(!1),children:"إلغاء"}),e.jsx(r,{onClick:I,disabled:a.processing,children:a.processing?"جاري الحفظ...":"حفظ"})]})]})}),e.jsx(J,{open:R,onOpenChange:j,onConfirm:z,title:"حذف الصلاحية",description:`هل أنت متأكد من حذف الصلاحية "${t?.name}"؟`})]})]})}export{je as default};
