import{a,j as t}from"./app-Csm-iHha.js";import{C as j}from"./combobox-BVmQTM55.js";import{L as c}from"./label-CZ7bTBb5.js";import{T as L}from"./textarea-CyugT-mn.js";import{M as v}from"./map-pin-yOXAGFnc.js";function Q({value:r={},onChange:R,label:b="العنوان",required:N=!1,disabled:h=!1,className:W="",error:w}){const[o,C]=a.useState(r.governorate||""),[n,p]=a.useState(r.wilayat||""),[d,x]=a.useState(r.region||""),[i,k]=a.useState(r.details||""),[S,P]=a.useState([]),[A,E]=a.useState([]),[G,f]=a.useState([]),u=S.find(e=>e.name===o)?.id,y=A.find(e=>e.name===n)?.id,T=S.map(e=>({value:e.name,label:e.name})),z=A.map(e=>({value:e.name,label:e.name})),F=G.map(e=>({value:e.name,label:e.name}));a.useEffect(()=>{C(r.governorate||""),p(r.wilayat||""),x(r.region||""),k(r.details||"")},[r]),a.useEffect(()=>{const e=new AbortController;return(async()=>{try{const s=await fetch("/api/locations/governorates",{signal:e.signal});if(!s.ok)return;const m=await s.json();P(m)}catch(s){s.name!=="AbortError"&&console.error("Failed to load governorates",s)}})(),()=>e.abort()},[]),a.useEffect(()=>{if(!u){E([]),f([]);return}const e=new AbortController;return(async()=>{try{const s=await fetch(`/api/locations/governorates/${u}/wilayats`,{signal:e.signal});if(!s.ok)return;const m=await s.json();E(m)}catch(s){s.name!=="AbortError"&&console.error("Failed to load wilayats",s)}})(),()=>e.abort()},[u]),a.useEffect(()=>{if(!y){f([]);return}const e=new AbortController;return(async()=>{try{const s=await fetch(`/api/locations/wilayats/${y}/regions`,{signal:e.signal});if(!s.ok)return;const m=await s.json();f(m)}catch(s){s.name!=="AbortError"&&console.error("Failed to load regions",s)}})(),()=>e.abort()},[y]);const O=e=>{C(e),p(""),x(""),g({governorate:e,wilayat:"",region:"",details:i})},V=e=>{p(e),x(""),g({governorate:o,wilayat:e,region:"",details:i})},$=e=>{x(e),g({governorate:o,wilayat:n,region:e,details:i})},I=e=>{k(e),g({governorate:o,wilayat:n,region:d,details:e})},g=e=>{const l=[];e.governorate&&l.push(e.governorate),e.wilayat&&l.push(e.wilayat),e.region&&l.push(e.region),e.details&&l.push(e.details);const s=l.join("، ");R({...e,fullAddress:s})};return t.jsxs("div",{className:`space-y-4 ${W}`,children:[b&&t.jsxs(c,{className:"block text-sm font-medium mb-4",children:[b," ",N&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("div",{children:[t.jsxs(c,{className:"block text-sm font-medium mb-1",children:["المحافظة ",N&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("div",{className:"relative",children:[t.jsx(v,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 z-10"}),t.jsx("div",{className:"pr-10",children:t.jsx(j,{options:T,value:o,onValueChange:O,placeholder:"اختر المحافظة",searchPlaceholder:"اكتب للبحث في المحافظات...",emptyText:"لم يتم العثور على محافظة",disabled:h,className:"rtl:text-right"})})]})]}),o&&t.jsxs("div",{children:[t.jsx(c,{className:"block text-sm font-medium mb-1",children:"الولاية"}),t.jsxs("div",{className:"relative",children:[t.jsx(v,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 z-10"}),t.jsx("div",{className:"pr-10",children:t.jsx(j,{options:z,value:n,onValueChange:V,placeholder:"اختر الولاية",searchPlaceholder:"اكتب للبحث في الولايات...",emptyText:"لم يتم العثور على ولاية",disabled:h||!o,className:"rtl:text-right"})})]})]}),n&&G.length>0&&t.jsxs("div",{children:[t.jsx(c,{className:"block text-sm font-medium mb-1",children:"المنطقة"}),t.jsxs("div",{className:"relative",children:[t.jsx(v,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 z-10"}),t.jsx("div",{className:"pr-10",children:t.jsx(j,{options:F,value:d,onValueChange:$,placeholder:"اختر المنطقة",searchPlaceholder:"اكتب للبحث في المناطق...",emptyText:"لم يتم العثور على منطقة",disabled:h||!n,className:"rtl:text-right"})})]})]}),t.jsxs("div",{children:[t.jsx(c,{className:"block text-sm font-medium mb-1",children:"تفاصيل العنوان الإضافية (اختياري)"}),t.jsx(L,{value:i,onChange:e=>I(e.target.value),disabled:h,placeholder:"أدخل تفاصيل إضافية للعنوان مثل الشارع، الرقم، إلخ...",rows:2,className:"rtl:text-right resize-none"})]}),w&&t.jsx("p",{className:"text-red-500 text-xs mt-1",children:w}),(o||n||d||i)&&t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 border",children:[t.jsx(c,{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:"معاينة العنوان:"}),t.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-100 rtl:text-right",children:o||n||d||i?[o,n,d,i].filter(Boolean).join("، "):"لم يتم تحديد عنوان بعد"})]})]})}export{Q as A};
