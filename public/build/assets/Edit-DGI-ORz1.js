import{u as N,r as j,b as f,j as e,H as _,a as p}from"./app-CCHA9ub0.js";import{D as C,d as o}from"./DashboardLayout-BHw3dqES.js";import{C as k,b as w,c as E,a as T}from"./card-Bly1X19M.js";import{B as h}from"./button-Bfv0f9vZ.js";import{I as i}from"./input-BoE7gBrx.js";import{s as m}from"./use-toast-CTmzR8DA.js";import{C as b}from"./combobox-COueL2o-.js";import{A as D}from"./arrow-left-BGILhFGb.js";import{F as S}from"./file-text-CauxPHHp.js";import{S as A}from"./save-CMZXevOX.js";/* empty css            */import"./createLucideIcon-FmD0vq03.js";import"./triangle-alert-DWFl2Smt.js";import"./eye-8DxskOvD.js";import"./shield-CQHunxOJ.js";import"./circle-alert-CjQBNfBa.js";import"./map-pin-DHI_P5OF.js";import"./mail-9UAeJwq9.js";import"./dialog-D2ksYsD7.js";import"./index-BwODn1jo.js";import"./check-BTL3kle7.js";const P=[{value:"ANNUAL",label:"سنوية"},{value:"SICK",label:"مرضية"},{value:"EMERGENCY",label:"طارئة"},{value:"MATERNITY",label:"أمومة"},{value:"PATERNITY",label:"أبوة"},{value:"UNPAID",label:"بدون راتب"},{value:"OTHER",label:"أخرى"}];function ee({leave:l,employees:v}){const{flash:n}=N().props;j.useEffect(()=>{n?.success&&m.success("نجح",n.success),n?.error&&m.error("خطأ",n.error)},[n]);const{data:s,setData:r,put:g,processing:x,errors:t}=f({employee_id:l.employee_id.toString(),leave_type:l.leave_type,start_date:l.start_date,end_date:l.end_date,total_days:l.total_days.toString(),reason:l.reason,status:l.status,applied_date:l.applied_date,approved_by:l.approved_by||"",approved_date:l.approved_date||"",remaining_balance:l.remaining_balance?.toString()||"",notes:l.notes||""});j.useEffect(()=>{if(s.start_date&&s.end_date){const a=new Date(s.start_date),d=new Date(s.end_date),c=Math.abs(d.getTime()-a.getTime()),u=Math.ceil(c/(1e3*60*60*24))+1;u>0&&r("total_days",u.toString())}},[s.start_date,s.end_date]);const y=a=>{a.preventDefault();const d={...s};d.approved_by||delete d.approved_by,d.approved_date||delete d.approved_date,d.remaining_balance||delete d.remaining_balance,d.notes||delete d.notes,g(`/employees/leaves/${l.id}`,{data:d,onSuccess:()=>{m.success("تم التحديث بنجاح","تم تحديث الإجازة بنجاح"),p.visit(`/employees/leaves/${l.id}`)},onError:c=>{c.message?m.error("خطأ في التحديث",c.message):m.error("خطأ في التحديث","يرجى التحقق من البيانات المدخلة")}})};return e.jsxs(C,{children:[e.jsx(_,{title:"تعديل الإجازة"}),e.jsxs("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>p.visit("/employees/leaves"),children:e.jsx(D,{className:"h-4 w-4"})}),e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(o,{className:"h-6 w-6"}),"تعديل الإجازة"]})]})}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs(k,{children:[e.jsx(w,{children:e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5"}),"معلومات الإجازة"]})}),e.jsx(T,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الموظف ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(b,{options:v.map(a=>({value:a.id.toString(),label:`${a.name} (${a.employee_number})`})),value:s.employee_id,onValueChange:a=>r("employee_id",a),placeholder:"اختر الموظف",searchPlaceholder:"ابحث عن الموظف...",emptyText:"لا يوجد موظفين",error:!!t.employee_id}),t.employee_id&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.employee_id})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["نوع الإجازة ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(b,{options:P.map(a=>({value:a.value,label:a.label})),value:s.leave_type,onValueChange:a=>r("leave_type",a),placeholder:"اختر نوع الإجازة",searchPlaceholder:"ابحث...",emptyText:"لا توجد نتائج"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["تاريخ البدء ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(i,{type:"date",value:s.start_date,onChange:a=>r("start_date",a.target.value),className:`pr-10 ${t.start_date?"border-red-500":""}`})]}),t.start_date&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.start_date})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["تاريخ الانتهاء ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(i,{type:"date",value:s.end_date,onChange:a=>r("end_date",a.target.value),min:s.start_date,className:`pr-10 ${t.end_date?"border-red-500":""}`})]}),t.end_date&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.end_date})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["عدد الأيام ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(i,{type:"number",min:"1",value:s.total_days,onChange:a=>r("total_days",a.target.value),placeholder:"0",className:t.total_days?"border-red-500":"",readOnly:!0}),t.total_days&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.total_days})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["تاريخ التقديم ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(i,{type:"date",value:s.applied_date,onChange:a=>r("applied_date",a.target.value),className:`pr-10 ${t.applied_date?"border-red-500":""}`})]}),t.applied_date&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.applied_date})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الحالة ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(b,{options:[{value:"PENDING",label:"في الانتظار"},{value:"APPROVED",label:"موافق عليه"},{value:"REJECTED",label:"مرفوض"},{value:"CANCELLED",label:"ملغاة"}],value:s.status,onValueChange:a=>r("status",a),placeholder:"اختر الحالة",searchPlaceholder:"ابحث...",emptyText:"لا توجد نتائج"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"الموافق عليه من"}),e.jsx(i,{type:"text",value:s.approved_by,onChange:a=>r("approved_by",a.target.value),placeholder:"اسم الموافق"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"تاريخ الموافقة"}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(i,{type:"date",value:s.approved_date,onChange:a=>r("approved_date",a.target.value),className:"pr-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"الرصيد المتبقي"}),e.jsx(i,{type:"number",min:"0",value:s.remaining_balance,onChange:a=>r("remaining_balance",a.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["السبب ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute right-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("textarea",{value:s.reason,onChange:a=>r("reason",a.target.value),rows:3,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-800 dark:text-white ${t.reason?"border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"أدخل سبب الإجازة"})]}),t.reason&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.reason})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"ملاحظات"}),e.jsx("textarea",{value:s.notes,onChange:a=>r("notes",a.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-800 dark:text-white",placeholder:"أدخل أي ملاحظات عن الإجازة"})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-6 border-t",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>p.visit("/employees/leaves"),disabled:x,children:"إلغاء"}),e.jsxs(h,{type:"submit",disabled:x,className:"flex items-center gap-2 bg-[#913D95] hover:bg-[#7A2F7D]",children:[e.jsx(A,{className:"h-4 w-4"}),x?"جاري الحفظ...":"حفظ التعديلات"]})]})]})]})]})}export{ee as default};
