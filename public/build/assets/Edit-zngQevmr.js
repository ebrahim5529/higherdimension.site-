import{u as ce,a as o,b as me,j as e,H as ue,r as A}from"./app-C70Abe0W.js";import{D as xe,P as B}from"./DashboardLayout-8rtCQFVU.js";import{C as S}from"./card-BTIRbnZg.js";import{B as I,c as x}from"./button-B4Y0xaOj.js";import{I as n}from"./input-Bs6uNltf.js";import{s as h}from"./use-toast-CTaqu0GZ.js";import{S as he,M as ge}from"./ScaffoldSelector-x_Yn_uje.js";import{A as be}from"./arrow-left-CwJtPsZh.js";import{T as K}from"./trash-2-Cifjh1NI.js";import{S as pe}from"./save-DzLqkQqm.js";/* empty css            */import"./createLucideIcon-CekqwaTN.js";import"./triangle-alert-BCnpIywG.js";import"./file-text-DAs24fQX.js";import"./eye-pG0WJNoF.js";import"./user-Czo5kvKo.js";function Pe({contract:i,customers:O}){const{flash:y}=ce().props,P=O.find(t=>t.id===i.customer_id)||null,[v,$]=o.useState(P?.name||""),[W,f]=o.useState(!1),[N,F]=o.useState(P),[g,_]=o.useState(i.equipment.map(t=>({id:`equipment-${t.id}`,scaffoldId:t.scaffold_id||void 0,scaffold:t.scaffold||null,itemCode:t.item_code||"",itemDescription:t.item_description||"",startDate:t.start_date,endDate:t.end_date,duration:Number(t.duration)||1,durationType:t.duration_type,quantity:Number(t.quantity)||1,dailyRate:Number(t.daily_rate)||0,monthlyRate:Number(t.monthly_rate)||0,total:Number(t.total)||0}))),[k,w]=o.useState(i.payments.length>0?i.payments.map(t=>({id:`payment-${t.id}`,paymentMethod:t.payment_method,paymentDate:t.payment_date,amount:Number(t.amount)||0,checkNumber:t.check_number||"",bankName:t.bank_name||"",checkDate:t.check_date||"",checkImage:null,checkImagePath:t.check_image_path||null})):[{id:Date.now().toString(),paymentMethod:"cash",paymentDate:new Date().toISOString().split("T")[0],amount:0,checkNumber:"",bankName:"",checkDate:"",checkImage:null,checkImagePath:null}]),[D,G]=o.useState(Number(i.transport_and_installation_cost)||0),[C,J]=o.useState(Number(i.total_discount)||0),[j,U]=o.useState(i.delivery_address||""),[T,X]=o.useState(i.location_map_link||"");o.useEffect(()=>{y?.success&&h.success("نجح",y.success),y?.error&&h.error("خطأ",y.error)},[y]);const Y=(t,a,s)=>{if(!t||!a)return"";const l=new Date(t);return s==="daily"?l.setDate(l.getDate()+a):l.setMonth(l.getMonth()+a),l.toISOString().split("T")[0]},E=t=>t.durationType==="daily"?t.quantity*t.dailyRate*t.duration:t.quantity*t.monthlyRate*t.duration,b=(t,a,s)=>{_(l=>l.map(r=>{if(r.id===t){const d={...r,[a]:s};return(a==="startDate"||a==="duration"||a==="durationType")&&(d.endDate=Y(a==="startDate"?s:d.startDate,a==="duration"?s:d.duration,a==="durationType"?s:d.durationType)),(a==="quantity"||a==="dailyRate"||a==="monthlyRate"||a==="duration"||a==="durationType")&&(d.total=E(d)),d}return r}))},Z=(t,a)=>{_(s=>s.map(l=>l.id===t&&a?{...l,scaffoldId:a.id,scaffold:a,itemCode:a.scaffold_number,itemDescription:a.description_ar||a.description_en||"",dailyRate:a.daily_rental_price||0,monthlyRate:a.monthly_rental_price||0,total:E({...l,dailyRate:a.daily_rental_price||0,monthlyRate:a.monthly_rental_price||0})}:l))},ee=()=>{_(t=>[...t,{id:Date.now().toString(),scaffoldId:void 0,scaffold:null,itemCode:"",itemDescription:"",startDate:new Date().toISOString().split("T")[0],endDate:"",duration:1,durationType:"monthly",quantity:1,dailyRate:0,monthlyRate:0,total:0}])},te=t=>{_(a=>a.filter(s=>s.id!==t))},ae=()=>{w(t=>[...t,{id:Date.now().toString(),paymentMethod:"cash",paymentDate:new Date().toISOString().split("T")[0],amount:0,checkNumber:"",bankName:"",checkDate:"",checkImage:null,checkImagePath:null}])},p=(t,a,s)=>{w(l=>l.map(r=>{if(r.id===t){const d={...r,[a]:s};return a==="paymentMethod"&&s!=="check"&&(d.checkNumber="",d.bankName="",d.checkDate="",d.checkImage=null),d}return r}))},se=(t,a)=>{w(s=>s.map(l=>l.id===t?{...l,checkImage:a}:l))},le=t=>{w(a=>a.filter(s=>s.id!==t))},L=g.reduce((t,a)=>t+a.total,0)+D-C,V=k.reduce((t,a)=>t+a.amount,0),H=L-V,re=()=>!N||!i.contract_date||!i.contract_number||!j||g.length===0?!1:g.every(t=>t.scaffoldId&&t.startDate&&t.duration>0&&t.quantity>0),{data:ne,setData:c,put:ie,processing:R,errors:ve}=me({contract_number:i.contract_number,contract_date:i.contract_date,customer_id:N?.id||"",delivery_address:j,location_map_link:T,transport_and_installation_cost:D,total_discount:C,contract_notes:i.contract_notes||"",rental_details:g.map(t=>({scaffold_id:t.scaffoldId,item_code:t.itemCode,item_description:t.itemDescription,start_date:t.startDate,end_date:t.endDate,duration:t.duration,duration_type:t.durationType,quantity:t.quantity,daily_rate:t.dailyRate,monthly_rate:t.monthlyRate,total:t.total})),payments:k.map(t=>({payment_method:t.paymentMethod,payment_date:t.paymentDate,amount:t.amount}))}),de=t=>{if(t.preventDefault(),!re()||!j){h.error("خطأ","يرجى ملء جميع الحقول المطلوبة وإضافة معدة واحدة على الأقل");return}c("customer_id",N?.id||""),c("delivery_address",j),c("location_map_link",T),c("transport_and_installation_cost",D),c("total_discount",C),c("rental_details",g.map(a=>({scaffold_id:a.scaffoldId,item_code:a.itemCode,item_description:a.itemDescription,start_date:a.startDate,end_date:a.endDate,duration:a.duration,duration_type:a.durationType,quantity:a.quantity,daily_rate:a.dailyRate,monthly_rate:a.monthlyRate,total:a.total}))),c("payments",k.map(a=>({payment_method:a.paymentMethod,payment_date:a.paymentDate,amount:a.amount,check_number:a.checkNumber||null,bank_name:a.bankName||null,check_date:a.checkDate||null,check_image:a.checkImage||null}))),ie(`/contracts/${i.id}`,{onSuccess:()=>{h.success("تم التحديث بنجاح","تم تحديث العقد بنجاح"),A.visit("/contracts")},onError:a=>{const s=[],l={customer_id:"العميل",contract_number:"رقم العقد",contract_date:"تاريخ العقد",delivery_address:"عنوان الموقع",location_map_link:"رابط الموقع",transport_and_installation_cost:"تكلفة النقل والتركيب",total_discount:"الخصم الإجمالي",contract_notes:"ملاحظات العقد",rental_details:"تفاصيل الإيجار",scaffold_id:"المعدة",item_code:"رمز المعدة",item_description:"وصف المعدة",start_date:"تاريخ بداية الإيجار",end_date:"تاريخ نهاية الإيجار",duration:"المدة",duration_type:"نوع المدة",quantity:"الكمية",daily_rate:"السعر اليومي",monthly_rate:"السعر الشهري",total:"الإجمالي",payments:"المدفوعات",payment_method:"طريقة الدفع",payment_date:"تاريخ الدفع",amount:"المبلغ",check_number:"رقم الشيك",bank_name:"البنك",check_date:"تاريخ الشيك",check_image:"صورة الشيك"},r=(d,Q="")=>{Object.keys(d).forEach(m=>{const q=Q?`${Q}.${m}`:m,u=d[m];if(Array.isArray(u))u.forEach(M=>{const oe=l[m]||l[q]||m;s.push(`${oe}: ${M}`)});else if(typeof u=="string"){const M=l[m]||l[q]||m;s.push(`${M}: ${u}`)}else u&&typeof u=="object"&&r(u,q)})};r(a),s.length>0?h.error("خطأ في التحديث",s[0]):a.message?h.error("خطأ في التحديث",a.message):h.error("خطأ في التحديث","يرجى التحقق من البيانات المدخلة")}})},z=O.filter(t=>t.name?.toLowerCase().includes(v.toLowerCase())||t.phone?.includes(v)||t.customer_number?.includes(v));return e.jsxs(xe,{children:[e.jsx(ue,{title:"تعديل العقد"}),e.jsxs("div",{className:"space-y-6 pb-8 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>A.visit("/contracts"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 transition-colors",children:[e.jsx(be,{className:"h-4 w-4"}),"العودة"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"تعديل عقد"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"تعديل عقد تأجير"})]})]})}),e.jsxs("form",{onSubmit:de,children:[e.jsxs(S,{className:"p-6 mb-6",children:[e.jsx("div",{className:"border-b border-gray-200 pb-4 mb-6",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"معلومات العقد الأساسية"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ العقد *"}),e.jsx(n,{type:"date",value:i.contract_date,readOnly:!0,className:"w-full",dir:"ltr",lang:"en",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم العقد *"}),e.jsx(n,{type:"text",value:i.contract_number,readOnly:!0,className:"w-full",dir:"ltr",lang:"en",required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العميل *"}),e.jsxs("div",{className:"relative",children:[e.jsx(n,{type:"text",value:v||N?.name||"",onChange:t=>{$(t.target.value),f(!0),t.target.value||F(null)},onFocus:()=>f(!0),placeholder:"ابحث عن العميل بالاسم أو الهاتف...",required:!0}),e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),W&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>f(!1)}),e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto z-20",children:z.length>0?z.map(t=>e.jsxs("button",{type:"button",onClick:()=>{F(t),$(t.name),f(!1)},className:"w-full text-right px-4 py-3 hover:bg-[#58d2c8]/10 transition-colors border-b border-gray-100 last:border-b-0",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.name}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[t.customer_number&&e.jsx("div",{className:"text-xs text-gray-600",children:t.customer_number}),t.phone&&e.jsx("div",{className:"text-sm text-gray-500",dir:"ltr",children:t.phone})]})]},t.id)):e.jsx("div",{className:"px-4 py-3 text-center text-gray-500",children:"لا توجد نتائج"})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان الموقع (موقع تنزيل المعدات) *"}),e.jsx(n,{type:"text",value:j,onChange:t=>U(t.target.value),placeholder:"أدخل عنوان موقع تنزيل المعدات",dir:"ltr",lang:"en",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط الموقع قوقل ماب"}),e.jsx(n,{type:"url",value:T,onChange:t=>X(t.target.value),placeholder:"https://maps.google.com/...",dir:"ltr",lang:"en"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"اختياري - يمكنك لصق رابط الموقع من قوقل ماب"})]})]})]}),e.jsxs(S,{className:"p-6 mb-6",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"تفاصيل الإيجار"}),e.jsxs(I,{type:"button",onClick:ee,className:"bg-[#58d2c8] hover:bg-[#4AB8B3] text-white flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"إضافة معدة"]})]}),e.jsx("div",{className:"space-y-6",children:g.map((t,a)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-lg",children:["المعدة ",a+1]}),e.jsx("button",{type:"button",onClick:()=>te(t.id),className:"text-red-600 hover:text-red-800 hover:bg-red-50 p-2 rounded-lg transition-colors",children:e.jsx(K,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المعدة *"}),e.jsx(he,{value:t.scaffoldId,onChange:s=>Z(t.id,s),disabled:R})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ بداية الإيجار *"}),e.jsx(n,{type:"date",value:t.startDate,onChange:s=>b(t.id,"startDate",s.target.value),className:"w-full bg-white",dir:"ltr",lang:"en",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدة *"}),e.jsxs("select",{value:t.durationType,onChange:s=>b(t.id,"durationType",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#58d2c8] focus:border-transparent bg-white",required:!0,children:[e.jsx("option",{value:"monthly",children:"شهري"}),e.jsx("option",{value:"daily",children:"يومي"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[t.durationType==="monthly"?"اختر عدد الأشهر":"اختر عدد الأيام"," *"]}),e.jsx(n,{type:"text",value:t.duration,onChange:s=>{const l=x(s.target.value);s.target.value=l;const r=l===""?0:Number(l)||0;b(t.id,"duration",r)},placeholder:t.durationType==="monthly"?"بالأشهر":"بالأيام",dir:"ltr",lang:"en",required:!0,className:"bg-white"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t.durationType==="monthly"?"(1 شهر = 30 يوم)":"حساب يومي"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكمية *"}),e.jsx(n,{type:"text",value:t.quantity,onChange:s=>{const l=x(s.target.value);s.target.value=l;const r=l===""?0:Number(l)||0;!isNaN(r)&&r>=0&&b(t.id,"quantity",r)},dir:"ltr",lang:"en",required:!0,className:"bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الإيجار اليومي (ر.ع)"}),e.jsx(n,{type:"text",value:t.dailyRate,onChange:s=>{const l=x(s.target.value);s.target.value=l;const r=l===""?0:Number(l)||0;b(t.id,"dailyRate",r)},dir:"ltr",lang:"en",className:"bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الإيجار الشهري (ر.ع)"}),e.jsx(n,{type:"text",value:t.monthlyRate,onChange:s=>{const l=x(s.target.value);s.target.value=l;const r=l===""?0:Number(l)||0;b(t.id,"monthlyRate",r)},dir:"ltr",lang:"en",className:"bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ النهاية"}),e.jsx(n,{type:"date",value:t.endDate,className:"w-full bg-gray-100",dir:"ltr",lang:"en",readOnly:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"محسوب تلقائياً"})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الإجمالي (ر.ع)"}),e.jsx(n,{type:"text",value:typeof t.total=="number"?t.total.toFixed(2):Number(t.total||0).toFixed(2),className:"w-full bg-gray-100 font-bold text-[#58d2c8]",dir:"ltr",lang:"en",readOnly:!0})]})]})]},t.id))}),e.jsx("div",{className:"mt-6 p-6 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"قيمة النقل والتحميل والتنزيل (ر.ع)"}),e.jsx(n,{type:"text",value:D,onChange:t=>{const a=x(t.target.value);t.target.value=a;const s=a===""?0:Number(a)||0;G(s)},dir:"ltr",lang:"en",className:"bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"إجمالي الخصم (ر.ع)"}),e.jsx(n,{type:"text",value:C,onChange:t=>{const a=x(t.target.value);t.target.value=a;const s=a===""?0:Number(a)||0;J(s)},dir:"ltr",lang:"en",className:"bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"إجمالي العقد بعد الخصم (ر.ع)"}),e.jsx(n,{type:"text",value:L.toFixed(2),className:"w-full bg-gray-100 font-bold text-[#58d2c8] text-lg",dir:"ltr",lang:"en",readOnly:!0})]})]})})]}),e.jsxs(S,{className:"p-6 mb-6",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"المدفوعات"}),e.jsxs(I,{type:"button",onClick:ae,className:"bg-[#58d2c8] hover:bg-[#4AB8B3] text-white flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"إضافة دفعة"]})]}),e.jsx("div",{className:"space-y-4",children:k.map((t,a)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold",children:["الدفعة ",a+1]}),e.jsx("button",{type:"button",onClick:()=>le(t.id),className:"text-red-600 hover:text-red-800 hover:bg-red-50 p-2 rounded-lg transition-colors",children:e.jsx(K,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"طريقة الدفع"}),e.jsxs("select",{value:t.paymentMethod,onChange:s=>p(t.id,"paymentMethod",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#58d2c8] focus:border-transparent bg-white",children:[e.jsx("option",{value:"cash",children:"نقداً"}),e.jsx("option",{value:"check",children:"شيكات"}),e.jsx("option",{value:"credit_card",children:"بطاقة ائتمان"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الدفع"}),e.jsx(n,{type:"date",value:t.paymentDate,onChange:s=>p(t.id,"paymentDate",s.target.value),className:"w-full bg-white",dir:"ltr",lang:"en"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المبلغ (ر.ع)"}),e.jsx(n,{type:"text",value:t.amount,onChange:s=>{const l=x(s.target.value);s.target.value=l;const r=l===""?0:Number(l)||0;p(t.id,"amount",r)},min:"0",step:"0.01",dir:"ltr",lang:"en",className:"bg-white"})]}),t.paymentMethod==="check"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الشيك"}),e.jsx(n,{type:"text",value:t.checkNumber||"",onChange:s=>p(t.id,"checkNumber",s.target.value),placeholder:"أدخل رقم الشيك",dir:"ltr",lang:"en",className:"bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البنك"}),e.jsxs("select",{value:t.bankName||"",onChange:s=>p(t.id,"bankName",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#58d2c8] focus:border-transparent bg-white",children:[e.jsx("option",{value:"",children:"اختر البنك"}),e.jsx("option",{value:"بنك مسقط",children:"بنك مسقط"}),e.jsx("option",{value:"البنك الوطني العماني",children:"البنك الوطني العماني"}),e.jsx("option",{value:"بنك عمان العربي",children:"بنك عمان العربي"}),e.jsx("option",{value:"بنك الإمارات دبي الوطني",children:"بنك الإمارات دبي الوطني"}),e.jsx("option",{value:"بنك HSBC عمان",children:"بنك HSBC عمان"}),e.jsx("option",{value:"بنك ستاندرد تشارترد",children:"بنك ستاندرد تشارترد"}),e.jsx("option",{value:"بنك المشرق",children:"بنك المشرق"}),e.jsx("option",{value:"بنك أبوظبي الإسلامي",children:"بنك أبوظبي الإسلامي"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الشيك"}),e.jsx(n,{type:"date",value:t.checkDate||"",onChange:s=>p(t.id,"checkDate",s.target.value),className:"w-full bg-white",dir:"ltr",lang:"en"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"صورة الشيك"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{accept:"image/*",className:"hidden",id:`check-image-${t.id}`,type:"file",onChange:s=>{const l=s.target.files?.[0]||null;se(t.id,l)}}),e.jsxs("label",{htmlFor:`check-image-${t.id}`,className:"cursor-pointer bg-[#58d2c8] text-white px-4 py-2 rounded-lg hover:bg-[#4AB8B3] transition-colors flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),"رفع صورة الشيك"]}),t.checkImage&&e.jsx("span",{className:"text-sm text-gray-600",children:t.checkImage.name}),t.checkImagePath&&!t.checkImage&&e.jsx("span",{className:"text-sm text-gray-600",children:"صورة موجودة"})]})})]})]})]})]},t.id))}),e.jsx("div",{className:"mt-6 p-6 bg-green-50 rounded-lg border border-green-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"إجمالي المدفوعات (ر.ع)"}),e.jsx(n,{type:"text",value:V.toFixed(2),className:"w-full bg-gray-100 font-bold text-green-600",dir:"ltr",lang:"en",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المبلغ المتبقي (ر.ع)"}),e.jsx(n,{type:"text",value:H.toFixed(2),className:`w-full bg-gray-100 font-bold ${H>0?"text-orange-600":"text-green-600"}`,dir:"ltr",lang:"en",readOnly:!0})]})]})})]}),e.jsxs(S,{className:"p-6 mb-6",children:[e.jsx("div",{className:"border-b border-gray-200 pb-4 mb-6",children:e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(ge,{className:"h-5 w-5"}),"ملاحظات العقد"]})}),e.jsx("textarea",{value:ne.contract_notes,onChange:t=>c("contract_notes",t.target.value),rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#58d2c8] focus:border-transparent",placeholder:"أدخل أي ملاحظات إضافية حول العقد..."})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>A.visit("/contracts"),children:"إلغاء"}),e.jsxs(I,{type:"submit",disabled:R,className:"bg-[#58d2c8] hover:bg-[#4AB8B3] text-white flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),R?"جاري الحفظ...":"تخزين بيانات العقد"]})]})]})]})]})}export{Pe as default};
