import{u as G,a as t,j as e,H,r as m}from"./app-Csm-iHha.js";import{D as M,P as y,X as $}from"./DashboardLayout-Cv7OrucU.js";import{C,b as k,c as w,a as S}from"./card-DK7p6fT7.js";import{B as i}from"./button-BD60Hi05.js";import{I}from"./input-D_EIzP2p.js";import{s as E}from"./use-toast-6Skx-iq7.js";import{M as B}from"./map-pin-yOXAGFnc.js";import{P as W}from"./pencil-45k8nAX0.js";import{T as F}from"./trash-2-Dd8nnOYp.js";/* empty css            */import"./createLucideIcon-C6GUZ6dL.js";import"./triangle-alert-BmMxnEwo.js";import"./file-text-DQNSwVpm.js";import"./eye-BT0mqwWW.js";import"./mail-BKjau6ij.js";function ae(){const{governorates:o,wilayats:x,errors:r,flash:l}=G().props,[h,p]=t.useState(""),[u,j]=t.useState(""),[n,g]=t.useState(null),[N,d]=t.useState(""),[f,c]=t.useState(""),b=t.useMemo(()=>[...x||[]].sort((s,a)=>s.name.localeCompare(a.name)),[x]);t.useEffect(()=>{l?.success&&E.success("تم بنجاح",l.success),l?.error&&E.error("خطأ",l.error)},[l]);const _=()=>{p(""),j("")},P=s=>{s.preventDefault(),m.post("/locations/wilayats",{name:h,governorate_id:Number(u)},{onSuccess:()=>_()})},D=s=>{g(s.id),d(s.name),c(String(s.governorate_id))},v=()=>{g(null),d(""),c("")},z=s=>{s.preventDefault(),n&&m.put(`/locations/wilayats/${n}`,{name:N,governorate_id:Number(f)},{onSuccess:()=>v()})},T=s=>{confirm("هل أنت متأكد من حذف هذه الولاية؟ سيتم حذف المناطق التابعة لها.")&&m.delete(`/locations/wilayats/${s}`)};return e.jsxs(M,{children:[e.jsx(H,{title:"الولايات"}),e.jsxs("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"الولايات"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"إدارة الولايات المرتبطة بالمحافظات"})]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5"}),"إضافة ولاية"]})}),e.jsx(S,{children:e.jsxs("form",{onSubmit:P,className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["اسم الولاية ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(I,{value:h,onChange:s=>p(s.target.value),placeholder:"مثال: ولاية سمائل",className:r?.name?"border-red-500":""}),r?.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["المحافظة ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:u,onChange:s=>j(s.target.value),className:`w-full h-10 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 text-sm ${r?.governorate_id?"border-red-500":""}`,children:[e.jsx("option",{value:"",children:"اختر المحافظة"}),o?.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),r?.governorate_id&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.governorate_id})]}),e.jsx("div",{className:"md:col-span-3",children:e.jsxs(i,{type:"submit",className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),"إضافة"]})})]})})]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5"}),"قائمة الولايات"]})}),e.jsx(S,{className:"space-y-4",children:b.length===0?e.jsx("div",{className:"text-sm text-gray-500",children:"لا توجد ولايات بعد."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-gray-500 border-b",children:[e.jsx("th",{className:"text-right py-2 px-3",children:"الولاية"}),e.jsx("th",{className:"text-right py-2 px-3",children:"المحافظة"}),e.jsx("th",{className:"text-right py-2 px-3 w-40",children:"الإجراءات"})]})}),e.jsx("tbody",{children:b.map(s=>e.jsxs("tr",{className:"border-b last:border-0",children:[e.jsx("td",{className:"py-3 px-3",children:n===s.id?e.jsxs("form",{onSubmit:z,className:"flex items-center gap-2",children:[e.jsx(I,{value:N,onChange:a=>d(a.target.value),className:"h-9"}),e.jsx(i,{type:"submit",size:"sm",children:"حفظ"}),e.jsx(i,{type:"button",variant:"ghost",size:"sm",onClick:v,children:e.jsx($,{className:"h-4 w-4"})})]}):e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.name})}),e.jsx("td",{className:"py-3 px-3",children:n===s.id?e.jsx("select",{value:f,onChange:a=>c(a.target.value),className:"h-9 w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-2 text-sm",children:o?.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))}):e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:s.governorate?.name||"—"})}),e.jsx("td",{className:"py-3 px-3",children:n===s.id?null:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(i,{type:"button",size:"sm",variant:"outline",onClick:()=>D(s),className:"flex items-center gap-1",children:[e.jsx(W,{className:"h-3 w-3"}),"تعديل"]}),e.jsxs(i,{type:"button",size:"sm",variant:"destructive",onClick:()=>T(s.id),className:"flex items-center gap-1",children:[e.jsx(F,{className:"h-3 w-3"}),"حذف"]})]})})]},s.id))})]})})})]})]})]})}export{ae as default};
