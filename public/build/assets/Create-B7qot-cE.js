import{u as f,a as p,b as v,j as e,H as N,r as m}from"./app-Csm-iHha.js";import{D as _,a as h,c as C}from"./DashboardLayout-Cv7OrucU.js";import{C as w,b as k,c as S,a as D}from"./card-DK7p6fT7.js";import{B as d}from"./button-BD60Hi05.js";import{I as o}from"./input-D_EIzP2p.js";import{s as n}from"./use-toast-6Skx-iq7.js";import{C as x}from"./combobox-BVmQTM55.js";import{A as T}from"./arrow-left-nYxIxt5R.js";import{S as E}from"./save-Dlfj-mhU.js";/* empty css            */import"./createLucideIcon-C6GUZ6dL.js";import"./triangle-alert-BmMxnEwo.js";import"./file-text-DQNSwVpm.js";import"./eye-BT0mqwWW.js";import"./map-pin-yOXAGFnc.js";import"./mail-BKjau6ij.js";import"./dialog-CiCd0gwi.js";import"./index-BUfU_3H9.js";import"./check-C_vKodxV.js";function W({employees:u}){const{flash:r}=f().props;p.useEffect(()=>{r?.success&&n.success("نجح",r.success),r?.error&&n.error("خطأ",r.error)},[r]);const{data:a,setData:l,post:b,processing:c,errors:t}=v({employee_id:"",basic_salary:"",allowances:"0",deductions:"0",total_salary:"",payment_date:new Date().toISOString().split("T")[0],status:"pending",payment_method:"bank_transfer",notes:""});p.useEffect(()=>{const s=parseFloat(a.basic_salary.toString())||0,i=parseFloat(a.allowances.toString())||0,y=parseFloat(a.deductions.toString())||0,g=s+i-y;l("total_salary",g.toString())},[a.basic_salary,a.allowances,a.deductions]);const j=s=>{s.preventDefault(),b("/employees/salaries",{onSuccess:()=>{n.success("تم الإنشاء بنجاح","تم إضافة الراتب بنجاح"),m.visit("/employees/salaries")},onError:i=>{i.message?n.error("خطأ في الإنشاء",i.message):n.error("خطأ في الإنشاء","يرجى التحقق من البيانات المدخلة")}})};return e.jsxs(_,{children:[e.jsx(N,{title:"إضافة راتب جديد"}),e.jsxs("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>m.visit("/employees/salaries"),children:e.jsx(T,{className:"h-4 w-4"})}),e.jsx("div",{children:e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(h,{className:"h-6 w-6"}),"إضافة راتب جديد"]})})]})}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs(w,{children:[e.jsx(k,{children:e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-5 w-5"}),"معلومات الراتب"]})}),e.jsx(D,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الموظف ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{options:u.map(s=>({value:s.id.toString(),label:`${s.name} (${s.employee_number})`})),value:a.employee_id,onValueChange:s=>l("employee_id",s),placeholder:"اختر الموظف",searchPlaceholder:"ابحث عن الموظف...",emptyText:"لا يوجد موظفين",error:!!t.employee_id}),t.employee_id&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.employee_id})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["تاريخ الدفع ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(o,{type:"date",value:a.payment_date,onChange:s=>l("payment_date",s.target.value),className:`pr-10 ${t.payment_date?"border-red-500":""}`})]}),t.payment_date&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.payment_date})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الراتب الأساسي ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{type:"number",step:"0.01",min:"0",value:a.basic_salary,onChange:s=>l("basic_salary",s.target.value),placeholder:"0.00",className:t.basic_salary?"border-red-500":""}),t.basic_salary&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.basic_salary})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"البدلات"}),e.jsx(o,{type:"number",step:"0.01",min:"0",value:a.allowances,onChange:s=>l("allowances",s.target.value),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"الخصومات"}),e.jsx(o,{type:"number",step:"0.01",min:"0",value:a.deductions,onChange:s=>l("deductions",s.target.value),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الإجمالي ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{type:"number",step:"0.01",min:"0",value:a.total_salary,onChange:s=>l("total_salary",s.target.value),placeholder:"0.00",className:`font-bold text-[#913D95] ${t.total_salary?"border-red-500":""}`,readOnly:!0}),t.total_salary&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.total_salary})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الحالة ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{options:[{value:"pending",label:"في الانتظار"},{value:"paid",label:"مدفوعة"},{value:"overdue",label:"متأخرة"}],value:a.status,onValueChange:s=>l("status",s),placeholder:"اختر الحالة",searchPlaceholder:"ابحث...",emptyText:"لا توجد نتائج"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["طريقة الدفع ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{options:[{value:"bank_transfer",label:"تحويل بنكي"},{value:"cash",label:"نقدي"},{value:"check",label:"شيك"}],value:a.payment_method,onValueChange:s=>l("payment_method",s),placeholder:"اختر طريقة الدفع",searchPlaceholder:"ابحث...",emptyText:"لا توجد نتائج"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"ملاحظات"}),e.jsx("textarea",{value:a.notes,onChange:s=>l("notes",s.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-800 dark:text-white",placeholder:"أدخل أي ملاحظات عن الراتب"})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-6 border-t",children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>m.visit("/employees/salaries"),disabled:c,children:"إلغاء"}),e.jsxs(d,{type:"submit",disabled:c,className:"flex items-center gap-2 bg-[#913D95] hover:bg-[#7A2F7D]",children:[e.jsx(E,{className:"h-4 w-4"}),c?"جاري الحفظ...":"حفظ الراتب"]})]})]})]})]})}export{W as default};
