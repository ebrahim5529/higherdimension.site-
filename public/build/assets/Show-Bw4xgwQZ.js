import{a as C,j as e,H as M,r as y,b as V}from"./app-CyMgrt3T.js";import{D as O,B as _,U as B,C as D,P as F}from"./DashboardLayout-C2BzyX_G.js";import{C as d,b as i,c,a as x}from"./card-Ds_akk2v.js";import{a as U,B as o}from"./button-BYQHTvmA.js";import{I as R}from"./input-o_dNre2V.js";import{D as z,b as H,a as G,c as Y,d as X,e as q,f as J}from"./dialog-Cn2O5Yzz.js";import{s as k}from"./use-toast-C91E3Tui.js";import{A as K}from"./arrow-left-Dc61sim2.js";import{U as E,D as f,C as P}from"./user-BsMlQm9m.js";import{P as Q}from"./printer-DGliQzWw.js";import{D as v}from"./download-Da8sFeMc.js";import{S as W}from"./square-pen-Ct_0Pi5_.js";import{S as A}from"./star-CAWxp73e.js";import{T as I}from"./triangle-alert-CIcdgZcT.js";import{E as b}from"./eye-Dxsa3bX3.js";import{F as r}from"./file-text-DXOoDEiS.js";import{P as T}from"./phone-Z1RtNhB_.js";import{M as Z}from"./mail-CC5tAMUb.js";import{M as ee}from"./map-pin-BsWZEFoE.js";import{C as S}from"./circle-check-big-timyZSIU.js";import{C as se}from"./circle-x-DkAkBYxH.js";/* empty css            */import"./createLucideIcon-BYf3FF-E.js";const L=C.forwardRef(({className:s,...l},h)=>e.jsx("textarea",{className:U("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:h,...l}));L.displayName="Textarea";function Ce({customer:s}){const[l,h]=C.useState("overview"),j=a=>new Date(a).toLocaleDateString("ar-SA",{year:"numeric",month:"long",day:"numeric"}),g=a=>new Intl.NumberFormat("ar-SA",{style:"currency",currency:"OMR"}).format(a),u=a=>{switch(a){case"ACTIVE":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"INACTIVE":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"COMPLETED":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"PENDING":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},N=a=>{switch(a){case"ACTIVE":return e.jsx(S,{className:"h-4 w-4"});case"INACTIVE":return e.jsx(se,{className:"h-4 w-4"});case"COMPLETED":return e.jsx(S,{className:"h-4 w-4"});case"PENDING":return e.jsx(D,{className:"h-4 w-4"});default:return e.jsx(D,{className:"h-4 w-4"})}},t=s.contractsSummary||{total:s.contracts?.length||0,active:s.contracts?.filter(a=>a.status==="ACTIVE").length||0,completed:s.contracts?.filter(a=>a.status==="COMPLETED").length||0,cancelled:s.contracts?.filter(a=>a.status==="CANCELLED").length||0,totalValue:s.contracts?.reduce((a,n)=>a+(n.total_value||0),0)||0},m=s.paymentsSummary||{total:s.payments?.length||0,paid:s.payments?.filter(a=>a.status==="PAID").length||0,pending:s.payments?.filter(a=>a.status==="PENDING").length||0,overdue:s.payments?.filter(a=>a.status==="OVERDUE").length||0,totalAmount:s.payments?.reduce((a,n)=>a+(n.amount||0),0)||0},w=()=>{window.print()},p=()=>{alert("سيتم تصدير ملف العميل")};return e.jsxs(O,{children:[e.jsx(M,{title:`${s.name} - تفاصيل العميل`}),e.jsxs("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>y.visit("/customers"),children:e.jsx(K,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[s.customer_type==="COMPANY"?e.jsx(_,{className:"h-6 w-6"}):e.jsx(E,{className:"h-6 w-6"}),s.name]}),e.jsxs("p",{className:"text-muted-foreground",children:["رقم العميل: ",s.customer_number]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:w,children:[e.jsx(Q,{className:"h-4 w-4"}),"طباعة"]}),e.jsxs(o,{variant:"outline",size:"sm",onClick:p,children:[e.jsx(v,{className:"h-4 w-4"}),"تصدير"]}),e.jsxs(o,{onClick:()=>y.visit(`/customers/${s.id}/edit`),children:[e.jsx(W,{className:"h-4 w-4"}),"تعديل"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium flex items-center gap-2 ${u(s.status)}`,children:[N(s.status),s.status==="ACTIVE"?"نشط":"غير نشط"]}),s.rating&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(A,{className:"h-4 w-4 text-yellow-500 fill-current"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.rating,"/5"]})]}),s.warnings&&e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"تحذيرات"})]})]}),e.jsx("div",{className:"border-b",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"overview",label:"نظرة عامة",icon:b},{id:"contracts",label:"العقود",icon:r},{id:"payments",label:"المدفوعات",icon:f},{id:"notes",label:"الملاحظات",icon:r}].map(a=>{const n=a.icon;return e.jsxs("button",{onClick:()=>h(a.id),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${l===a.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[e.jsx(n,{className:"h-4 w-4"}),a.label]},a.id)})})}),l==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(d,{children:[e.jsx(i,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"}),"المعلومات الأساسية"]})}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"رقم العميل"}),e.jsx("p",{className:"text-sm font-mono font-semibold",children:s.customer_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"الاسم الكامل"}),e.jsx("p",{className:"text-sm font-semibold",children:s.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"نوع العميل"}),e.jsx("p",{className:"text-sm",children:s.customer_type==="COMPANY"?"شركة":"فرد"})]}),s.customer_type==="INDIVIDUAL"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"رقم الهوية"}),e.jsx("p",{className:"text-sm font-mono",children:s.id_number||"-"})]}),s.customer_type==="COMPANY"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"السجل التجاري"}),e.jsx("p",{className:"text-sm font-mono",children:s.commercial_record||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"الجنسية"}),e.jsx("p",{className:"text-sm",children:s.nationality||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"رقم الهاتف الرئيسي"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm",children:s.phone||"-"})]})]}),s.phones&&s.phones.length>0&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"أرقام الهواتف الإضافية"}),e.jsx("div",{className:"space-y-2",children:s.phones.map((a,n)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx(T,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium",children:a.number}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",a.type==="MOBILE"?"جوال":a.type==="LANDLINE"?"أرضي":"واتساب",")"]}),a.label&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["- ",a.label]}),a.isPrimary&&e.jsx("span",{className:"text-xs bg-primary text-white px-2 py-0.5 rounded-full",children:"رئيسي"})]},n))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"البريد الإلكتروني"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm break-all",children:s.email||"-"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"العنوان"}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ee,{className:"h-4 w-4 mt-0.5"}),e.jsx("p",{className:"text-sm",children:s.address||"-"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"تاريخ التسجيل"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm",children:j(s.registration_date)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"الحالة"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium flex items-center gap-1 ${u(s.status)}`,children:[N(s.status),s.status==="ACTIVE"?"نشط":"غير نشط"]})})]}),s.rating&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"التقييم"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(A,{className:"h-4 w-4 text-yellow-500 fill-current"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.rating,"/5"]})]})]})]})})]}),(s.guarantorData||s.guarantor_name||s.guarantor_phone||s.guarantor_id)&&e.jsxs(d,{children:[e.jsx(i,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5"}),"معلومات الضامن"]})}),e.jsx(x,{className:"space-y-4",children:s.guarantorData?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"اسم الضامن"}),e.jsx("p",{className:"text-sm",children:s.guarantorData.name||s.guarantor_name||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"هاتف الضامن"}),e.jsx("p",{className:"text-sm",children:s.guarantorData.phone||s.guarantor_phone||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"رقم هوية الضامن"}),e.jsx("p",{className:"text-sm font-mono",children:s.guarantorData.idNumber||s.guarantor_id||"-"})]}),s.guarantorData.nationality&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"جنسية الضامن"}),e.jsx("p",{className:"text-sm",children:s.guarantorData.nationality})]}),s.guarantorData.relationship&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"صلة القرابة"}),e.jsx("p",{className:"text-sm",children:s.guarantorData.relationship})]}),s.guarantorData.workPlace&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"مكان العمل"}),e.jsx("p",{className:"text-sm",children:s.guarantorData.workPlace})]}),s.guarantorData.workPhone&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"هاتف العمل"}),e.jsx("p",{className:"text-sm",children:s.guarantorData.workPhone})]}),s.guarantorData.address&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"عنوان الضامن"}),e.jsx("p",{className:"text-sm",children:s.guarantorData.address})]})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"اسم الضامن"}),e.jsx("p",{className:"text-sm",children:s.guarantor_name||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"هاتف الضامن"}),e.jsx("p",{className:"text-sm",children:s.guarantor_phone||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"رقم هوية الضامن"}),e.jsx("p",{className:"text-sm font-mono",children:s.guarantor_id||"-"})]})]})})]}),(s.id_card_copy_path||s.guarantor_id_card_copy_path||s.commercial_record_copy_path)&&e.jsxs(d,{children:[e.jsx(i,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(r,{className:"h-5 w-5"}),"المرفقات"]})}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.id_card_copy_path&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"نسخة البطاقة الشخصية"}),e.jsx("div",{className:"border rounded-lg p-3 bg-gray-50 dark:bg-gray-800",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{window.open(`/customers/${s.id}/view/id-card`,"_blank")},className:"flex items-center justify-center gap-2 text-sm text-primary hover:underline cursor-pointer flex-1 px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"عرض الملف",children:[e.jsx(b,{className:"h-4 w-4"}),"عرض"]}),e.jsxs("button",{onClick:()=>{window.open(`/customers/${s.id}/download/id-card`,"_blank")},className:"flex items-center justify-center gap-2 text-sm text-primary hover:underline cursor-pointer flex-1 px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"تحميل الملف",children:[e.jsx(v,{className:"h-4 w-4"}),"تحميل"]})]})})]}),s.guarantor_id_card_copy_path&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"نسخة بطاقة الضامن"}),e.jsx("div",{className:"border rounded-lg p-3 bg-gray-50 dark:bg-gray-800",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{window.open(`/customers/${s.id}/view/guarantor-id-card`,"_blank")},className:"flex items-center justify-center gap-2 text-sm text-primary hover:underline cursor-pointer flex-1 px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"عرض الملف",children:[e.jsx(b,{className:"h-4 w-4"}),"عرض"]}),e.jsxs("button",{onClick:()=>{window.open(`/customers/${s.id}/download/guarantor-id-card`,"_blank")},className:"flex items-center justify-center gap-2 text-sm text-primary hover:underline cursor-pointer flex-1 px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"تحميل الملف",children:[e.jsx(v,{className:"h-4 w-4"}),"تحميل"]})]})})]}),s.commercial_record_copy_path&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"نسخة السجل التجاري"}),e.jsx("div",{className:"border rounded-lg p-3 bg-gray-50 dark:bg-gray-800",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{window.open(`/customers/${s.id}/view/commercial-record`,"_blank")},className:"flex items-center justify-center gap-2 text-sm text-primary hover:underline cursor-pointer flex-1 px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"عرض الملف",children:[e.jsx(b,{className:"h-4 w-4"}),"عرض"]}),e.jsxs("button",{onClick:()=>{window.open(`/customers/${s.id}/download/commercial-record`,"_blank")},className:"flex items-center justify-center gap-2 text-sm text-primary hover:underline cursor-pointer flex-1 px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"تحميل الملف",children:[e.jsx(v,{className:"h-4 w-4"}),"تحميل"]})]})})]})]})})]}),(s.notes||s.warnings)&&e.jsxs(d,{children:[e.jsx(i,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(r,{className:"h-5 w-5"}),"الملاحظات والتحذيرات"]})}),e.jsxs(x,{className:"space-y-4",children:[s.notes&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"ملاحظات عامة"}),e.jsx("p",{className:"text-sm mt-1 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:s.notes})]}),s.warnings&&e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4 text-red-500"}),"تحذيرات خاصة"]}),e.jsx("p",{className:"text-sm mt-1 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-800 dark:text-red-200",children:s.warnings})]})]})]})]}),e.jsxs("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsxs(d,{children:[e.jsx(i,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(r,{className:"h-5 w-5"}),"ملخص العقود"]})}),e.jsxs(x,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"إجمالي العقود"}),e.jsx("span",{className:"font-medium",children:t.total})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"عقود نشطة"}),e.jsx("span",{className:"font-medium text-green-600",children:t.active})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"عقود مكتملة"}),e.jsx("span",{className:"font-medium text-blue-600",children:t.completed})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"عقود ملغاة"}),e.jsx("span",{className:"font-medium text-red-600",children:t.cancelled})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"إجمالي القيمة"}),e.jsx("span",{className:"font-bold text-primary",children:g(t.totalValue)})]})})]})]}),e.jsxs(d,{children:[e.jsx(i,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-5 w-5"}),"ملخص المدفوعات"]})}),e.jsxs(x,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"إجمالي المدفوعات"}),e.jsx("span",{className:"font-medium",children:m.total})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"مدفوعات مكتملة"}),e.jsx("span",{className:"font-medium text-green-600",children:m.paid})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"مدفوعات معلقة"}),e.jsx("span",{className:"font-medium text-yellow-600",children:m.pending})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"مدفوعات متأخرة"}),e.jsx("span",{className:"font-medium text-red-600",children:m.overdue})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"إجمالي المبلغ"}),e.jsx("span",{className:"font-bold text-primary",children:g(m.totalAmount)})]})})]})]})]})]}),l==="contracts"&&e.jsx("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:e.jsxs(d,{children:[e.jsx(i,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(r,{className:"h-5 w-5"}),"قائمة العقود"]})}),e.jsx(x,{children:s.contracts&&s.contracts.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-muted-foreground",children:"رقم العقد"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-muted-foreground",children:"نوع العقد"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-muted-foreground",children:"الحالة"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-muted-foreground",children:"تاريخ البدء"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-muted-foreground",children:"تاريخ الانتهاء"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-muted-foreground",children:"القيمة الإجمالية"})]})}),e.jsx("tbody",{children:s.contracts.map(a=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:a.contract_number||a.id})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.contract_type||"-"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${u(a.status)}`,children:a.status==="ACTIVE"?"نشط":a.status==="EXPIRED"?"منتهي":a.status==="CANCELLED"?"ملغي":"معلق"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.start_date?j(a.start_date):"-"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.end_date?j(a.end_date):"-"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:g(a.total_value??a.amount??0)})})]},a.id))})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(r,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"لا توجد عقود لهذا العميل"})]})})]})}),l==="payments"&&e.jsx("div",{className:"space-y-6",children:e.jsxs(d,{children:[e.jsx(i,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-5 w-5 text-[#58d2c8]"}),"مدفوعات العميل"]})}),e.jsx(x,{children:s.contractPayments&&s.contractPayments.length>0?e.jsx("div",{className:"space-y-3",children:s.contractPayments.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-[#58d2c8] transition-colors cursor-pointer",onClick:()=>y.visit(`/payments/${a.id}`),children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"p-2 bg-[#58d2c8]/10 rounded-lg",children:e.jsx(f,{className:"h-5 w-5 text-[#58d2c8]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:["#",a.id]}),e.jsx("span",{className:"px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",children:a.paymentMethod})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(r,{className:"h-4 w-4"}),e.jsx("span",{children:a.contractNumber})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx("span",{children:a.paymentDate})]}),a.checkNumber&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(r,{className:"h-4 w-4"}),e.jsxs("span",{children:["رقم الشيك: ",a.checkNumber]})]}),a.bankName&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx("span",{children:a.bankName})]})]})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:g(a.amount)}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:a.createdAt})]})]}),e.jsx("div",{className:"flex items-center gap-2 mr-4",children:e.jsx(o,{variant:"ghost",size:"icon",className:"p-2 hover:bg-[#58d2c8]/10",onClick:n=>{n.stopPropagation(),y.visit(`/payments/${a.id}`)},title:"عرض التفاصيل",children:e.jsx(b,{className:"h-5 w-5 text-[#58d2c8]"})})})]},a.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx(f,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{children:"لا توجد مدفوعات لهذا العميل"})]})})]})}),l==="notes"&&e.jsxs(d,{children:[e.jsx(i,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{children:"ملاحظات العميل"}),e.jsx($,{customerId:s.id})]})}),e.jsx(x,{children:s.customerNotes&&s.customerNotes.length>0?e.jsx("div",{className:"space-y-4",children:s.customerNotes.map(a=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:a.title||"ملاحظة"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:a.created_at?j(a.created_at):"-"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.content||a.note||"-"})]},a.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(r,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"لا توجد ملاحظات لهذا العميل"}),e.jsx($,{customerId:s.id})]})})]})]})]})}function $({customerId:s}){const[l,h]=C.useState(!1),{data:j,setData:g,post:u,processing:N,errors:t,reset:m}=V({title:"",content:""}),w=p=>{p.preventDefault(),u(`/customers/${s}/notes`,{onSuccess:()=>{k.success("نجح","تم إضافة الملاحظة بنجاح"),m(),h(!1)},onError:a=>{a.title&&k.error("خطأ",a.title),a.content&&k.error("خطأ",a.content)}})};return e.jsxs(z,{open:l,onOpenChange:h,children:[e.jsx(H,{asChild:!0,children:e.jsxs(o,{className:"bg-[#58d2c8] hover:bg-[#4AB8B3] text-white flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"إضافة ملاحظة"]})}),e.jsxs(G,{className:"sm:max-w-[500px]",children:[e.jsxs(Y,{children:[e.jsx(X,{children:"إضافة ملاحظة جديدة"}),e.jsx(q,{children:"أضف ملاحظة جديدة للعميل"})]}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"title",className:"text-sm font-medium",children:"العنوان"}),e.jsx(R,{id:"title",value:j.title,onChange:p=>g("title",p.target.value),placeholder:"عنوان الملاحظة",className:t.title?"border-red-500":""}),t.title&&e.jsx("p",{className:"text-sm text-red-500",children:t.title})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"content",className:"text-sm font-medium",children:"المحتوى"}),e.jsx(L,{id:"content",value:j.content,onChange:p=>g("content",p.target.value),placeholder:"محتوى الملاحظة",rows:5,className:t.content?"border-red-500":""}),t.content&&e.jsx("p",{className:"text-sm text-red-500",children:t.content})]})]}),e.jsxs(J,{children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>{h(!1),m()},children:"إلغاء"}),e.jsx(o,{type:"submit",disabled:N,className:"bg-[#58d2c8] hover:bg-[#4AB8B3] text-white",children:N?"جاري الحفظ...":"حفظ"})]})]})]})]})}export{Ce as default};
