import{u as N,a as u,b as f,j as e,H as y,r as x}from"./app-CVW8Vj3w.js";import{D as _}from"./DashboardLayout-pN7X4XC5.js";import{C,b as w,c as k,a as E}from"./card-DyHEEM7n.js";import{B as p}from"./button-DUXgo4Mb.js";import{I as d}from"./input-CCsdPKnP.js";import{s as i}from"./use-toast-CaXI9BLW.js";import{C as h}from"./combobox-7COCRkf_.js";import{A as D}from"./arrow-left-b-dFQIgC.js";import{C as n}from"./user-CXuHhyGT.js";import{F as T}from"./file-text-BpUQwDfQ.js";import{S as A}from"./save-BVQqYPPb.js";/* empty css            */import"./createLucideIcon-BfWhb02f.js";import"./triangle-alert-D1vbBR5a.js";import"./eye-BwFu1_Oh.js";import"./dialog-5TYNqUAt.js";import"./index-F0x2Glb3.js";import"./check-CkgTbzXa.js";const P=[{value:"ANNUAL",label:"سنوية"},{value:"SICK",label:"مرضية"},{value:"EMERGENCY",label:"طارئة"},{value:"MATERNITY",label:"أمومة"},{value:"PATERNITY",label:"أبوة"},{value:"UNPAID",label:"بدون راتب"},{value:"OTHER",label:"أخرى"}];function Q({employees:v}){const{flash:o}=N().props;u.useEffect(()=>{o?.success&&i.success("نجح",o.success),o?.error&&i.error("خطأ",o.error)},[o]);const{data:s,setData:l,post:j,processing:c,errors:t}=f({employee_id:"",leave_type:"ANNUAL",start_date:"",end_date:"",total_days:"",reason:"",status:"PENDING",applied_date:new Date().toISOString().split("T")[0],approved_by:"",approved_date:"",remaining_balance:"",notes:""});u.useEffect(()=>{if(s.start_date&&s.end_date){const a=new Date(s.start_date),r=new Date(s.end_date),m=Math.abs(r.getTime()-a.getTime()),b=Math.ceil(m/(1e3*60*60*24))+1;b>0&&l("total_days",b.toString())}},[s.start_date,s.end_date]);const g=a=>{a.preventDefault();const r={...s};r.approved_by||delete r.approved_by,r.approved_date||delete r.approved_date,r.remaining_balance||delete r.remaining_balance,r.notes||delete r.notes,j("/employees/leaves",{data:r,onSuccess:()=>{i.success("تم الإنشاء بنجاح","تم إضافة الإجازة بنجاح"),x.visit("/employees/leaves")},onError:m=>{m.message?i.error("خطأ في الإنشاء",m.message):i.error("خطأ في الإنشاء","يرجى التحقق من البيانات المدخلة")}})};return e.jsxs(_,{children:[e.jsx(y,{title:"إضافة طلب إجازة جديد"}),e.jsxs("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>x.visit("/employees/leaves"),children:e.jsx(D,{className:"h-4 w-4"})}),e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(n,{className:"h-6 w-6"}),"إضافة طلب إجازة جديد"]})]})}),e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs(C,{children:[e.jsx(w,{children:e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5"}),"معلومات الإجازة"]})}),e.jsx(E,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الموظف ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(h,{options:v.map(a=>({value:a.id.toString(),label:`${a.name} (${a.employee_number})`})),value:s.employee_id,onValueChange:a=>l("employee_id",a),placeholder:"اختر الموظف",searchPlaceholder:"ابحث عن الموظف...",emptyText:"لا يوجد موظفين",error:!!t.employee_id}),t.employee_id&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.employee_id})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["نوع الإجازة ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(h,{options:P.map(a=>({value:a.value,label:a.label})),value:s.leave_type,onValueChange:a=>l("leave_type",a),placeholder:"اختر نوع الإجازة",searchPlaceholder:"ابحث...",emptyText:"لا توجد نتائج"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["تاريخ البدء ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(n,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(d,{type:"date",value:s.start_date,onChange:a=>l("start_date",a.target.value),className:`pr-10 ${t.start_date?"border-red-500":""}`})]}),t.start_date&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.start_date})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["تاريخ الانتهاء ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(n,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(d,{type:"date",value:s.end_date,onChange:a=>l("end_date",a.target.value),min:s.start_date,className:`pr-10 ${t.end_date?"border-red-500":""}`})]}),t.end_date&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.end_date})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["عدد الأيام ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(d,{type:"number",min:"1",value:s.total_days,onChange:a=>l("total_days",a.target.value),placeholder:"0",className:t.total_days?"border-red-500":"",readOnly:!0}),t.total_days&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.total_days})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["تاريخ التقديم ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(n,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(d,{type:"date",value:s.applied_date,onChange:a=>l("applied_date",a.target.value),className:`pr-10 ${t.applied_date?"border-red-500":""}`})]}),t.applied_date&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.applied_date})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الحالة ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(h,{options:[{value:"PENDING",label:"في الانتظار"},{value:"APPROVED",label:"موافق عليه"},{value:"REJECTED",label:"مرفوض"},{value:"CANCELLED",label:"ملغاة"}],value:s.status,onValueChange:a=>l("status",a),placeholder:"اختر الحالة",searchPlaceholder:"ابحث...",emptyText:"لا توجد نتائج"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"الموافق عليه من"}),e.jsx(d,{type:"text",value:s.approved_by,onChange:a=>l("approved_by",a.target.value),placeholder:"اسم الموافق"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"تاريخ الموافقة"}),e.jsxs("div",{className:"relative",children:[e.jsx(n,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(d,{type:"date",value:s.approved_date,onChange:a=>l("approved_date",a.target.value),className:"pr-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"الرصيد المتبقي"}),e.jsx(d,{type:"number",min:"0",value:s.remaining_balance,onChange:a=>l("remaining_balance",a.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["السبب ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute right-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("textarea",{value:s.reason,onChange:a=>l("reason",a.target.value),rows:3,className:`w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-800 dark:text-white ${t.reason?"border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"أدخل سبب الإجازة"})]}),t.reason&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.reason})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"ملاحظات"}),e.jsx("textarea",{value:s.notes,onChange:a=>l("notes",a.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-800 dark:text-white",placeholder:"أدخل أي ملاحظات عن الإجازة"})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-6 border-t",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>x.visit("/employees/leaves"),disabled:c,children:"إلغاء"}),e.jsxs(p,{type:"submit",disabled:c,className:"flex items-center gap-2 bg-[#913D95] hover:bg-[#7A2F7D]",children:[e.jsx(A,{className:"h-4 w-4"}),c?"جاري الحفظ...":"حفظ الإجازة"]})]})]})]})]})}export{Q as default};
