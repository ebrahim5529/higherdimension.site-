import{b as V,r as i,u as P,j as e,H as X,L as w,a as Y}from"./app-84_vxQdS.js";import{D as Z,h as ee,K as $,P as se,b as ae}from"./DashboardLayout-BlAKKRWk.js";import{B as c}from"./button-BjYYNMND.js";import{I as E}from"./input-Cl715XOF.js";import{D as F,b as re,a as H,c as R,d as L,e as _,f as q}from"./dialog-DCX_5GXu.js";import{T as ne,a as te,b as C,c as x,d as ce,e as d}from"./table-DDsI2uF_.js";import{C as u,a as p,b as j,d as g,c as le}from"./card-eaxFl7Bs.js";import{C as B}from"./checkbox-DfTOGTZ1.js";import{s as f}from"./use-toast-CojTFCbM.js";import{S as b}from"./shield-CpYDa7Ju.js";import{S as ie}from"./square-pen-Dxzlk3Il.js";import{T as de}from"./trash-2-CcbwMLJr.js";/* empty css            */import"./createLucideIcon-BXz5zsdN.js";import"./triangle-alert-D1In3kIi.js";import"./file-text-1z2HdD-B.js";import"./eye-D1j9lGVu.js";import"./circle-alert-BuTutxtS.js";import"./map-pin-BohvRHeB.js";import"./mail-Ti8-EjQn.js";import"./index-CVoKwWwS.js";import"./check-aK--ux3n.js";function Ee({roles:D,allPermissions:k,stats:v}){const{flash:o}=V().props,[U,y]=i.useState(!1),[z,m]=i.useState(!1),[K,N]=i.useState(!1),[l,h]=i.useState(null),t=P({name:"",permissions:[]}),n=P({name:"",permissions:[]});i.useEffect(()=>{o?.success&&(f.success("نجح",o.success),y(!1),m(!1),t.reset(),n.reset()),o?.error&&f.error("خطأ",o.error)},[o]);const A=()=>{t.post("/roles",{onSuccess:()=>{t.reset()}})},I=a=>{h(a),n.setData({name:a.name,permissions:a.permissions.map(s=>s.id)}),m(!0)},M=()=>{l&&n.put(`/roles/${l.id}`,{onSuccess:()=>{m(!1),h(null),n.reset()}})},W=a=>{h(a),N(!0)},G=()=>{l&&Y.delete(`/roles/${l.id}`,{onSuccess:()=>{f.success("تم الحذف بنجاح",`تم حذف الدور "${l.name}" بنجاح`),N(!1),h(null)},onError:a=>{f.error("فشل الحذف",a?.message||"حدث خطأ أثناء حذف الدور")}})},S=(a,s)=>{const r=s.data.permissions||[];r.includes(a)?s.setData("permissions",r.filter(Q=>Q!==a)):s.setData("permissions",[...r,a])},J={"access-main-dashboard":"الوصول إلى الرئيسية","access-dashboard-reports":"الوصول إلى لوحة التحكم والتقارير","access-dashboard-interactive":"لوحة التحكم التفاعلية","access-financial-reports":"التقارير المالية","access-operations-reports":"تقارير التشغيل والمخزون","access-customer-reports":"تقارير العملاء","access-customers":"الوصول إلى إدارة العملاء","manage-customers":"إدارة بيانات العملاء","view-customer-contracts":"عرض عقود العملاء","manage-customer-claims":"إدارة مطالبات العملاء","access-suppliers":"الوصول إلى إدارة الموردين","manage-suppliers":"إدارة بيانات الموردين","view-supplier-invoices":"عرض فواتير الموردين","manage-supplier-purchases":"إدارة مشتريات الموردين","access-inventory":"الوصول إلى إدارة المخزون","manage-inventory":"إدارة المخزون","purchase-equipment":"شراء معدات جديدة","manage-purchases":"إدارة المشتريات","access-contracts":"الوصول إلى إدارة العقود","manage-contracts":"إدارة العقود والاتفاقيات","view-active-contracts":"عرض العقود النشطة","view-expired-contracts":"عرض العقود المنتهية","view-cancelled-contracts":"عرض العقود الملغاة","access-operations":"الوصول إلى إدارة التشغيل","manage-delivery-orders":"إدارة طلبات التوصيل","track-shipping":"تتبع الشحن","manage-delivery-receipt":"إدارة إيصالات التسليم","manage-return-inspection":"إدارة فحص الاسترجاع","access-financial":"الوصول إلى إدارة المالية","manage-payment-transactions":"إدارة المعاملات المالية","manage-invoices":"إدارة الفواتير","view-financial-reports":"عرض التقارير المالية","access-employees":"الوصول إلى إدارة الموظفين","manage-employees":"إدارة بيانات الموظفين","manage-salaries":"إدارة الرواتب","manage-incentives":"إدارة الحوافز","manage-attendance":"إدارة الحضور والانصراف","manage-departments":"إدارة الأقسام","manage-leaves":"إدارة الإجازات","access-permissions":"الوصول إلى إدارة الصلاحيات","manage-user-roles":"إدارة أدوار المستخدمين","manage-permission-groups":"إدارة مجموعات الصلاحيات","manage-roles":"إدارة الأدوار","access-payments":"الوصول إلى المدفوعات","view-all-payments":"عرض جميع المدفوعات","view-late-payments":"عرض المدفوعات المتأخرة","view-payment-reports":"عرض تقارير المدفوعات","access-settings":"الوصول إلى الإعدادات","manage-electronic-signature":"إدارة التوقيع الإلكتروني"},T=i.useMemo(()=>{const a={الرئيسية:[],"لوحة التحكم والتقارير":[],"إدارة العملاء":[],"إدارة الموردين":[],"إدارة المخزون":[],"إدارة العقود والاتفاقيات":[],"إدارة التشغيل والنقليات":[],"إدارة المالية":[],"إدارة الموظفين":[],"إدارة الصلاحيات":[],المدفوعات:[],الإعدادات:[]};return k.forEach(s=>{s.name.startsWith("access-main-dashboard")?a.الرئيسية.push(s):s.name.includes("dashboard")||s.name.includes("reports")?a["لوحة التحكم والتقارير"].push(s):s.name.includes("customer")?a["إدارة العملاء"].push(s):s.name.includes("supplier")?a["إدارة الموردين"].push(s):s.name.includes("inventory")||s.name.includes("purchase-equipment")||s.name.includes("purchases")?a["إدارة المخزون"].push(s):s.name.includes("contract")?a["إدارة العقود والاتفاقيات"].push(s):s.name.includes("operation")||s.name.includes("delivery")||s.name.includes("shipping")||s.name.includes("return")?a["إدارة التشغيل والنقليات"].push(s):s.name.includes("financial")||s.name.includes("invoice")||s.name.includes("payment-transaction")?a["إدارة المالية"].push(s):s.name.includes("employee")||s.name.includes("salary")||s.name.includes("incentive")||s.name.includes("attendance")||s.name.includes("department")||s.name.includes("leave")?a["إدارة الموظفين"].push(s):s.name.includes("permission")||s.name.includes("role")||s.name.includes("user-role")?a["إدارة الصلاحيات"].push(s):s.name.includes("payment")&&!s.name.includes("transaction")?a.المدفوعات.push(s):(s.name.includes("setting")||s.name.includes("electronic-signature"))&&a.الإعدادات.push(s)}),a},[k]),O=a=>J[a]||a.replace(/-/g," ");return e.jsxs(Z,{children:[e.jsx(X,{title:"إدارة الأدوار"}),e.jsxs("div",{className:"w-full space-y-6 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs(w,{href:"/dashboard/user-roles",className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"أدوار المستخدمين"]}),e.jsxs(w,{href:"/dashboard/roles",className:"px-4 py-2 bg-[rgb(30,64,175)] text-white rounded-lg hover:bg-[rgb(25,55,150)] transition-colors flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),"الأدوار"]}),e.jsxs(w,{href:"/dashboard/permission-groups",className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"مجموعات الصلاحيات"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5"}),e.jsx("h2",{className:"text-xl font-semibold",children:"إدارة الأدوار"})]}),e.jsxs(F,{open:U,onOpenChange:y,children:[e.jsx(re,{asChild:!0,children:e.jsxs(c,{children:[e.jsx(se,{className:"h-4 w-4"}),"إضافة دور جديد"]})}),e.jsxs(H,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(R,{children:[e.jsx(L,{children:"إضافة دور جديد"}),e.jsx(_,{children:"قم بإنشاء دور جديد وتعيين الصلاحيات له"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"اسم الدور"}),e.jsx(E,{value:t.data.name,onChange:a=>t.setData("name",a.target.value),placeholder:"مثال: مدير، محرر، مشاهد"}),t.errors.name&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.errors.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"الصلاحيات"}),e.jsx("div",{className:"border rounded-lg p-4 max-h-96 overflow-y-auto space-y-4",children:Object.entries(T).map(([a,s])=>s.length===0?null:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm text-primary border-b pb-1",children:a}),e.jsx("div",{className:"space-y-2 pr-4",children:s.map(r=>e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(B,{id:`create-permission-${r.id}`,checked:t.data.permissions?.includes(r.id),onCheckedChange:()=>S(r.id,t)}),e.jsx("label",{htmlFor:`create-permission-${r.id}`,className:"text-sm cursor-pointer",children:O(r.name)})]},r.id))})]},a))}),t.errors.permissions&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.errors.permissions})]})]}),e.jsxs(q,{children:[e.jsx(c,{variant:"outline",onClick:()=>y(!1),children:"إلغاء"}),e.jsx(c,{onClick:A,disabled:t.processing,children:t.processing?"جاري الحفظ...":"حفظ"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(u,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:"إجمالي الأدوار"}),e.jsx(b,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(g,{children:e.jsx("div",{className:"text-2xl font-bold",children:v.totalRoles})})]}),e.jsxs(u,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:"إجمالي الصلاحيات"}),e.jsx($,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(g,{children:e.jsx("div",{className:"text-2xl font-bold",children:v.totalPermissions})})]}),e.jsxs(u,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:"إجمالي المستخدمين"}),e.jsx(b,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(g,{children:e.jsx("div",{className:"text-2xl font-bold",children:v.totalUsers})})]})]}),e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"قائمة الأدوار"}),e.jsx(le,{children:"إدارة جميع الأدوار والصلاحيات في النظام"})]}),e.jsx(g,{children:e.jsxs(ne,{children:[e.jsx(te,{children:e.jsxs(C,{children:[e.jsx(x,{children:"اسم الدور"}),e.jsx(x,{children:"عدد الصلاحيات"}),e.jsx(x,{children:"عدد المستخدمين"}),e.jsx(x,{children:"تاريخ الإنشاء"}),e.jsx(x,{className:"text-left",children:"الإجراءات"})]})}),e.jsx(ce,{children:D.length===0?e.jsx(C,{children:e.jsx(d,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"لا توجد أدوار"})}):D.map(a=>e.jsxs(C,{children:[e.jsx(d,{className:"font-medium",children:a.name}),e.jsx(d,{children:a.permissions_count}),e.jsx(d,{children:a.users_count}),e.jsx(d,{children:new Date(a.created_at).toLocaleDateString("ar-SA")}),e.jsx(d,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>I(a),children:e.jsx(ie,{className:"h-4 w-4"})}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>W(a),children:e.jsx(de,{className:"h-4 w-4 text-red-500"})})]})})]},a.id))})]})})]}),e.jsx(F,{open:z,onOpenChange:m,children:e.jsxs(H,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(R,{children:[e.jsx(L,{children:"تعديل الدور"}),e.jsx(_,{children:"قم بتعديل الدور وتعيين الصلاحيات"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"اسم الدور"}),e.jsx(E,{value:n.data.name,onChange:a=>n.setData("name",a.target.value),placeholder:"مثال: مدير، محرر، مشاهد"}),n.errors.name&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:n.errors.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"الصلاحيات"}),e.jsx("div",{className:"border rounded-lg p-4 max-h-96 overflow-y-auto space-y-4",children:Object.entries(T).map(([a,s])=>s.length===0?null:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm text-primary border-b pb-1",children:a}),e.jsx("div",{className:"space-y-2 pr-4",children:s.map(r=>e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(B,{id:`edit-permission-${r.id}`,checked:n.data.permissions?.includes(r.id),onCheckedChange:()=>S(r.id,n)}),e.jsx("label",{htmlFor:`edit-permission-${r.id}`,className:"text-sm cursor-pointer",children:O(r.name)})]},r.id))})]},a))}),n.errors.permissions&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:n.errors.permissions})]})]}),e.jsxs(q,{children:[e.jsx(c,{variant:"outline",onClick:()=>m(!1),children:"إلغاء"}),e.jsx(c,{onClick:M,disabled:n.processing,children:n.processing?"جاري الحفظ...":"حفظ"})]})]})}),e.jsx(ae,{open:K,onOpenChange:N,onConfirm:G,title:"حذف الدور",description:`هل أنت متأكد من حذف الدور "${l?.name}"؟`})]})]})}export{Ee as default};
