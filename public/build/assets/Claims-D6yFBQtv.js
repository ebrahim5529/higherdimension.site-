import{a as h,j as e,H as T,r as g}from"./app-Csm-iHha.js";import{D as L,a as S,f as D,S as H,U as N,c as R}from"./DashboardLayout-Cv7OrucU.js";import{C as d,a as i,b as p,c as A}from"./card-DK7p6fT7.js";import{C as v,B as m}from"./button-BD60Hi05.js";import{I as P}from"./input-D_EIzP2p.js";import{T as E,a as U,b as y,c as n,d as z,e as c}from"./table-CoPF4JU4.js";import{H as B}from"./hash-BP-0dxEC.js";import{P as F}from"./phone-BXhcm_g2.js";import{E as b}from"./eye-BT0mqwWW.js";import{F as I}from"./file-text-DQNSwVpm.js";/* empty css            */import"./createLucideIcon-C6GUZ6dL.js";import"./triangle-alert-BmMxnEwo.js";import"./map-pin-yOXAGFnc.js";import"./mail-BKjau6ij.js";function se({customers:o}){const[t,u]=h.useState(""),[x,j]=h.useState("overview"),l=h.useMemo(()=>t?o.filter(s=>s.name.toLowerCase().includes(t.toLowerCase())||s.customerNumber.toLowerCase().includes(t.toLowerCase())||s.phone?.toLowerCase().includes(t.toLowerCase())||s.email?.toLowerCase().includes(t.toLowerCase())):o,[o,t]),r=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"OMR"}).format(s),f=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),w=l.reduce((s,a)=>s+a.totalRemaining,0),k=l.reduce((s,a)=>s+a.overdueAmount,0),C=l.reduce((s,a)=>s+a.totalPaid,0);return e.jsxs(L,{children:[e.jsx(T,{title:"إدارة المطالبات"}),e.jsxs("div",{className:"space-y-6 pb-8 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"إدارة المطالبات"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"عرض المدفوعات والمبالغ المتبقية للعملاء"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(d,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"إجمالي المتبقي"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r(w)})]}),e.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900 rounded-lg",children:e.jsx(S,{className:"h-6 w-6 text-red-600 dark:text-red-400"})})]})})}),e.jsx(d,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"المتأخر"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r(k)})]}),e.jsx("div",{className:"p-3 bg-yellow-100 dark:bg-yellow-900 rounded-lg",children:e.jsx(v,{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400"})})]})})}),e.jsx(d,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"إجمالي المدفوع"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r(C)})]}),e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900 rounded-lg",children:e.jsx(D,{className:"h-6 w-6 text-green-600 dark:text-green-400"})})]})})})]}),e.jsxs(d,{children:[e.jsx(p,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(A,{children:"العملاء والمطالبات"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{variant:x==="overview"?"default":"outline",size:"sm",onClick:()=>j("overview"),children:"نظرة عامة"}),e.jsx(m,{variant:x==="payments"?"default":"outline",size:"sm",onClick:()=>j("payments"),children:"المدفوعات"})]})]}),e.jsxs("div",{className:"relative w-64",children:[e.jsx(H,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500"}),e.jsx(P,{placeholder:"ابحث عن عميل...",value:t,onChange:s=>u(s.target.value),className:"pl-9"})]})]})}),e.jsxs(i,{children:[x==="overview"&&e.jsxs("div",{className:"space-y-4",children:[l.map(s=>e.jsx(d,{className:"border-2",children:e.jsxs(i,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:e.jsx(N,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:s.name}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx("span",{children:s.customerNumber})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{children:s.phone})]})]})]})]}),e.jsxs(m,{variant:"outline",onClick:()=>g.visit(`/customers/${s.id}`),children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"عرض العميل"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"إجمالي قيمة العقود"}),e.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:r(s.totalContractsValue)})]}),e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"المبلغ المدفوع"}),e.jsx("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:r(s.totalPaid)})]}),e.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"المبلغ المتبقي"}),e.jsx("div",{className:"text-lg font-bold text-red-600 dark:text-red-400",children:r(s.totalRemaining)})]}),s.overdueAmount>0&&e.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"المتأخر"}),e.jsx("div",{className:"text-lg font-bold text-yellow-600 dark:text-yellow-400",children:r(s.overdueAmount)})]})]})]})},s.id)),l.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(v,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t?"لا توجد نتائج للبحث":"لا توجد مطالبات"})]})]}),x==="payments"&&e.jsx("div",{className:"space-y-4",children:l.map(s=>e.jsxs(d,{className:"border-2",children:[e.jsx(p,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:e.jsx(N,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.customerNumber})]})]})})}),e.jsx(i,{children:s.payments.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(E,{children:[e.jsx(U,{children:e.jsxs(y,{children:[e.jsx(n,{children:"رقم الدفعة"}),e.jsx(n,{children:"رقم العقد"}),e.jsx(n,{children:"طريقة الدفع"}),e.jsx(n,{children:"تاريخ الدفع"}),e.jsx(n,{children:"المبلغ"}),e.jsx(n,{className:"text-right",children:"الإجراءات"})]})}),e.jsx(z,{children:s.payments.map(a=>e.jsxs(y,{children:[e.jsxs(c,{className:"font-medium",children:["#",a.id]}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4 text-gray-500"}),a.contractNumber]})}),e.jsx(c,{children:a.paymentMethod}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"h-4 w-4 text-gray-500"}),f(a.paymentDate)]})}),e.jsx(c,{children:e.jsx("span",{className:"font-semibold text-green-600",children:r(a.amount)})}),e.jsx(c,{className:"text-right",children:e.jsx(m,{variant:"outline",size:"sm",onClick:()=>g.visit(`/payments/${a.id}`),children:e.jsx(b,{className:"h-4 w-4"})})})]},a.id))})]})}):e.jsx("p",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"لا توجد مدفوعات لهذا العميل"})})]},s.id))})]})]})]})]})}export{se as default};
