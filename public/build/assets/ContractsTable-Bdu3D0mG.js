import{a as r,j as e}from"./app-8gmTTw34.js";import{u as K,f as N,g as V,a as A,b as z,c as G}from"./index-DYpnaaD5.js";import{C as L,b as E,c as $,a as H}from"./card-DbSr2bDZ.js";import{B as c}from"./button-jR2lg-Ad.js";import{C as w}from"./combobox-RNVymFuc.js";import{U,D as q,C as J}from"./user-DAMzRv9g.js";import{G as O}from"./git-branch-HphsX11H.js";import{E as Q}from"./eye-BHi5eQqe.js";import{S as W}from"./square-pen-BsQ6z3hd.js";import{P as X}from"./printer-Ca15bbVZ.js";import{T as Y}from"./trash-2-DuAL4r7_.js";import{R as Z,P as v,S as _,b as I,c as ee}from"./DashboardLayout-DhkYYcHy.js";import{C as te}from"./chevron-left-70wE21hx.js";function he({data:u,onAddContract:h,onEditContract:p,onDeleteContract:b,onViewContract:j,onViewStages:i,onPrint:d,onIssueInvoice:x,isLoading:f=!1}){const[C,k]=r.useState([]),[S,R]=r.useState([]),[l,y]=r.useState(""),[n,P]=r.useState("all"),[o,F]=r.useState("all"),M=t=>{switch(t){case"نشط":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"منتهي":return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400";case"ملغي":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400";default:return"bg-gray-100 text-gray-800"}},T=t=>{switch(t){case"تأجير":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400";case"بيع":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";default:return"bg-gray-100 text-gray-800"}},m=r.useMemo(()=>u.filter(t=>{const a=t.customerName.toLowerCase().includes(l.toLowerCase())||t.contractNumber.toLowerCase().includes(l.toLowerCase()),B=n==="all"||t.status===n,D=o==="all"||t.type===o;return a&&B&&D}),[u,l,n,o]),g=r.useMemo(()=>[{accessorKey:"contractNumber",header:"رقم العقد",cell:({row:t})=>e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:t.getValue("contractNumber")})},{accessorKey:"customerName",header:"العميل",cell:({row:t})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:t.getValue("customerName")})]})},{accessorKey:"type",header:"النوع",cell:({row:t})=>{const a=t.getValue("type");return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${T(a)}`,children:a})}},{accessorKey:"totalAfterDiscount",header:"الإجمالي",cell:({row:t})=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[Number(t.getValue("totalAfterDiscount")).toFixed(2)," ر.ع"]})]})},{accessorKey:"totalPayments",header:"المدفوع",cell:({row:t})=>e.jsxs("span",{className:"font-medium text-green-600 dark:text-green-400",children:[Number(t.getValue("totalPayments")).toFixed(2)," ر.ع"]})},{accessorKey:"remainingAmount",header:"المتبقي",cell:({row:t})=>{const a=Number(t.getValue("remainingAmount"));return e.jsxs("span",{className:`font-medium ${a>0?"text-orange-600 dark:text-orange-400":"text-green-600 dark:text-green-400"}`,children:[a.toFixed(2)," ر.ع"]})}},{accessorKey:"status",header:"الحالة",cell:({row:t})=>{const a=t.getValue("status");return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${M(a)}`,children:a})}},{accessorKey:"startDate",header:"التواريخ",cell:({row:t})=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{children:["من: ",t.original.startDate]}),e.jsxs("div",{children:["إلى: ",t.original.endDate]})]})]})},{id:"actions",header:"الإجراءات",cell:({row:t})=>{const a=t.original;return e.jsx("div",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx("button",{onClick:()=>i(a),className:"text-purple-600 hover:text-purple-700 transition-colors p-1",title:"عرض المراحل",children:e.jsx(O,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>j(a),className:"text-[#58d2c8] hover:text-[#4AB8B3] transition-colors p-1",title:"عرض التفاصيل",children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>p(a),className:"text-blue-600 hover:text-blue-700 transition-colors p-1",title:"تعديل",children:e.jsx(W,{className:"h-4 w-4"})}),d&&e.jsx("button",{onClick:()=>d(a),className:"text-green-600 hover:text-green-700 transition-colors p-1",title:"طباعة",children:e.jsx(X,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>b(a),className:"text-red-600 hover:text-red-700 transition-colors p-1",title:"حذف",children:e.jsx(Y,{className:"h-4 w-4"})})]}),x&&e.jsxs("button",{onClick:()=>x(a),className:"flex items-center justify-center gap-2 px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white text-xs font-medium rounded-lg transition-colors whitespace-nowrap",title:"إصدار فاتورة",children:[e.jsx(Z,{className:"h-3.5 w-3.5"}),"إصدار فاتورة"]})]})})}}],[j,p,b,i,d,x]),s=K({data:m,columns:g,getCoreRowModel:G(),getFilteredRowModel:z(),getSortedRowModel:A(),getPaginationRowModel:V(),onSortingChange:k,onColumnFiltersChange:R,onGlobalFilterChange:y,state:{sorting:C,columnFilters:S,globalFilter:l},initialState:{pagination:{pageSize:10}}});return e.jsxs(L,{children:[e.jsx(E,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx($,{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"جدول العقود"}),e.jsxs(c,{onClick:h,className:"flex items-center gap-2 bg-[#58d2c8] hover:bg-[#4AB8B3]",children:[e.jsx(v,{className:"h-4 w-4"}),"إضافة عقد جديد"]})]})}),e.jsxs(H,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 mb-4 sm:mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(_,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"البحث في العقود...",value:l,onChange:t=>y(t.target.value),className:"w-full pr-10 pl-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#58d2c8] focus:border-transparent"})]}),e.jsx(w,{options:[{value:"all",label:"جميع الحالات"},{value:"نشط",label:"نشط"},{value:"منتهي",label:"منتهي"},{value:"ملغي",label:"ملغي"}],value:n,onValueChange:t=>P(t),placeholder:"الحالة",searchPlaceholder:"ابحث...",emptyText:"لا توجد نتائج",className:"w-full sm:w-[180px]"}),e.jsx(w,{options:[{value:"all",label:"جميع الأنواع"},{value:"تأجير",label:"تأجير"},{value:"بيع",label:"بيع"}],value:o,onValueChange:t=>F(t),placeholder:"النوع",searchPlaceholder:"ابحث...",emptyText:"لا توجد نتائج",className:"w-full sm:w-[180px]"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[1200px]",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:s.getHeaderGroups().map(t=>t.headers.map(a=>e.jsx("th",{className:"text-right py-3 px-2 sm:px-4 font-medium text-gray-900 dark:text-white text-sm",children:a.isPlaceholder?null:N(a.column.columnDef.header,a.getContext())},a.id)))})}),e.jsx("tbody",{children:f?e.jsx("tr",{children:e.jsx("td",{colSpan:g.length,className:"text-center py-8",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#58d2c8] border-t-transparent rounded-full animate-spin"})})})}):s.getRowModel().rows.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:g.length,className:"text-center py-8",children:[e.jsx(I,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"لا توجد عقود"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"لم يتم العثور على عقود تطابق معايير البحث"}),e.jsxs(c,{onClick:h,className:"bg-[#58d2c8] hover:bg-[#4AB8B3]",children:[e.jsx(v,{className:"h-4 w-4 ml-2"}),"إضافة عقد جديد"]})]})}):s.getRowModel().rows.map(t=>e.jsx("tr",{className:"border-b border-gray-100 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800/50",children:t.getVisibleCells().map(a=>e.jsx("td",{className:"py-3 px-2 sm:px-4",children:N(a.column.columnDef.cell,a.getContext())},a.id))},t.id))})]})}),!f&&s.getRowModel().rows.length>0&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["عرض ",s.getState().pagination.pageIndex*s.getState().pagination.pageSize+1," إلى"," ",Math.min((s.getState().pagination.pageIndex+1)*s.getState().pagination.pageSize,m.length)," ","من ",m.length," عقد"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>s.previousPage(),disabled:!s.getCanPreviousPage(),children:[e.jsx(ee,{className:"h-4 w-4"}),"السابق"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>s.nextPage(),disabled:!s.getCanNextPage(),children:["التالي",e.jsx(te,{className:"h-4 w-4"})]})]})]})]})]})}export{he as C};
