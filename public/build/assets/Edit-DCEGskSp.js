import{u as f,a as g,b as y,j as e,H as N,r as n}from"./app-CONDmo9A.js";import{D as _,C as p,c as k}from"./DashboardLayout-BPsSLmbd.js";import{C,b as w,c as S,a as D}from"./card-Cxh3cW5F.js";import{B as x}from"./button-B6dOx6gm.js";import{I as m}from"./input-B65q9l4a.js";import{s as c}from"./use-toast-DmxNXA8L.js";import{C as u}from"./combobox-BowwYE63.js";import{A as H}from"./arrow-left-CkSKp0Sp.js";import{F as E}from"./file-text-n36sxuUg.js";import{S as T}from"./save-DBPjBKOC.js";/* empty css            */import"./createLucideIcon-DGnkID90.js";import"./triangle-alert-BtrJKYoD.js";import"./eye-CoNGtWIh.js";import"./map-pin-mbm9Cvun.js";import"./mail-DiqatmSx.js";import"./dialog-Dh26kjxE.js";import"./index-Dfz2eIVs.js";import"./check-CBddObq-.js";function X({attendance:t,employees:b}){const{flash:i}=f().props;g.useEffect(()=>{i?.success&&c.success("نجح",i.success),i?.error&&c.error("خطأ",i.error)},[i]);const{data:l,setData:r,put:j,processing:d,errors:o}=y({employee_id:t.employee_id.toString(),date:t.date,check_in:t.check_in||"",check_out:t.check_out||"",total_hours:t.total_hours?.toString()||"",overtime:t.overtime?.toString()||"",status:t.status,notes:t.notes||""}),v=s=>{s.preventDefault();const a={...l};a.check_in||delete a.check_in,a.check_out||delete a.check_out,a.total_hours||delete a.total_hours,a.overtime||delete a.overtime,a.notes||delete a.notes,j(`/employees/attendance/${t.id}`,{data:a,onSuccess:()=>{c.success("تم التحديث بنجاح","تم تحديث سجل الحضور بنجاح"),n.visit(`/employees/attendance/${t.id}`)},onError:h=>{h.message?c.error("خطأ في التحديث",h.message):c.error("خطأ في التحديث","يرجى التحقق من البيانات المدخلة")}})};return e.jsxs(_,{children:[e.jsx(N,{title:"تعديل سجل الحضور"}),e.jsxs("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>n.visit("/employees/attendance"),children:e.jsx(H,{className:"h-4 w-4"})}),e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(p,{className:"h-6 w-6"}),"تعديل سجل الحضور"]})]})}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs(C,{children:[e.jsx(w,{children:e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-5 w-5"}),"معلومات الحضور"]})}),e.jsx(D,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الموظف ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(u,{options:b.map(s=>({value:s.id.toString(),label:`${s.name} (${s.employee_number})`})),value:l.employee_id,onValueChange:s=>r("employee_id",s),placeholder:"اختر الموظف",searchPlaceholder:"ابحث عن الموظف...",emptyText:"لا يوجد موظفين",error:!!o.employee_id}),o.employee_id&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.employee_id})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["التاريخ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(m,{type:"date",value:l.date,onChange:s=>r("date",s.target.value),className:`pr-10 ${o.date?"border-red-500":""}`})]}),o.date&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"وقت الدخول"}),e.jsx(m,{type:"time",value:l.check_in,onChange:s=>r("check_in",s.target.value),placeholder:"HH:MM"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"وقت الخروج"}),e.jsx(m,{type:"time",value:l.check_out,onChange:s=>r("check_out",s.target.value),placeholder:"HH:MM"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"إجمالي الساعات"}),e.jsx(m,{type:"number",step:"0.01",min:"0",value:l.total_hours,onChange:s=>r("total_hours",s.target.value),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"ساعات إضافية"}),e.jsx(m,{type:"number",step:"0.01",min:"0",value:l.overtime,onChange:s=>r("overtime",s.target.value),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الحالة ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(u,{options:[{value:"present",label:"حاضر"},{value:"absent",label:"غائب"},{value:"late",label:"متأخر"},{value:"half_day",label:"نصف يوم"},{value:"on_leave",label:"في إجازة"}],value:l.status,onValueChange:s=>r("status",s),placeholder:"اختر الحالة",searchPlaceholder:"ابحث...",emptyText:"لا توجد نتائج"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"ملاحظات"}),e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute right-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("textarea",{value:l.notes,onChange:s=>r("notes",s.target.value),rows:3,className:"w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-800 dark:text-white",placeholder:"أدخل أي ملاحظات عن الحضور"})]})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-6 border-t",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>n.visit("/employees/attendance"),disabled:d,children:"إلغاء"}),e.jsxs(x,{type:"submit",disabled:d,className:"flex items-center gap-2 bg-[#913D95] hover:bg-[#7A2F7D]",children:[e.jsx(T,{className:"h-4 w-4"}),d?"جاري الحفظ...":"حفظ التعديلات"]})]})]})]})]})}export{X as default};
