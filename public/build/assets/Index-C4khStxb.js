import{u as K,r as o,b as w,j as e,H as q,L as p,a as A}from"./app-JuT9i8Nu.js";import{D as G,K as g,P as J,d as M}from"./DashboardLayout-Mi_rkm2X.js";import{B as l}from"./button-B5dkCZVx.js";import{I as k}from"./input-Fxgf3LeS.js";import{D as S,b as Q,a as T,c as O,d as P,e as E,f as H}from"./dialog-CMGUuRK3.js";import{T as V,a as W,b as u,c as d,d as X,e as n}from"./table-9tukv6AO.js";import{C as f,b,c as N,a as y,d as Y}from"./card-Bylfs8ZR.js";import{s as m}from"./use-toast-C27QhTIZ.js";import{U as Z}from"./x-DUMZ2MyZ.js";import{S as F}from"./shield-_HwMWS0e.js";import{S as ee}from"./square-pen-rRS-IMiH.js";import{T as se}from"./trash-2-3iDRTGBH.js";/* empty css            */import"./createLucideIcon-Dpb_xsff.js";import"./triangle-alert-0jWxApMi.js";import"./file-text-3qDLBxfl.js";import"./eye-YLqfSfxG.js";import"./circle-alert-BNQrC8hC.js";import"./map-pin-7nJQb0p0.js";import"./mail-CaIkmxaV.js";function ve({permissions:D,allRoles:ae,stats:v}){const{flash:i}=K().props,[L,h]=o.useState(!1),[R,c]=o.useState(!1),[_,j]=o.useState(!1),[t,x]=o.useState(null),r=w({name:""}),a=w({name:""});o.useEffect(()=>{i?.success&&(m.success("نجح",i.success),h(!1),c(!1),r.reset(),a.reset()),i?.error&&m.error("خطأ",i.error)},[i]);const $=()=>{r.post("/permissions",{onSuccess:()=>{r.reset()}})},B=s=>{x(s),a.setData({name:s.name}),c(!0)},I=()=>{t&&a.put(`/permissions/${t.id}`,{onSuccess:()=>{c(!1),x(null),a.reset()}})},U=s=>{x(s),j(!0)},z=()=>{t&&A.delete(`/permissions/${t.id}`,{onSuccess:()=>{m.success("تم الحذف بنجاح",`تم حذف الصلاحية "${t.name}" بنجاح`),j(!1),x(null)},onError:s=>{m.error("فشل الحذف",s?.message||"حدث خطأ أثناء حذف الصلاحية")}})};return e.jsxs(G,{children:[e.jsx(q,{title:"إدارة الصلاحيات"}),e.jsxs("div",{className:"w-full space-y-6 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs(p,{href:"/dashboard/user-roles",className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),"أدوار المستخدمين"]}),e.jsxs(p,{href:"/dashboard/roles",className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"الأدوار"]}),e.jsxs(p,{href:"/dashboard/permission-groups",className:"px-4 py-2 bg-[rgb(30,64,175)] text-white rounded-lg hover:bg-[rgb(25,55,150)] transition-colors flex items-center gap-2",children:[e.jsx(g,{className:"h-4 w-4"}),"مجموعات الصلاحيات"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5"}),e.jsx("h2",{className:"text-xl font-semibold",children:"إدارة الصلاحيات"})]}),e.jsxs(S,{open:L,onOpenChange:h,children:[e.jsx(Q,{asChild:!0,children:e.jsxs(l,{children:[e.jsx(J,{className:"h-4 w-4"}),"إضافة صلاحية جديدة"]})}),e.jsxs(T,{children:[e.jsxs(O,{children:[e.jsx(P,{children:"إضافة صلاحية جديدة"}),e.jsx(E,{children:"قم بإنشاء صلاحية جديدة"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"اسم الصلاحية"}),e.jsx(k,{value:r.data.name,onChange:s=>r.setData("name",s.target.value),placeholder:"مثال: create-users, edit-contracts"}),r.errors.name&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.errors.name})]})}),e.jsxs(H,{children:[e.jsx(l,{variant:"outline",onClick:()=>h(!1),children:"إلغاء"}),e.jsx(l,{onClick:$,disabled:r.processing,children:r.processing?"جاري الحفظ...":"حفظ"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(f,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"إجمالي الصلاحيات"}),e.jsx(g,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold",children:v.totalPermissions})})]}),e.jsxs(f,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"إجمالي الأدوار"}),e.jsx(F,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold",children:v.totalRoles})})]})]}),e.jsxs(f,{children:[e.jsxs(b,{children:[e.jsx(N,{children:"قائمة الصلاحيات"}),e.jsx(Y,{children:"إدارة جميع الصلاحيات في النظام"})]}),e.jsx(y,{children:e.jsxs(V,{children:[e.jsx(W,{children:e.jsxs(u,{children:[e.jsx(d,{children:"اسم الصلاحية"}),e.jsx(d,{children:"عدد الأدوار"}),e.jsx(d,{children:"الأدوار المرتبطة"}),e.jsx(d,{children:"تاريخ الإنشاء"}),e.jsx(d,{className:"text-left",children:"الإجراءات"})]})}),e.jsx(X,{children:D.length===0?e.jsx(u,{children:e.jsx(n,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"لا توجد صلاحيات"})}):D.map(s=>e.jsxs(u,{children:[e.jsx(n,{className:"font-medium",children:s.name}),e.jsx(n,{children:s.roles_count}),e.jsx(n,{children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.roles.length>0?s.roles.map(C=>e.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 rounded",children:C.name},C.id)):e.jsx("span",{className:"text-muted-foreground text-sm",children:"لا توجد أدوار"})})}),e.jsx(n,{children:new Date(s.created_at).toLocaleDateString("ar-SA")}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>B(s),children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>U(s),children:e.jsx(se,{className:"h-4 w-4 text-red-500"})})]})})]},s.id))})]})})]}),e.jsx(S,{open:R,onOpenChange:c,children:e.jsxs(T,{children:[e.jsxs(O,{children:[e.jsx(P,{children:"تعديل الصلاحية"}),e.jsx(E,{children:"قم بتعديل اسم الصلاحية"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"اسم الصلاحية"}),e.jsx(k,{value:a.data.name,onChange:s=>a.setData("name",s.target.value),placeholder:"مثال: create-users, edit-contracts"}),a.errors.name&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.errors.name})]})}),e.jsxs(H,{children:[e.jsx(l,{variant:"outline",onClick:()=>c(!1),children:"إلغاء"}),e.jsx(l,{onClick:I,disabled:a.processing,children:a.processing?"جاري الحفظ...":"حفظ"})]})]})}),e.jsx(M,{open:_,onOpenChange:j,onConfirm:z,title:"حذف الصلاحية",description:`هل أنت متأكد من حذف الصلاحية "${t?.name}"؟`})]})]})}export{ve as default};
