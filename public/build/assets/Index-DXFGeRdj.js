import{u as U,r as d,b as w,j as e,H as q,L as g,a as A}from"./app-CCHA9ub0.js";import{D as G,j as J,K as p,P as M,c as Q}from"./DashboardLayout-BHw3dqES.js";import{B as l}from"./button-Bfv0f9vZ.js";import{I as k}from"./input-BoE7gBrx.js";import{D as S,b as V,a as T,c as O,d as P,e as E,f as H}from"./dialog-D2ksYsD7.js";import{T as W,a as X,b as u,c as o,d as Y,e as n}from"./table-DU24Qh8d.js";import{C as f,b,c as N,a as y,d as Z}from"./card-Bly1X19M.js";import{s as m}from"./use-toast-CTmzR8DA.js";import{S as F}from"./shield-CQHunxOJ.js";import{S as ee}from"./square-pen-CyaiGVoG.js";import{T as se}from"./trash-2-C_sLctUu.js";/* empty css            */import"./createLucideIcon-FmD0vq03.js";import"./triangle-alert-DWFl2Smt.js";import"./file-text-CauxPHHp.js";import"./eye-8DxskOvD.js";import"./circle-alert-CjQBNfBa.js";import"./map-pin-DHI_P5OF.js";import"./mail-9UAeJwq9.js";function De({permissions:D,allRoles:ae,stats:v}){const{flash:i}=U().props,[L,h]=d.useState(!1),[R,c]=d.useState(!1),[_,j]=d.useState(!1),[t,x]=d.useState(null),r=w({name:""}),a=w({name:""});d.useEffect(()=>{i?.success&&(m.success("نجح",i.success),h(!1),c(!1),r.reset(),a.reset()),i?.error&&m.error("خطأ",i.error)},[i]);const $=()=>{r.post("/permissions",{onSuccess:()=>{r.reset()}})},B=s=>{x(s),a.setData({name:s.name}),c(!0)},I=()=>{t&&a.put(`/permissions/${t.id}`,{onSuccess:()=>{c(!1),x(null),a.reset()}})},z=s=>{x(s),j(!0)},K=()=>{t&&A.delete(`/permissions/${t.id}`,{onSuccess:()=>{m.success("تم الحذف بنجاح",`تم حذف الصلاحية "${t.name}" بنجاح`),j(!1),x(null)},onError:s=>{m.error("فشل الحذف",s?.message||"حدث خطأ أثناء حذف الصلاحية")}})};return e.jsxs(G,{children:[e.jsx(q,{title:"إدارة الصلاحيات"}),e.jsxs("div",{className:"w-full space-y-6 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs(g,{href:"/dashboard/user-roles",className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),"أدوار المستخدمين"]}),e.jsxs(g,{href:"/dashboard/roles",className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"الأدوار"]}),e.jsxs(g,{href:"/dashboard/permission-groups",className:"px-4 py-2 bg-[rgb(30,64,175)] text-white rounded-lg hover:bg-[rgb(25,55,150)] transition-colors flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4"}),"مجموعات الصلاحيات"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-5 w-5"}),e.jsx("h2",{className:"text-xl font-semibold",children:"إدارة الصلاحيات"})]}),e.jsxs(S,{open:L,onOpenChange:h,children:[e.jsx(V,{asChild:!0,children:e.jsxs(l,{children:[e.jsx(M,{className:"h-4 w-4"}),"إضافة صلاحية جديدة"]})}),e.jsxs(T,{children:[e.jsxs(O,{children:[e.jsx(P,{children:"إضافة صلاحية جديدة"}),e.jsx(E,{children:"قم بإنشاء صلاحية جديدة"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"اسم الصلاحية"}),e.jsx(k,{value:r.data.name,onChange:s=>r.setData("name",s.target.value),placeholder:"مثال: create-users, edit-contracts"}),r.errors.name&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:r.errors.name})]})}),e.jsxs(H,{children:[e.jsx(l,{variant:"outline",onClick:()=>h(!1),children:"إلغاء"}),e.jsx(l,{onClick:$,disabled:r.processing,children:r.processing?"جاري الحفظ...":"حفظ"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(f,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"إجمالي الصلاحيات"}),e.jsx(p,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold",children:v.totalPermissions})})]}),e.jsxs(f,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"إجمالي الأدوار"}),e.jsx(F,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold",children:v.totalRoles})})]})]}),e.jsxs(f,{children:[e.jsxs(b,{children:[e.jsx(N,{children:"قائمة الصلاحيات"}),e.jsx(Z,{children:"إدارة جميع الصلاحيات في النظام"})]}),e.jsx(y,{children:e.jsxs(W,{children:[e.jsx(X,{children:e.jsxs(u,{children:[e.jsx(o,{children:"اسم الصلاحية"}),e.jsx(o,{children:"عدد الأدوار"}),e.jsx(o,{children:"الأدوار المرتبطة"}),e.jsx(o,{children:"تاريخ الإنشاء"}),e.jsx(o,{className:"text-left",children:"الإجراءات"})]})}),e.jsx(Y,{children:D.length===0?e.jsx(u,{children:e.jsx(n,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"لا توجد صلاحيات"})}):D.map(s=>e.jsxs(u,{children:[e.jsx(n,{className:"font-medium",children:s.name}),e.jsx(n,{children:s.roles_count}),e.jsx(n,{children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.roles.length>0?s.roles.map(C=>e.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 rounded",children:C.name},C.id)):e.jsx("span",{className:"text-muted-foreground text-sm",children:"لا توجد أدوار"})})}),e.jsx(n,{children:new Date(s.created_at).toLocaleDateString("ar-SA")}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>B(s),children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>z(s),children:e.jsx(se,{className:"h-4 w-4 text-red-500"})})]})})]},s.id))})]})})]}),e.jsx(S,{open:R,onOpenChange:c,children:e.jsxs(T,{children:[e.jsxs(O,{children:[e.jsx(P,{children:"تعديل الصلاحية"}),e.jsx(E,{children:"قم بتعديل اسم الصلاحية"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"اسم الصلاحية"}),e.jsx(k,{value:a.data.name,onChange:s=>a.setData("name",s.target.value),placeholder:"مثال: create-users, edit-contracts"}),a.errors.name&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.errors.name})]})}),e.jsxs(H,{children:[e.jsx(l,{variant:"outline",onClick:()=>c(!1),children:"إلغاء"}),e.jsx(l,{onClick:I,disabled:a.processing,children:a.processing?"جاري الحفظ...":"حفظ"})]})]})}),e.jsx(Q,{open:_,onOpenChange:j,onConfirm:K,title:"حذف الصلاحية",description:`هل أنت متأكد من حذف الصلاحية "${t?.name}"؟`})]})]})}export{De as default};
