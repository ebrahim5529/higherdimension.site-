import{a as r,j as t}from"./app-h_CyTutG.js";import{C as N}from"./combobox-CWRdH9M8.js";import{L as c}from"./label-C1SxD1Jj.js";import{T as z}from"./textarea-CfRl2wc9.js";import{M as w}from"./map-pin-BxS6JPA4.js";function $({value:o={},onChange:k,label:g="العنوان",required:f=!1,disabled:m=!1,className:C="",error:y}){const[s,u]=r.useState(o.governorate||""),[i,d]=r.useState(o.wilayat||""),[l,j]=r.useState(o.details||""),[v,A]=r.useState([]),[S,b]=r.useState([]),x=v.find(e=>e.name===s)?.id,E=v.map(e=>({value:e.name,label:e.name})),G=S.map(e=>({value:e.name,label:e.name}));r.useEffect(()=>{u(o.governorate||""),d(o.wilayat||""),j(o.details||"")},[o]),r.useEffect(()=>{const e=new AbortController;return(async()=>{try{const a=await fetch("/api/locations/governorates",{signal:e.signal});if(!a.ok)return;const p=await a.json();A(p)}catch(a){a.name!=="AbortError"&&console.error("Failed to load governorates",a)}})(),()=>e.abort()},[]),r.useEffect(()=>{if(!x){b([]);return}const e=new AbortController;return(async()=>{try{const a=await fetch(`/api/locations/governorates/${x}/wilayats`,{signal:e.signal});if(!a.ok)return;const p=await a.json();b(p)}catch(a){a.name!=="AbortError"&&console.error("Failed to load wilayats",a)}})(),()=>e.abort()},[x]);const W=e=>{u(e),d(""),h({governorate:e,wilayat:"",details:l})},P=e=>{d(e),h({governorate:s,wilayat:e,details:l})},T=e=>{j(e),h({governorate:s,wilayat:i,details:e})},h=e=>{const n=[];e.governorate&&n.push(e.governorate),e.wilayat&&n.push(e.wilayat),e.details&&n.push(e.details);const a=n.join("، ");k({...e,fullAddress:a})};return t.jsxs("div",{className:`space-y-4 ${C}`,children:[g&&t.jsxs(c,{className:"block text-sm font-medium mb-4",children:[g," ",f&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("div",{children:[t.jsxs(c,{className:"block text-sm font-medium mb-1",children:["المحافظة ",f&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("div",{className:"relative",children:[t.jsx(w,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 z-10"}),t.jsx("div",{className:"pr-10",children:t.jsx(N,{options:E,value:s,onValueChange:W,placeholder:"اختر المحافظة",searchPlaceholder:"اكتب للبحث في المحافظات...",emptyText:"لم يتم العثور على محافظة",disabled:m,className:"rtl:text-right"})})]})]}),s&&t.jsxs("div",{children:[t.jsx(c,{className:"block text-sm font-medium mb-1",children:"الولاية"}),t.jsxs("div",{className:"relative",children:[t.jsx(w,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 z-10"}),t.jsx("div",{className:"pr-10",children:t.jsx(N,{options:G,value:i,onValueChange:P,placeholder:"اختر الولاية",searchPlaceholder:"اكتب للبحث في الولايات...",emptyText:"لم يتم العثور على ولاية",disabled:m||!s,className:"rtl:text-right"})})]})]}),t.jsxs("div",{children:[t.jsx(c,{className:"block text-sm font-medium mb-1",children:"تفاصيل العنوان الإضافية (اختياري)"}),t.jsx(z,{value:l,onChange:e=>T(e.target.value),disabled:m,placeholder:"أدخل تفاصيل إضافية للعنوان مثل الشارع، الرقم، إلخ...",rows:2,className:"rtl:text-right resize-none"})]}),y&&t.jsx("p",{className:"text-red-500 text-xs mt-1",children:y}),(s||i||l)&&t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 border",children:[t.jsx(c,{className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:"معاينة العنوان:"}),t.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-100 rtl:text-right",children:s||i||l?[s,i,l].filter(Boolean).join("، "):"لم يتم تحديد عنوان بعد"})]})]})}export{$ as A};
