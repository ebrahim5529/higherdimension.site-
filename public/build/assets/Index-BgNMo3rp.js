import{u as F,a as t,j as e,H as L,r as u}from"./app-h_CyTutG.js";import{D as U,P as I,X}from"./DashboardLayout-DuEpl8bC.js";import{C as _,b as E,c as P,a as D}from"./card-BZk2LVPZ.js";import{B as d}from"./button-kOcl2KNy.js";import{I as M}from"./input-CUdu6vi7.js";import{s as W}from"./use-toast-BKawAdTf.js";import{M as q}from"./map-pin-BxS6JPA4.js";import{P as A}from"./pencil-DVRgCrnU.js";import{T as J}from"./trash-2-DCygUWGd.js";/* empty css            */import"./createLucideIcon-Ccsm2-70.js";import"./triangle-alert-CgaynJQ9.js";import"./file-text-BBsvBv5v.js";import"./eye-Bq9bJq0x.js";import"./mail-KtPiuE3t.js";function ce(){const{governorates:j,wilayats:n,regions:g,errors:r,flash:i}=F().props,[N,y]=t.useState(""),[c,b]=t.useState(""),[f,o]=t.useState(""),[l,v]=t.useState(null),[w,x]=t.useState(""),[h,p]=t.useState(""),[k,m]=t.useState(""),C=t.useMemo(()=>[...g||[]].sort((s,a)=>s.name.localeCompare(a.name)),[g]),z=t.useMemo(()=>n?.filter(s=>String(s.governorate_id)===c),[n,c]),T=t.useMemo(()=>n?.filter(s=>String(s.governorate_id)===h),[n,h]);t.useEffect(()=>{i?.success&&W.success("تم بنجاح",i.success),i?.error&&W.error("خطأ",i.error)},[i]);const G=()=>{y(""),b(""),o("")},H=s=>{s.preventDefault(),u.post("/locations/regions",{name:N,wilayat_id:Number(f)},{onSuccess:()=>G()})},R=s=>{v(s.id),x(s.name),m(String(s.wilayat_id)),p(String(s.wilayat?.governorate_id||""))},S=()=>{v(null),x(""),m(""),p("")},$=s=>{s.preventDefault(),l&&u.put(`/locations/regions/${l}`,{name:w,wilayat_id:Number(k)},{onSuccess:()=>S()})},B=s=>{confirm("هل أنت متأكد من حذف هذه المنطقة؟")&&u.delete(`/locations/regions/${s}`)};return e.jsxs(U,{children:[e.jsx(L,{title:"المناطق"}),e.jsxs("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"المناطق"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"إدارة المناطق المرتبطة بالولايات"})]}),e.jsxs(_,{children:[e.jsx(E,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5"}),"إضافة منطقة"]})}),e.jsx(D,{children:e.jsxs("form",{onSubmit:H,className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["اسم المنطقة ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(M,{value:N,onChange:s=>y(s.target.value),placeholder:"مثال: منطقة سمائل",className:r?.name?"border-red-500":""}),r?.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["المحافظة ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:c,onChange:s=>{b(s.target.value),o("")},className:"w-full h-10 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 text-sm",children:[e.jsx("option",{value:"",children:"اختر المحافظة"}),j?.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الولاية ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:f,onChange:s=>o(s.target.value),className:`w-full h-10 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 text-sm ${r?.wilayat_id?"border-red-500":""}`,disabled:!c,children:[e.jsx("option",{value:"",children:"اختر الولاية"}),z?.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),r?.wilayat_id&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.wilayat_id})]}),e.jsx("div",{className:"md:col-span-3",children:e.jsxs(d,{type:"submit",className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),"إضافة"]})})]})})]}),e.jsxs(_,{children:[e.jsx(E,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),"قائمة المناطق"]})}),e.jsx(D,{className:"space-y-4",children:C.length===0?e.jsx("div",{className:"text-sm text-gray-500",children:"لا توجد مناطق بعد."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-gray-500 border-b",children:[e.jsx("th",{className:"text-right py-2 px-3",children:"المنطقة"}),e.jsx("th",{className:"text-right py-2 px-3",children:"المحافظة"}),e.jsx("th",{className:"text-right py-2 px-3",children:"الولاية"}),e.jsx("th",{className:"text-right py-2 px-3 w-40",children:"الإجراءات"})]})}),e.jsx("tbody",{children:C.map(s=>e.jsxs("tr",{className:"border-b last:border-0",children:[e.jsx("td",{className:"py-3 px-3",children:l===s.id?e.jsxs("form",{onSubmit:$,className:"flex items-center gap-2",children:[e.jsx(M,{value:w,onChange:a=>x(a.target.value),className:"h-9"}),e.jsx(d,{type:"submit",size:"sm",children:"حفظ"}),e.jsx(d,{type:"button",variant:"ghost",size:"sm",onClick:S,children:e.jsx(X,{className:"h-4 w-4"})})]}):e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.name})}),e.jsx("td",{className:"py-3 px-3",children:l===s.id?e.jsx("select",{value:h,onChange:a=>{p(a.target.value),m("")},className:"h-9 w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-2 text-sm",children:j?.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))}):e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:s.wilayat?.governorate?.name||"—"})}),e.jsx("td",{className:"py-3 px-3",children:l===s.id?e.jsx("select",{value:k,onChange:a=>m(a.target.value),className:"h-9 w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-2 text-sm",children:T?.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))}):e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:s.wilayat?.name||"—"})}),e.jsx("td",{className:"py-3 px-3",children:l===s.id?null:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(d,{type:"button",size:"sm",variant:"outline",onClick:()=>R(s),className:"flex items-center gap-1",children:[e.jsx(A,{className:"h-3 w-3"}),"تعديل"]}),e.jsxs(d,{type:"button",size:"sm",variant:"destructive",onClick:()=>B(s.id),className:"flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),"حذف"]})]})})]},s.id))})]})})})]})]})]})}export{ce as default};
