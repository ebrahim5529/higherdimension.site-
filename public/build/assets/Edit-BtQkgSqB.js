import{b as v,r as h,u as N,j as e,H as _,a as d}from"./app-84_vxQdS.js";import{D as C,a as u,c as w}from"./DashboardLayout-BlAKKRWk.js";import{C as k,a as S,b as D,d as E}from"./card-eaxFl7Bs.js";import{B as x}from"./button-BjYYNMND.js";import{I as i}from"./input-Cl715XOF.js";import{s as n}from"./use-toast-CojTFCbM.js";import{C as p}from"./combobox-DAd9HnJJ.js";import{A as $}from"./arrow-left-EPoubND8.js";import{S as F}from"./save-DTlifEli.js";/* empty css            */import"./createLucideIcon-BXz5zsdN.js";import"./triangle-alert-D1In3kIi.js";import"./file-text-1z2HdD-B.js";import"./eye-D1j9lGVu.js";import"./shield-CpYDa7Ju.js";import"./circle-alert-BuTutxtS.js";import"./map-pin-BohvRHeB.js";import"./mail-Ti8-EjQn.js";import"./dialog-DCX_5GXu.js";import"./index-CVoKwWwS.js";import"./check-aK--ux3n.js";function Z({salary:l,employees:b}){const{flash:o}=v().props;h.useEffect(()=>{o?.success&&n.success("نجح",o.success),o?.error&&n.error("خطأ",o.error)},[o]);const{data:a,setData:r,put:j,processing:m,errors:t}=N({employee_id:l.employee_id.toString(),basic_salary:l.basic_salary.toString(),allowances:l.allowances.toString(),deductions:l.deductions.toString(),total_salary:l.total_salary.toString(),payment_date:l.payment_date,status:l.status,payment_method:l.payment_method,notes:l.notes||""});h.useEffect(()=>{const s=parseFloat(a.basic_salary)||0,c=parseFloat(a.allowances)||0,g=parseFloat(a.deductions)||0,f=s+c-g;r("total_salary",f.toString())},[a.basic_salary,a.allowances,a.deductions]);const y=s=>{s.preventDefault(),j(`/employees/salaries/${l.id}`,{onSuccess:()=>{n.success("تم التحديث بنجاح","تم تحديث الراتب بنجاح"),d.visit(`/employees/salaries/${l.id}`)},onError:c=>{c.message?n.error("خطأ في التحديث",c.message):n.error("خطأ في التحديث","يرجى التحقق من البيانات المدخلة")}})};return e.jsxs(C,{children:[e.jsx(_,{title:"تعديل الراتب"}),e.jsxs("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>d.visit("/employees/salaries"),children:e.jsx($,{className:"h-4 w-4"})}),e.jsx("div",{children:e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(u,{className:"h-6 w-6"}),"تعديل الراتب"]})})]})}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs(k,{children:[e.jsx(S,{children:e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5"}),"معلومات الراتب"]})}),e.jsx(E,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الموظف ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(p,{options:b.map(s=>({value:s.id.toString(),label:`${s.name} (${s.employee_number})`})),value:a.employee_id,onValueChange:s=>r("employee_id",s),placeholder:"اختر الموظف",searchPlaceholder:"ابحث عن الموظف...",emptyText:"لا يوجد موظفين",error:!!t.employee_id}),t.employee_id&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.employee_id})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["تاريخ الدفع ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(w,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(i,{type:"date",value:a.payment_date,onChange:s=>r("payment_date",s.target.value),className:`pr-10 ${t.payment_date?"border-red-500":""}`})]}),t.payment_date&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.payment_date})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الراتب الأساسي ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(i,{type:"number",step:"0.01",min:"0",value:a.basic_salary,onChange:s=>r("basic_salary",s.target.value),placeholder:"0.00",className:t.basic_salary?"border-red-500":""}),t.basic_salary&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.basic_salary})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"البدلات"}),e.jsx(i,{type:"number",step:"0.01",min:"0",value:a.allowances,onChange:s=>r("allowances",s.target.value),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"الخصومات"}),e.jsx(i,{type:"number",step:"0.01",min:"0",value:a.deductions,onChange:s=>r("deductions",s.target.value),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الإجمالي ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(i,{type:"number",step:"0.01",min:"0",value:a.total_salary,onChange:s=>r("total_salary",s.target.value),placeholder:"0.00",className:`font-bold text-[#913D95] ${t.total_salary?"border-red-500":""}`,readOnly:!0}),t.total_salary&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.total_salary})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الحالة ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(p,{options:[{value:"pending",label:"في الانتظار"},{value:"paid",label:"مدفوعة"},{value:"overdue",label:"متأخرة"}],value:a.status,onValueChange:s=>r("status",s),placeholder:"اختر الحالة",searchPlaceholder:"ابحث...",emptyText:"لا توجد نتائج"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["طريقة الدفع ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(p,{options:[{value:"bank_transfer",label:"تحويل بنكي"},{value:"cash",label:"نقدي"},{value:"check",label:"شيك"}],value:a.payment_method,onValueChange:s=>r("payment_method",s),placeholder:"اختر طريقة الدفع",searchPlaceholder:"ابحث...",emptyText:"لا توجد نتائج"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"ملاحظات"}),e.jsx("textarea",{value:a.notes,onChange:s=>r("notes",s.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-800 dark:text-white",placeholder:"أدخل أي ملاحظات عن الراتب"})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-6 border-t",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>d.visit("/employees/salaries"),disabled:m,children:"إلغاء"}),e.jsxs(x,{type:"submit",disabled:m,className:"flex items-center gap-2 bg-[#913D95] hover:bg-[#7A2F7D]",children:[e.jsx(F,{className:"h-4 w-4"}),m?"جاري الحفظ...":"حفظ التعديلات"]})]})]})]})]})}export{Z as default};
