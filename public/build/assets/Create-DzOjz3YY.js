import{u as g,a as p,b as v,j as e,H as N,r as m}from"./app-CSCnDOL8.js";import{D as _}from"./DashboardLayout-BtxHxH26.js";import{C,b as w,c as k,a as S}from"./card-BRpxhRQK.js";import{B as d}from"./button-D02rIfzJ.js";import{I as o}from"./input-uyGVjKtO.js";import{s as n}from"./use-toast-qNO1wWiP.js";import{C as x}from"./combobox-6UFUBvii.js";import{A as D}from"./arrow-left-BteAu9D-.js";import{D as h,C as T}from"./user-Bic5WbAP.js";import{S as E}from"./save-BYI_s2Lq.js";/* empty css            */import"./eye-CWbNWa5x.js";import"./dialog-WW10pjbG.js";import"./index-tTB7xU6J.js";import"./check-YiOUVOgY.js";function K({employees:u}){const{flash:r}=g().props;p.useEffect(()=>{r?.success&&n.success("نجح",r.success),r?.error&&n.error("خطأ",r.error)},[r]);const{data:a,setData:t,post:b,processing:i,errors:l}=v({employee_id:"",basic_salary:"",allowances:"0",deductions:"0",total_salary:"",payment_date:new Date().toISOString().split("T")[0],status:"pending",payment_method:"bank_transfer",notes:""});p.useEffect(()=>{const s=parseFloat(a.basic_salary.toString())||0,c=parseFloat(a.allowances.toString())||0,y=parseFloat(a.deductions.toString())||0,f=s+c-y;t("total_salary",f.toString())},[a.basic_salary,a.allowances,a.deductions]);const j=s=>{s.preventDefault(),b("/employees/salaries",{onSuccess:()=>{n.success("تم الإنشاء بنجاح","تم إضافة الراتب بنجاح"),m.visit("/employees/salaries")},onError:c=>{c.message?n.error("خطأ في الإنشاء",c.message):n.error("خطأ في الإنشاء","يرجى التحقق من البيانات المدخلة")}})};return e.jsxs(_,{children:[e.jsx(N,{title:"إضافة راتب جديد"}),e.jsxs("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>m.visit("/employees/salaries"),children:e.jsx(D,{className:"h-4 w-4"})}),e.jsx("div",{children:e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(h,{className:"h-6 w-6"}),"إضافة راتب جديد"]})})]})}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs(C,{children:[e.jsx(w,{children:e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-5 w-5"}),"معلومات الراتب"]})}),e.jsx(S,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الموظف ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{options:u.map(s=>({value:s.id.toString(),label:`${s.name} (${s.employee_number})`})),value:a.employee_id,onValueChange:s=>t("employee_id",s),placeholder:"اختر الموظف",searchPlaceholder:"ابحث عن الموظف...",emptyText:"لا يوجد موظفين",error:!!l.employee_id}),l.employee_id&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.employee_id})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["تاريخ الدفع ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(o,{type:"date",value:a.payment_date,onChange:s=>t("payment_date",s.target.value),className:`pr-10 ${l.payment_date?"border-red-500":""}`})]}),l.payment_date&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.payment_date})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الراتب الأساسي ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{type:"number",step:"0.01",min:"0",value:a.basic_salary,onChange:s=>t("basic_salary",s.target.value),placeholder:"0.00",className:l.basic_salary?"border-red-500":""}),l.basic_salary&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.basic_salary})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"البدلات"}),e.jsx(o,{type:"number",step:"0.01",min:"0",value:a.allowances,onChange:s=>t("allowances",s.target.value),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"الخصومات"}),e.jsx(o,{type:"number",step:"0.01",min:"0",value:a.deductions,onChange:s=>t("deductions",s.target.value),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الإجمالي ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{type:"number",step:"0.01",min:"0",value:a.total_salary,onChange:s=>t("total_salary",s.target.value),placeholder:"0.00",className:`font-bold text-[#913D95] ${l.total_salary?"border-red-500":""}`,readOnly:!0}),l.total_salary&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.total_salary})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["الحالة ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{options:[{value:"pending",label:"في الانتظار"},{value:"paid",label:"مدفوعة"},{value:"overdue",label:"متأخرة"}],value:a.status,onValueChange:s=>t("status",s),placeholder:"اختر الحالة",searchPlaceholder:"ابحث...",emptyText:"لا توجد نتائج"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["طريقة الدفع ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{options:[{value:"bank_transfer",label:"تحويل بنكي"},{value:"cash",label:"نقدي"},{value:"check",label:"شيك"}],value:a.payment_method,onValueChange:s=>t("payment_method",s),placeholder:"اختر طريقة الدفع",searchPlaceholder:"ابحث...",emptyText:"لا توجد نتائج"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"ملاحظات"}),e.jsx("textarea",{value:a.notes,onChange:s=>t("notes",s.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-800 dark:text-white",placeholder:"أدخل أي ملاحظات عن الراتب"})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-6 border-t",children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>m.visit("/employees/salaries"),disabled:i,children:"إلغاء"}),e.jsxs(d,{type:"submit",disabled:i,className:"flex items-center gap-2 bg-[#913D95] hover:bg-[#7A2F7D]",children:[e.jsx(E,{className:"h-4 w-4"}),i?"جاري الحفظ...":"حفظ الراتب"]})]})]})]})]})}export{K as default};
