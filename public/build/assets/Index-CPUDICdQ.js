import{j as e,a as o,u as F,H as M,r as j}from"./app-CyMgrt3T.js";import{e as P,B as C,T as R,P as V,S as I,f as k,c as A,D as E,g as y,a as z}from"./DashboardLayout-C2BzyX_G.js";import{U as T,D as $,C as O}from"./user-BsMlQm9m.js";import{F as B}from"./file-text-DXOoDEiS.js";import{u as U,f as S,g as H,a as K,b as L,c as Y}from"./index-BSSs85wL.js";import{C as G,b as q,c as _,a as J}from"./card-Ds_akk2v.js";import{B as n}from"./button-BYQHTvmA.js";import{S as Q}from"./star-CAWxp73e.js";import{E as W}from"./eye-Dxsa3bX3.js";import{S as X}from"./square-pen-Ct_0Pi5_.js";import{M as Z}from"./mail-CC5tAMUb.js";import{T as ee}from"./trash-2-Bkqmg5sf.js";import{D as se}from"./download-Da8sFeMc.js";import{F as ae}from"./filter-D7DSNU7b.js";import{C as D}from"./chevron-up-CLSnUCoS.js";import{C as te}from"./chevron-left-Yhr98lGp.js";import{s as x}from"./use-toast-C91E3Tui.js";/* empty css            */import"./createLucideIcon-BYf3FF-E.js";import"./triangle-alert-CIcdgZcT.js";function re({stats:l}){return l?e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 hover:bg-[#58d2c8]/5 hover:border-[#58d2c8]/30 hover:shadow-lg hover:shadow-[#58d2c8]/20 hover:scale-105 transition-all duration-300 cursor-pointer group min-h-[120px]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm text-gray-600 dark:text-gray-400 group-hover:text-[#58d2c8] transition-colors duration-300 font-almarai mb-2",children:"إجمالي العملاء"}),e.jsx("div",{className:"text-2xl font-bold text-[#58d2c8] group-hover:text-[#4AB8B3] transition-colors duration-300 font-tajawal",children:l.totalCustomers||0}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[l.activeCustomers||0," نشط، ",l.totalCustomers-l.activeCustomers||0," غير نشط"]})]}),e.jsx("div",{className:"p-2 bg-[#58d2c8]/10 rounded-lg group-hover:bg-[#58d2c8]/20 transition-all duration-300",children:e.jsx(P,{className:"h-6 w-6 text-[#58d2c8] group-hover:scale-110 transition-transform duration-300"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 hover:bg-[#58d2c8]/5 hover:border-[#58d2c8]/30 hover:shadow-lg hover:shadow-[#58d2c8]/20 hover:scale-105 transition-all duration-300 cursor-pointer group min-h-[120px]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm text-gray-600 dark:text-gray-400 group-hover:text-[#58d2c8] transition-colors duration-300 font-almarai mb-2",children:"أنواع العملاء"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm",children:"أفراد"})]}),e.jsx("span",{className:"text-sm font-medium text-[#58d2c8]",children:l.individualCustomers||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm",children:"شركات"})]}),e.jsx("span",{className:"text-sm font-medium text-[#58d2c8]",children:l.companyCustomers||0})]})]})]}),e.jsx("div",{className:"p-2 bg-[#58d2c8]/10 rounded-lg group-hover:bg-[#58d2c8]/20 transition-all duration-300",children:e.jsx(C,{className:"h-6 w-6 text-[#58d2c8] group-hover:scale-110 transition-transform duration-300"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 hover:bg-[#58d2c8]/5 hover:border-[#58d2c8]/30 hover:shadow-lg hover:shadow-[#58d2c8]/20 hover:scale-105 transition-all duration-300 cursor-pointer group min-h-[120px]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm text-gray-600 dark:text-gray-400 group-hover:text-[#58d2c8] transition-colors duration-300 font-almarai mb-2",children:"العقود والمدفوعات"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"text-sm",children:"إجمالي العقود"})]}),e.jsx("span",{className:"text-sm font-medium text-[#58d2c8]",children:l.totalContracts||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm",children:"إجمالي المدفوعات"})]}),e.jsxs("span",{className:"text-sm font-medium text-[#58d2c8]",children:[l.totalPayments?.toLocaleString()||0," ر.ع"]})]})]})]}),e.jsx("div",{className:"p-2 bg-[#58d2c8]/10 rounded-lg group-hover:bg-[#58d2c8]/20 transition-all duration-300",children:e.jsx(R,{className:"h-6 w-6 text-[#58d2c8] group-hover:scale-110 transition-transform duration-300"})})]})})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"})]})})})}function le({data:l,onAddCustomer:f,onEditCustomer:i,onDeleteCustomer:h,onViewCustomer:c,onExportCustomers:d}){const[u,N]=o.useState([]),[v,b]=o.useState([]),[p,m]=o.useState(""),[g,w]=o.useState(!1),r=o.useMemo(()=>[{accessorKey:"name",header:"اسم العميل",cell:({row:a})=>e.jsxs("div",{className:"flex items-center gap-2",children:[a.original.customerType==="COMPANY"?e.jsx(C,{className:"h-4 w-4 text-blue-600"}):e.jsx(T,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-medium",children:a.getValue("name")})]})},{accessorKey:"customerType",header:"نوع العميل",cell:({row:a})=>{const s=a.getValue("customerType");return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s==="COMPANY"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}`,children:s==="COMPANY"?"شركة":"فرد"})}},{accessorKey:"status",header:"الحالة",cell:({row:a})=>{const s=a.getValue("status");return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s==="ACTIVE"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:s==="ACTIVE"?"نشط":"غير نشط"})}},{accessorKey:"rating",header:"التقييم",cell:({row:a})=>{const s=a.getValue("rating");return s?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"h-3 w-3 text-yellow-500 fill-current"}),e.jsxs("span",{className:"text-sm",children:[s,"/5"]})]}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"-"})}},{accessorKey:"registrationDate",header:"تاريخ التسجيل",cell:({row:a})=>{const s=a.getValue("registrationDate");return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{className:"h-3 w-3"}),e.jsx("span",{className:"text-sm",children:new Date(s).toLocaleDateString("ar-SA")})]})}},{id:"actions",header:"الإجراءات",cell:({row:a})=>{const s=a.original;return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>c(s),className:"h-8 w-8 p-0",title:"عرض التفاصيل",children:e.jsx(W,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>i(s),className:"h-8 w-8 p-0",title:"تعديل",children:e.jsx(X,{className:"h-4 w-4"})}),s.email&&e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>window.open(`mailto:${s.email}`),className:"h-8 w-8 p-0 text-green-600 hover:text-green-700",title:`إرسال بريد: ${s.email}`,children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>h(s),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",title:"حذف",children:e.jsx(ee,{className:"h-4 w-4"})})]})}}],[c,i,h]),t=U({data:l,columns:r,onSortingChange:N,onColumnFiltersChange:b,onGlobalFilterChange:m,getCoreRowModel:Y(),getFilteredRowModel:L(),getSortedRowModel:K(),getPaginationRowModel:H(),state:{sorting:u,columnFilters:v,globalFilter:p},initialState:{pagination:{pageSize:10}}});return e.jsxs(G,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{children:"قائمة العملاء"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:d,className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"تصدير"]}),e.jsxs(n,{onClick:f,className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),"إضافة عميل"]})]})]})}),e.jsxs(J,{children:[e.jsxs("div",{className:"mb-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(I,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"البحث في العملاء...",value:p,onChange:a=>m(a.target.value),className:"w-full pr-10 pl-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-800"})]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>w(!g),className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),"فلترة",g?e.jsx(D,{className:"h-4 w-4"}):e.jsx(k,{className:"h-4 w-4"})]})]}),g&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"الحالة"}),e.jsxs("select",{value:t.getColumn("status")?.getFilterValue()??"",onChange:a=>t.getColumn("status")?.setFilterValue(a.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700",children:[e.jsx("option",{value:"",children:"جميع الحالات"}),e.jsx("option",{value:"ACTIVE",children:"نشط"}),e.jsx("option",{value:"INACTIVE",children:"غير نشط"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"نوع العميل"}),e.jsxs("select",{value:t.getColumn("customerType")?.getFilterValue()??"",onChange:a=>t.getColumn("customerType")?.setFilterValue(a.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700",children:[e.jsx("option",{value:"",children:"جميع الأنواع"}),e.jsx("option",{value:"INDIVIDUAL",children:"فرد"}),e.jsx("option",{value:"COMPANY",children:"شركة"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"الترتيب حسب"}),e.jsxs("select",{onChange:a=>{const s=a.target.value;if(s)switch(s){case"newest":t.getColumn("registrationDate")?.toggleSorting(!1);break;case"oldest":t.getColumn("registrationDate")?.toggleSorting(!0);break;case"rating-high":t.getColumn("rating")?.toggleSorting(!1);break;case"rating-low":t.getColumn("rating")?.toggleSorting(!0);break}},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700",children:[e.jsx("option",{value:"",children:"اختر الترتيب"}),e.jsx("option",{value:"newest",children:"الأحدث أولاً"}),e.jsx("option",{value:"oldest",children:"الأقدم أولاً"}),e.jsx("option",{value:"rating-high",children:"أعلى تقييم أولاً"}),e.jsx("option",{value:"rating-low",children:"أقل تقييم أولاً"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(n,{variant:"outline",size:"sm",onClick:()=>{t.resetColumnFilters(),m("")},className:"w-full",children:"مسح جميع الفلاتر"})})]})]}),e.jsx("div",{className:"rounded-md border overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[1000px]",children:[e.jsx("thead",{children:t.getHeaderGroups().map(a=>e.jsx("tr",{className:"border-b bg-gray-50 dark:bg-gray-800",children:a.headers.map(s=>e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-900 dark:text-gray-100 whitespace-nowrap",children:s.isPlaceholder?null:e.jsxs("div",{className:s.column.getCanSort()?"cursor-pointer select-none flex items-center gap-1":"",onClick:s.column.getToggleSortingHandler(),children:[S(s.column.columnDef.header,s.getContext()),s.column.getCanSort()&&e.jsx("div",{className:"flex flex-col",children:s.column.getIsSorted()==="asc"?e.jsx(D,{className:"h-3 w-3"}):s.column.getIsSorted()==="desc"?e.jsx(k,{className:"h-3 w-3"}):e.jsx("div",{className:"h-3 w-3"})})]})},s.id))},a.id))}),e.jsx("tbody",{children:t.getRowModel().rows?.length?t.getRowModel().rows.map(a=>e.jsx("tr",{className:"border-b hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:a.getVisibleCells().map(s=>e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:S(s.column.columnDef.cell,s.getContext())},s.id))},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:r.length,className:"h-24 text-center text-muted-foreground",children:"لا توجد بيانات للعرض"})})})]})}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-sm text-muted-foreground",children:["عرض ",t.getState().pagination.pageIndex*t.getState().pagination.pageSize+1," إلى"," ",Math.min((t.getState().pagination.pageIndex+1)*t.getState().pagination.pageSize,t.getFilteredRowModel().rows.length)," ","من ",t.getFilteredRowModel().rows.length," عميل"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>t.previousPage(),disabled:!t.getCanPreviousPage(),children:[e.jsx(te,{className:"h-4 w-4"}),"السابق"]}),e.jsxs("span",{className:"text-sm",children:["صفحة ",t.getState().pagination.pageIndex+1," من ",t.getPageCount()]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>t.nextPage(),disabled:!t.getCanNextPage(),children:["التالي",e.jsx(A,{className:"h-4 w-4"})]})]})]})]})]})}function Se({customers:l,stats:f}){const{flash:i}=F().props,[h,c]=o.useState(!1),[d,u]=o.useState(null);o.useEffect(()=>{i?.success&&x.success("نجح",i.success),i?.error&&x.error("خطأ",i.error)},[i]);const N=l.map(r=>({id:r.id.toString(),customerNumber:r.customerNumber,name:r.name,customerType:r.customerType,status:r.status,rating:r.rating||0,registrationDate:new Date(r.registrationDate),email:r.email,contractsCount:r.contractsCount})),v=()=>{j.visit("/customers/create")},b=r=>{j.visit(`/customers/${r.id}/edit`)},p=r=>{u(r),c(!0)},m=()=>{d&&j.delete(`/customers/${d.id}`,{onSuccess:()=>{x.success("تم الحذف بنجاح",`تم حذف العميل "${d.name}" بنجاح`),c(!1),u(null)},onError:r=>{x.error("فشل الحذف",r?.message||"حدث خطأ أثناء حذف العميل")}})},g=r=>{j.visit(`/customers/${r.id}`)},w=()=>{x.info("قريباً","سيتم إضافة ميزة التصدير قريباً")};return e.jsxs(E,{children:[e.jsx(M,{title:"إدارة العملاء"}),e.jsxs("div",{className:"w-full space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5"}),e.jsx("h2",{className:"text-xl font-semibold",children:"العملاء"})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5"}),e.jsx("h2",{className:"text-xl font-semibold",children:"إحصائيات العملاء"})]}),e.jsx(re,{stats:f})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5"}),e.jsx("h2",{className:"text-xl font-semibold",children:"قائمة العملاء"})]}),e.jsx(le,{data:N,onAddCustomer:v,onEditCustomer:b,onDeleteCustomer:p,onViewCustomer:g,onExportCustomers:w})]}),e.jsx(z,{open:h,onOpenChange:c,onConfirm:m,title:"تأكيد حذف العميل",description:`هل أنت متأكد من حذف العميل "${d?.name}"؟ لا يمكن التراجع عن هذا الإجراء.`,confirmText:"حذف",cancelText:"إلغاء",variant:"danger"})]})]})}export{Se as default};
