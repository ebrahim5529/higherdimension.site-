import{r as g,j as e,H as w,a as S}from"./app-DC70pVjm.js";import{D as C,a as L,U as T,b as B,c as D}from"./DashboardLayout-hjp-9ivh.js";import{C as E,b as H,c as M,a as _}from"./card-DdBhtchT.js";import{B as p}from"./button-CCsAHJj1.js";import{L as A}from"./label-vs7EW7ob.js";import{s as h}from"./use-toast-weOckxar.js";import{c as i}from"./createLucideIcon-gXsaNq4V.js";import{S as u}from"./save-B12NfqSq.js";/* empty css            */import"./triangle-alert-Dwooo7My.js";import"./file-text-j4Qn0fru.js";import"./eye-DDqfhxOU.js";import"./shield-5CH0y752.js";import"./circle-alert-CnKodfJj.js";import"./map-pin-BBAWf8o9.js";import"./mail-BERZcaE2.js";const F=i("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);const I=i("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);const O=i("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);const R=i("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]),U={payment:{label:"حسابات الدفع",icon:F,description:"تحديد حسابات النقدية والبنك المستخدمة عند تسجيل المدفوعات"},customers:{label:"حسابات العملاء والعقود",icon:D,description:"تحديد حسابات العملاء والإيرادات المرتبطة بالعقود"},suppliers:{label:"حسابات الموردين والمشتريات",icon:B,description:"تحديد حسابات الموردين ومصروفات المشتريات"},employees:{label:"حسابات الموظفين والرواتب",icon:T,description:"تحديد حسابات الرواتب ومستحقات الموظفين"},general:{label:"إعدادات عامة",icon:L,description:"إعدادات عامة للنظام المحاسبي"}};function ae({settings:d,accounts:b}){const[n,m]=g.useState(()=>{const s={};return Object.values(d).forEach(r=>{s[r.key]=r.value||""}),s}),[c,o]=g.useState(!1),y=(s,r)=>{m(l=>({...l,[s]:r}))},j=s=>{m(r=>({...r,[s]:r[s]==="1"?"0":"1"}))},x=()=>{o(!0),S.post("/accounting/settings",{settings:n},{preserveScroll:!0,onSuccess:()=>{h.success("تم حفظ الإعدادات بنجاح"),o(!1)},onError:()=>{h.error("حدث خطأ أثناء الحفظ"),o(!1)}})},f=b.filter(s=>!s.is_parent),k=Object.values(d).reduce((s,r)=>(s[r.group]||(s[r.group]=[]),s[r.group].push(r),s),{}),N=["payment","customers","suppliers","employees","general"];return e.jsxs(C,{children:[e.jsx(w,{title:"إعدادات الربط المحاسبي"}),e.jsxs("div",{className:"p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:e.jsx(I,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"إعدادات الربط المحاسبي"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"تحديد الحسابات الافتراضية لربط العمليات المالية بالقيود المحاسبية تلقائياً"})]})]}),e.jsxs(p,{onClick:x,disabled:c,className:"gap-2",children:[e.jsx(u,{className:"h-4 w-4"}),c?"جاري الحفظ...":"حفظ الإعدادات"]})]}),e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:[e.jsx("strong",{children:"ملاحظة:"})," عند تحديد الحسابات أدناه، سيقوم النظام تلقائياً بإنشاء قيود محاسبية عند تسجيل المدفوعات، إنشاء العقود، دفع الرواتب، وتسجيل المشتريات. يجب اختيار حسابات فرعية (غير رئيسية) فقط."]})}),N.map(s=>{const r=k[s];if(!r)return null;const l=U[s],v=l.icon;return e.jsxs(E,{children:[e.jsx(H,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-800 rounded-lg",children:e.jsx(v,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsx(M,{className:"text-lg",children:l.label}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:l.description})]})]})}),e.jsx(_,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:r.map(a=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{className:"text-sm font-medium",children:a.label}),a.key==="auto_post_entries"?e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("button",{type:"button",onClick:()=>j(a.key),className:"flex items-center gap-2 text-sm",children:n[a.key]==="1"?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"h-8 w-8 text-green-500"}),e.jsx("span",{className:"text-green-600 dark:text-green-400 font-medium",children:"مفعّل — يتم ترحيل القيود تلقائياً"})]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-8 w-8 text-gray-400"}),e.jsx("span",{className:"text-gray-500 font-medium",children:"معطّل — القيود تبقى مسودة"})]})})}):e.jsxs("select",{value:n[a.key]||"",onChange:t=>y(a.key,t.target.value),className:"w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-3 py-2 text-sm text-gray-900 dark:text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"-- اختر الحساب --"}),f.map(t=>e.jsxs("option",{value:String(t.id),children:[t.code," - ",t.name]},t.id))]})]},a.key))})})]},s)}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(p,{onClick:x,disabled:c,size:"lg",className:"gap-2",children:[e.jsx(u,{className:"h-4 w-4"}),c?"جاري الحفظ...":"حفظ جميع الإعدادات"]})})]})]})}export{ae as default};
