import{b as z,r as x,u as U,j as e,H as _,a as d}from"./app-D82DrFCd.js";import{D as M,U as T,c as N,a as E,d as I,C as R,f as o,A as O,T as V,P as W,b as q}from"./DashboardLayout-DcMAmy16.js";import{B as r}from"./circle-alert-3MeTpwRy.js";import{I as G}from"./input-DOSntOr0.js";import{s as l}from"./use-toast-D0YLgtPf.js";import{A as H}from"./arrow-right-Cp4DoITz.js";import{F as n}from"./file-text-yOBNPwsf.js";import{S as J}from"./send-DaO9CE-j.js";import{M as K}from"./map-pin-CaPsoqIa.js";import{G as Q}from"./git-branch-B2gKIzSx.js";import{E as y}from"./eye-OLAE_IzF.js";import{c as X}from"./createLucideIcon-DqjWOHkq.js";import{U as Y}from"./upload-Dcrmci-I.js";import{D as Z}from"./download-KcM1btki.js";import{T as ee}from"./trash-2-DX8wrPSz.js";/* empty css            */import"./triangle-alert-3SPaXazj.js";import"./shield-CMB-bgTC.js";import"./mail-CEBRvuzG.js";const v=X("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);function be({contract:s}){const{flash:c}=z().props,[f,g]=x.useState(!1),[h,p]=x.useState(!1),w=x.useRef(null),[k,j]=x.useState(!1),[u,b]=x.useState(null),i=U({file:null,description:""});x.useEffect(()=>{c?.success&&l.success("نجح",c.success),c?.error&&l.error("خطأ",c.error)},[c]);const D=a=>{const t=a.target.files?.[0]||null;if(t){if(t.size>10*1024*1024){l.error("خطأ","حجم الملف يجب أن يكون أقل من 10MB");return}i.setData("file",t)}},A=a=>{if(a.preventDefault(),!i.data.file){l.error("خطأ","يرجى اختيار ملف للرفع");return}p(!0),i.post(`/contracts/${s.id}/attachments`,{forceFormData:!0,onSuccess:()=>{l.success("نجح","تم رفع المرفق بنجاح"),i.reset(),g(!1),p(!1),d.reload()},onError:t=>{p(!1),t.file?l.error("خطأ",Array.isArray(t.file)?t.file[0]:t.file):l.error("خطأ","فشل رفع الملف")}})},C=a=>{b(a),j(!0)},$=()=>{u&&d.delete(`/contracts/${s.id}/attachments/${u.id}`,{onSuccess:()=>{l.success("نجح","تم حذف المرفق بنجاح"),j(!1),b(null),d.reload()},onError:()=>{l.error("خطأ","فشل حذف المرفق")}})},B=a=>{window.open(`/contracts/${s.id}/attachments/${a.id}/download`,"_blank")},S=a=>{const t=`/storage/${a.file_path}`;window.open(t,"_blank")},F=a=>{const t=a.toLowerCase();return t==="pdf"?e.jsx(n,{className:"h-6 w-6 text-red-600"}):["zip","rar","7z"].includes(t)?e.jsx(n,{className:"h-6 w-6 text-orange-600"}):["jpg","jpeg","png","gif"].includes(t)?e.jsx(n,{className:"h-6 w-6 text-blue-600"}):e.jsx(n,{className:"h-6 w-6 text-orange-600"})},m=a=>new Intl.NumberFormat("ar-OM",{minimumFractionDigits:3,maximumFractionDigits:3}).format(a),L=a=>{switch(a){case"نشط":return"bg-green-100 text-green-800 border-green-300";case"منتهي":return"bg-gray-100 text-gray-800 border-gray-300";case"ملغي":return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},P=a=>{switch(a){case"مدفوع":return"bg-green-100 text-green-800";case"غير مدفوع":return"bg-red-100 text-red-800";case"مدفوع جزئياً":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs(M,{children:[e.jsx(_,{title:`عقد ${s.contractNumber}`}),e.jsx("main",{className:"flex-1 p-3 sm:p-4 lg:p-6 xl:p-8 overflow-x-auto",children:e.jsx("div",{className:"max-w-full",children:e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-12",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>d.visit("/contracts"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(H,{className:"h-6 w-6 text-gray-600"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-[#58d2c8]/10 rounded-lg",children:e.jsx(n,{className:"h-7 w-7 text-[#58d2c8]"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"تفاصيل العقد"}),e.jsx("a",{href:`/contract/sign/${s.contractNumber}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-[#58d2c8] hover:text-[#4AB8B3] hover:underline transition-colors cursor-pointer mt-1 block",onClick:a=>{a.preventDefault(),window.open(`/contract/sign/${s.contractNumber}`,"_blank")},children:s.contractNumber})]})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(r,{className:"px-6 py-3 bg-[#58d2c8] hover:bg-[#4AB8B3] text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),"إرسال سند استلام"]})})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(T,{className:"h-6 w-6 text-blue-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"معلومات العميل"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"اسم العميل"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.customerName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"رقم العميل"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.customerNumber})]})]})]}),e.jsxs("div",{className:"bg-white border-2 border-purple-200 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(n,{className:"h-6 w-6 text-purple-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"معلومات العقد"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"رقم العقد"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.contractNumber})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"نوع العقد"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"الحالة"}),e.jsx("span",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border-2 ${L(s.status)}`,children:s.status})]})]})]})]}),e.jsxs("div",{className:"bg-white border-2 border-green-200 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(N,{className:"h-6 w-6 text-green-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"التواريخ والمدة"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"تاريخ البدء"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.startDateAr||s.startDate})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"تاريخ الانتهاء"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.endDateAr||s.endDate})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"مدة العقد"}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[s.duration," يوم"]})]})]})]}),s.detailedDuration&&s.detailedDuration.totalDays>0&&e.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(N,{className:"h-6 w-6 text-blue-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"المدة التفصيلية"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-2",children:"التفصيل:"}),e.jsxs("div",{className:"space-y-2",children:[s.detailedDuration.months.map((a,t)=>e.jsx("p",{className:"text-sm text-gray-700",children:a.description},t)),e.jsxs("p",{className:"text-sm font-semibold text-gray-900 mt-2",children:["المجموع: ",s.detailedDuration.totalDays," يومًا."]})]})]})})]}),e.jsxs("div",{className:"bg-white border-2 border-yellow-200 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(E,{className:"h-6 w-6 text-yellow-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"المعلومات المالية"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"إجمالي العقد"}),e.jsxs("p",{className:"text-2xl font-bold text-[#58d2c8]",children:[m(s.amount)," ر.ع."]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"المبلغ المدفوع"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[m(s.totalPayments)," ر.ع."]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"المبلغ المتبقي"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[m(s.remainingAmount)," ر.ع."]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(K,{className:"h-6 w-6 text-gray-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"الموقع"})]}),e.jsx("div",{className:"space-y-2",children:s.deliveryAddressDetails?e.jsxs(e.Fragment,{children:[s.deliveryAddressDetails.governorate&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"المحافظة:"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.deliveryAddressDetails.governorate})]}),s.deliveryAddressDetails.wilayat&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"الولاية:"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.deliveryAddressDetails.wilayat})]}),s.deliveryAddressDetails.region&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"المنطقة:"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.deliveryAddressDetails.region})]}),s.deliveryAddressDetails.details&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"التفاصيل:"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.deliveryAddressDetails.details})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"العنوان الكامل:"}),e.jsx("p",{className:"text-sm text-gray-900 font-medium",children:s.deliveryAddressDetails.fullAddress||s.deliveryAddress})]})]}):e.jsx("p",{className:"text-lg text-gray-900",children:s.deliveryAddress||"غير محدد"})})]}),e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(I,{className:"h-6 w-6 text-gray-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"المعدات"})]}),e.jsxs("p",{className:"text-gray-900",children:[e.jsx("span",{className:"text-3xl font-semibold text-[#58d2c8]",children:s.equipmentCount})," ",e.jsx("span",{className:"text-lg text-gray-600",children:"قطعة"})]})]})]}),e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(R,{className:"h-6 w-6 text-gray-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"معلومات النظام"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"تاريخ الإنشاء"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.createdDateAr||s.createdDate})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"آخر تحديث"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.updatedDateAr||s.updatedDate})]})]})]}),e.jsxs("div",{className:"bg-white border-2 border-indigo-200 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(o,{className:"h-6 w-6 text-indigo-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"تفاصيل حالة الدفع"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"حالة الدفع"}),e.jsx("span",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium ${P(s.paymentStatus)}`,children:s.paymentStatus})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"نسبة الدفع"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-green-500 h-3 rounded-full transition-all duration-300",style:{width:`${s.paymentPercentage}%`}})}),e.jsxs("span",{className:"font-semibold text-lg",children:[s.paymentPercentage,"%"]})]})]})]})]}),e.jsxs("div",{className:"bg-white border-2 border-teal-200 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(O,{className:"h-6 w-6 text-teal-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"معلومات إضافية"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"عدد الأيام المتبقية"}),e.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[s.daysRemaining," يوم"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"عدد الأيام المنقضية"}),e.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[s.daysElapsed," يوم"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"القيمة اليومية"}),e.jsxs("p",{className:"text-xl font-semibold text-gray-900",children:[m(s.dailyValue)," ر.ع."]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"حالة التقدم"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-teal-600"}),e.jsxs("span",{className:"text-2xl font-semibold",children:[s.progressPercentage,"%"]})]})]})]})]}),e.jsxs("div",{className:"bg-white border-2 border-purple-200 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Q,{className:"h-6 w-6 text-purple-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"مراحل العقد"})]}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsxs("div",{className:"flex items-center gap-1 w-full justify-center flex-wrap",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`relative w-16 h-16 rounded-full border-2 flex items-center justify-center transition-all duration-300 ${s.stages.signed?"bg-gradient-to-r from-green-400 to-green-500 border-green-500 shadow-lg shadow-green-200":"bg-gray-100 border-gray-300"}`,children:s.stages.signed?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-check-circle w-8 h-8 text-white",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("path",{d:"m9 11 3 3L22 4"})]}):e.jsx("div",{className:"w-4 h-4 bg-gray-400 rounded-full"})}),e.jsx("span",{className:`text-sm mt-3 text-center font-medium transition-colors duration-200 max-w-[100px] leading-tight ${s.stages.signed?"text-green-600":"text-gray-500"}`,children:"توقيع العقد"})]}),e.jsx("div",{className:`h-2 w-16 mx-3 rounded-full transition-all duration-500 ${s.stages.signed?"bg-green-400":"bg-gray-200"}`})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`relative w-16 h-16 rounded-full border-2 flex items-center justify-center transition-all duration-300 ${s.stages.delivered?"bg-gradient-to-r from-green-400 to-green-500 border-green-500 shadow-lg shadow-green-200":"bg-gray-100 border-gray-300"}`,children:s.stages.delivered?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-check-circle w-8 h-8 text-white",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("path",{d:"m9 11 3 3L22 4"})]}):e.jsx("div",{className:"w-4 h-4 bg-gray-400 rounded-full"})}),e.jsx("span",{className:`text-sm mt-3 text-center font-medium transition-colors duration-200 max-w-[100px] leading-tight ${s.stages.delivered?"text-green-600":"text-gray-500"}`,children:"التسليم"})]}),e.jsx("div",{className:`h-2 w-16 mx-3 rounded-full transition-all duration-500 ${s.stages.delivered?"bg-green-400":"bg-gray-200"}`})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`relative w-16 h-16 rounded-full border-2 flex items-center justify-center transition-all duration-300 ${s.stages.inactive?"bg-gradient-to-r from-red-400 to-red-500 border-red-500 shadow-lg shadow-red-200":"bg-gray-100 border-gray-300"}`,children:s.stages.inactive?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-x-circle w-8 h-8 text-white",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"m15 9-6 6"}),e.jsx("path",{d:"m9 9 6 6"})]}):e.jsx("div",{className:"w-4 h-4 bg-gray-400 rounded-full"})}),e.jsx("span",{className:`text-sm mt-3 text-center font-medium transition-colors duration-200 max-w-[100px] leading-tight ${s.stages.inactive?"text-red-600":"text-gray-500"}`,children:"غير نشط"})]}),e.jsx("div",{className:`h-2 w-16 mx-3 rounded-full transition-all duration-500 ${s.stages.completed?"bg-green-400":"bg-gray-200"}`})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`relative w-16 h-16 rounded-full border-2 flex items-center justify-center transition-all duration-300 ${s.stages.completed?"bg-gradient-to-r from-green-400 to-green-500 border-green-500 shadow-lg shadow-green-200":"bg-gray-100 border-gray-300"}`,children:s.stages.completed?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-check-circle w-8 h-8 text-white",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("path",{d:"m9 11 3 3L22 4"})]}):e.jsx("div",{className:"w-4 h-4 bg-gray-400 rounded-full"})}),e.jsx("span",{className:`text-sm mt-3 text-center font-medium transition-colors duration-200 max-w-[100px] leading-tight ${s.stages.completed?"text-green-600":"text-gray-500"}`,children:"انتهاء العقد"})]})})]})}),e.jsx("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:e.jsxs("p",{className:"text-base text-gray-700",children:[e.jsx("span",{className:"font-semibold",children:"الحالة الحالية:"})," ",s.status]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5 text-[#58d2c8]"}),"المدفوعات"]}),e.jsxs(r,{onClick:()=>d.visit(`/payments/create?contract_id=${s.id}`),className:"bg-[#58d2c8] hover:bg-[#4AB8B3] text-white flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4"}),"تسديد دفعة جديدة"]})]}),s.payments&&s.payments.length>0?e.jsx("div",{className:"space-y-3",children:s.payments.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-[#58d2c8] transition-colors cursor-pointer",onClick:()=>d.visit(`/payments/${a.id}`),children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"p-2 bg-[#58d2c8]/10 rounded-lg",children:e.jsx(o,{className:"h-5 w-5 text-[#58d2c8]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:["#",a.id]}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",children:a.paymentMethod})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(N,{className:"h-4 w-4"}),e.jsx("span",{children:a.paymentDate})]}),a.checkNumber&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(n,{className:"h-4 w-4"}),e.jsxs("span",{children:["رقم الشيك: ",a.checkNumber]})]}),a.bankName&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Building2,{className:"h-4 w-4"}),e.jsx("span",{children:a.bankName})]})]})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:new Intl.NumberFormat("ar-SA",{style:"currency",currency:"OMR",minimumFractionDigits:2,maximumFractionDigits:2}).format(a.amount)}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:a.createdAt})]})]}),e.jsx("div",{className:"flex items-center gap-2 mr-4",children:e.jsx(r,{variant:"ghost",size:"icon",className:"p-2 hover:bg-[#58d2c8]/10",onClick:t=>{t.stopPropagation(),d.visit(`/payments/${a.id}`)},title:"عرض التفاصيل",children:e.jsx(y,{className:"h-5 w-5 text-[#58d2c8]"})})})]},a.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx(o,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{children:"لا توجد مدفوعات"}),e.jsx("p",{className:"text-sm mt-1",children:"قم بتسديد دفعة جديدة للبدء"})]})]}),e.jsxs("div",{className:"bg-white border-2 border-orange-200 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-6 w-6 text-orange-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"المرفقات والمستندات"})]}),e.jsxs(r,{onClick:()=>g(!f),className:"bg-orange-600 hover:bg-orange-700 text-white flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"رفع مرفق جديد"]})]}),f&&e.jsx("form",{onSubmit:A,className:"mb-6 p-4 bg-orange-50 rounded-lg border border-orange-200",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اختر الملف"}),e.jsx("input",{ref:w,type:"file",onChange:D,accept:".pdf,.doc,.docx,.zip,.rar,.jpg,.jpeg,.png,.gif",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"الحد الأقصى: 10MB"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الوصف (اختياري)"}),e.jsx(G,{type:"text",value:i.data.description,onChange:a=>i.setData("description",a.target.value),placeholder:"أدخل وصفاً للملف...",className:"w-full"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{type:"submit",disabled:h||!i.data.file,className:"bg-orange-600 hover:bg-orange-700 text-white",children:h?"جاري الرفع...":"رفع الملف"}),e.jsx(r,{type:"button",variant:"ghost",onClick:()=>{g(!1),i.reset()},disabled:h,children:"إلغاء"})]})]})}),e.jsx("div",{className:"space-y-3",children:s.attachments&&s.attachments.length>0?s.attachments.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-orange-50 rounded-lg border border-orange-200 hover:border-orange-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[F(a.file_type),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:a.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[a.file_type.toUpperCase()," • ",a.file_size_human]}),a.description&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:a.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{variant:"ghost",size:"icon",className:"p-2 hover:bg-orange-100",onClick:()=>S(a),title:"معاينة",children:e.jsx(y,{className:"h-5 w-5 text-orange-600"})}),e.jsx(r,{variant:"ghost",size:"icon",className:"p-2 hover:bg-orange-100",onClick:()=>B(a),title:"تحميل",children:e.jsx(Z,{className:"h-5 w-5 text-orange-600"})}),e.jsx(r,{variant:"ghost",size:"icon",className:"p-2 hover:bg-red-100",onClick:()=>C(a),title:"حذف",children:e.jsx(ee,{className:"h-5 w-5 text-red-600"})})]})]},a.id)):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(v,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{children:"لا توجد مرفقات"}),e.jsx("p",{className:"text-sm mt-1",children:"قم برفع مرفق جديد للبدء"})]})})]})]})})]})})}),e.jsx(q,{open:k,onOpenChange:j,onConfirm:$,title:"حذف المرفق",description:`هل أنت متأكد من حذف المرفق "${u?.name}"؟ لا يمكن التراجع عن هذا الإجراء.`,confirmText:"حذف",cancelText:"إلغاء",variant:"danger"})]})}export{be as default};
