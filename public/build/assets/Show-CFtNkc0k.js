import{a as w,j as e,H as L,r as b,b as M}from"./app-C4SmtXzs.js";import{D as B,B as k,U as O,C as D,P as V}from"./DashboardLayout-CMBsVX61.js";import{C as i,b as c,c as x,a as m}from"./card-CGBAZfCO.js";import{a as $,B as o}from"./button-CPi2Vosb.js";import{I as F}from"./input-qDfbrajX.js";import{D as R,b as U,a as z,c as H,d as G,e as X,f as Y}from"./dialog-CLOl0Txm.js";import{s as v}from"./use-toast-B9HC7Yw7.js";import{A as q}from"./arrow-left-vgf7Q5lf.js";import{U as C,F as n,D as u,C as E}from"./user-BFbh6T51.js";import{P as J}from"./printer-CpJdvQDs.js";import{D as K}from"./download-BeX5tWbj.js";import{S as Q}from"./square-pen-DlPyCUdH.js";import{S as W}from"./star-BrX2yoFz.js";import{T as P}from"./triangle-alert-BuVdEArW.js";import{E as _}from"./eye-pcZE0Q26.js";import{P as A}from"./phone-BNjyhZNU.js";import{M as Z}from"./mail-ZHQO5KUs.js";import{M as ee}from"./map-pin-BGfRqu9a.js";import{C as I}from"./circle-check-big-C6s4kiI1.js";import{C as se}from"./circle-x-YxrWUNqq.js";/* empty css            */const S=w.forwardRef(({className:s,...l},h)=>e.jsx("textarea",{className:$("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:h,...l}));S.displayName="Textarea";function we({customer:s}){const[l,h]=w.useState("overview"),j=a=>new Date(a).toLocaleDateString("ar-SA",{year:"numeric",month:"long",day:"numeric"}),g=a=>new Intl.NumberFormat("ar-SA",{style:"currency",currency:"OMR"}).format(a),p=a=>{switch(a){case"ACTIVE":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"INACTIVE":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"COMPLETED":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"PENDING":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},f=a=>{switch(a){case"ACTIVE":return e.jsx(I,{className:"h-4 w-4"});case"INACTIVE":return e.jsx(se,{className:"h-4 w-4"});case"COMPLETED":return e.jsx(I,{className:"h-4 w-4"});case"PENDING":return e.jsx(D,{className:"h-4 w-4"});default:return e.jsx(D,{className:"h-4 w-4"})}},t=s.contractsSummary||{total:s.contracts?.length||0,active:s.contracts?.filter(a=>a.status==="ACTIVE").length||0,completed:s.contracts?.filter(a=>a.status==="COMPLETED").length||0,cancelled:s.contracts?.filter(a=>a.status==="CANCELLED").length||0,totalValue:s.contracts?.reduce((a,r)=>a+(r.total_value||0),0)||0},d=s.paymentsSummary||{total:s.payments?.length||0,paid:s.payments?.filter(a=>a.status==="PAID").length||0,pending:s.payments?.filter(a=>a.status==="PENDING").length||0,overdue:s.payments?.filter(a=>a.status==="OVERDUE").length||0,totalAmount:s.payments?.reduce((a,r)=>a+(r.amount||0),0)||0},y=()=>{window.print()},N=()=>{alert("سيتم تصدير ملف العميل")};return e.jsxs(B,{children:[e.jsx(L,{title:`${s.name} - تفاصيل العميل`}),e.jsxs("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>b.visit("/customers"),children:e.jsx(q,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[s.customer_type==="COMPANY"?e.jsx(k,{className:"h-6 w-6"}):e.jsx(C,{className:"h-6 w-6"}),s.name]}),e.jsxs("p",{className:"text-muted-foreground",children:["رقم العميل: ",s.customer_number]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:y,children:[e.jsx(J,{className:"h-4 w-4"}),"طباعة"]}),e.jsxs(o,{variant:"outline",size:"sm",onClick:N,children:[e.jsx(K,{className:"h-4 w-4"}),"تصدير"]}),e.jsxs(o,{onClick:()=>b.visit(`/customers/${s.id}/edit`),children:[e.jsx(Q,{className:"h-4 w-4"}),"تعديل"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium flex items-center gap-2 ${p(s.status)}`,children:[f(s.status),s.status==="ACTIVE"?"نشط":"غير نشط"]}),s.rating&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"h-4 w-4 text-yellow-500 fill-current"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.rating,"/5"]})]}),s.warnings&&e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"تحذيرات"})]})]}),e.jsx("div",{className:"border-b",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"overview",label:"نظرة عامة",icon:_},{id:"contracts",label:"العقود",icon:n},{id:"payments",label:"المدفوعات",icon:u},{id:"notes",label:"الملاحظات",icon:n}].map(a=>{const r=a.icon;return e.jsxs("button",{onClick:()=>h(a.id),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${l===a.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[e.jsx(r,{className:"h-4 w-4"}),a.label]},a.id)})})}),l==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5"}),"المعلومات الأساسية"]})}),e.jsx(m,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"الاسم الكامل"}),e.jsx("p",{className:"text-sm",children:s.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"نوع العميل"}),e.jsx("p",{className:"text-sm",children:s.customer_type==="COMPANY"?"شركة":"فرد"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"رقم الهوية/السجل"}),e.jsx("p",{className:"text-sm font-mono",children:s.id_number||s.commercial_record||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"الجنسية"}),e.jsx("p",{className:"text-sm",children:s.nationality||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"رقم الهاتف الرئيسي"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm",children:s.phone||"-"})]})]}),s.phones&&s.phones.length>0&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"أرقام الهواتف الإضافية"}),e.jsx("div",{className:"space-y-2",children:s.phones.map((a,r)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx(A,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:a.number}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",a.type==="MOBILE"?"جوال":a.type==="LANDLINE"?"أرضي":"واتساب",")"]}),a.label&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["- ",a.label]}),a.isPrimary&&e.jsx("span",{className:"text-xs bg-primary text-white px-2 py-0.5 rounded-full",children:"رئيسي"})]},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"البريد الإلكتروني"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm",children:s.email||"-"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"العنوان"}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ee,{className:"h-4 w-4 mt-0.5"}),e.jsx("p",{className:"text-sm",children:s.address||"-"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"تاريخ التسجيل"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm",children:j(s.registration_date)})]})]})]})})]}),(s.guarantorData||s.guarantor_name||s.guarantor_phone||s.guarantor_id)&&e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5"}),"معلومات الضامن"]})}),e.jsx(m,{className:"space-y-4",children:s.guarantorData?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"اسم الضامن"}),e.jsx("p",{className:"text-sm",children:s.guarantorData.name||s.guarantor_name||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"هاتف الضامن"}),e.jsx("p",{className:"text-sm",children:s.guarantorData.phone||s.guarantor_phone||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"رقم هوية الضامن"}),e.jsx("p",{className:"text-sm font-mono",children:s.guarantorData.idNumber||s.guarantor_id||"-"})]}),s.guarantorData.nationality&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"جنسية الضامن"}),e.jsx("p",{className:"text-sm",children:s.guarantorData.nationality})]}),s.guarantorData.relationship&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"صلة القرابة"}),e.jsx("p",{className:"text-sm",children:s.guarantorData.relationship})]}),s.guarantorData.workPlace&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"مكان العمل"}),e.jsx("p",{className:"text-sm",children:s.guarantorData.workPlace})]}),s.guarantorData.workPhone&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"هاتف العمل"}),e.jsx("p",{className:"text-sm",children:s.guarantorData.workPhone})]}),s.guarantorData.address&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"عنوان الضامن"}),e.jsx("p",{className:"text-sm",children:s.guarantorData.address})]})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"اسم الضامن"}),e.jsx("p",{className:"text-sm",children:s.guarantor_name||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"هاتف الضامن"}),e.jsx("p",{className:"text-sm",children:s.guarantor_phone||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"رقم هوية الضامن"}),e.jsx("p",{className:"text-sm font-mono",children:s.guarantor_id||"-"})]})]})})]}),(s.notes||s.warnings)&&e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5"}),"الملاحظات والتحذيرات"]})}),e.jsxs(m,{className:"space-y-4",children:[s.notes&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"ملاحظات عامة"}),e.jsx("p",{className:"text-sm mt-1 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:s.notes})]}),s.warnings&&e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4 text-red-500"}),"تحذيرات خاصة"]}),e.jsx("p",{className:"text-sm mt-1 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-800 dark:text-red-200",children:s.warnings})]})]})]})]}),e.jsxs("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5"}),"ملخص العقود"]})}),e.jsxs(m,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"إجمالي العقود"}),e.jsx("span",{className:"font-medium",children:t.total})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"عقود نشطة"}),e.jsx("span",{className:"font-medium text-green-600",children:t.active})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"عقود مكتملة"}),e.jsx("span",{className:"font-medium text-blue-600",children:t.completed})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"عقود ملغاة"}),e.jsx("span",{className:"font-medium text-red-600",children:t.cancelled})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"إجمالي القيمة"}),e.jsx("span",{className:"font-bold text-primary",children:g(t.totalValue)})]})})]})]}),e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5"}),"ملخص المدفوعات"]})}),e.jsxs(m,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"إجمالي المدفوعات"}),e.jsx("span",{className:"font-medium",children:d.total})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"مدفوعات مكتملة"}),e.jsx("span",{className:"font-medium text-green-600",children:d.paid})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"مدفوعات معلقة"}),e.jsx("span",{className:"font-medium text-yellow-600",children:d.pending})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"مدفوعات متأخرة"}),e.jsx("span",{className:"font-medium text-red-600",children:d.overdue})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"إجمالي المبلغ"}),e.jsx("span",{className:"font-bold text-primary",children:g(d.totalAmount)})]})})]})]})]})]}),l==="contracts"&&e.jsx("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5"}),"قائمة العقود"]})}),e.jsx(m,{children:s.contracts&&s.contracts.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-muted-foreground",children:"رقم العقد"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-muted-foreground",children:"نوع العقد"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-muted-foreground",children:"الحالة"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-muted-foreground",children:"تاريخ البدء"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-muted-foreground",children:"تاريخ الانتهاء"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-muted-foreground",children:"القيمة الإجمالية"})]})}),e.jsx("tbody",{children:s.contracts.map(a=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:a.contract_number||a.id})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.contract_type||"-"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${p(a.status)}`,children:a.status==="ACTIVE"?"نشط":a.status==="EXPIRED"?"منتهي":a.status==="CANCELLED"?"ملغي":"معلق"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.start_date?j(a.start_date):"-"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.end_date?j(a.end_date):"-"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:g(a.total_value??a.amount??0)})})]},a.id))})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(n,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"لا توجد عقود لهذا العميل"})]})})]})}),l==="payments"&&e.jsx("div",{className:"space-y-6",children:e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5 text-[#58d2c8]"}),"مدفوعات العميل"]})}),e.jsx(m,{children:s.contractPayments&&s.contractPayments.length>0?e.jsx("div",{className:"space-y-3",children:s.contractPayments.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-[#58d2c8] transition-colors cursor-pointer",onClick:()=>b.visit(`/payments/${a.id}`),children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"p-2 bg-[#58d2c8]/10 rounded-lg",children:e.jsx(u,{className:"h-5 w-5 text-[#58d2c8]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:["#",a.id]}),e.jsx("span",{className:"px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",children:a.paymentMethod})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(n,{className:"h-4 w-4"}),e.jsx("span",{children:a.contractNumber})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx("span",{children:a.paymentDate})]}),a.checkNumber&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(n,{className:"h-4 w-4"}),e.jsxs("span",{children:["رقم الشيك: ",a.checkNumber]})]}),a.bankName&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:a.bankName})]})]})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:g(a.amount)}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:a.createdAt})]})]}),e.jsx("div",{className:"flex items-center gap-2 mr-4",children:e.jsx(o,{variant:"ghost",size:"icon",className:"p-2 hover:bg-[#58d2c8]/10",onClick:r=>{r.stopPropagation(),b.visit(`/payments/${a.id}`)},title:"عرض التفاصيل",children:e.jsx(_,{className:"h-5 w-5 text-[#58d2c8]"})})})]},a.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx(u,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{children:"لا توجد مدفوعات لهذا العميل"})]})})]})}),l==="notes"&&e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{children:"ملاحظات العميل"}),e.jsx(T,{customerId:s.id})]})}),e.jsx(m,{children:s.customerNotes&&s.customerNotes.length>0?e.jsx("div",{className:"space-y-4",children:s.customerNotes.map(a=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:a.title||"ملاحظة"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:a.created_at?j(a.created_at):"-"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.content||a.note||"-"})]},a.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(n,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"لا توجد ملاحظات لهذا العميل"}),e.jsx(T,{customerId:s.id})]})})]})]})]})}function T({customerId:s}){const[l,h]=w.useState(!1),{data:j,setData:g,post:p,processing:f,errors:t,reset:d}=M({title:"",content:""}),y=N=>{N.preventDefault(),p(`/customers/${s}/notes`,{onSuccess:()=>{v.success("نجح","تم إضافة الملاحظة بنجاح"),d(),h(!1)},onError:a=>{a.title&&v.error("خطأ",a.title),a.content&&v.error("خطأ",a.content)}})};return e.jsxs(R,{open:l,onOpenChange:h,children:[e.jsx(U,{asChild:!0,children:e.jsxs(o,{className:"bg-[#58d2c8] hover:bg-[#4AB8B3] text-white flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),"إضافة ملاحظة"]})}),e.jsxs(z,{className:"sm:max-w-[500px]",children:[e.jsxs(H,{children:[e.jsx(G,{children:"إضافة ملاحظة جديدة"}),e.jsx(X,{children:"أضف ملاحظة جديدة للعميل"})]}),e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"title",className:"text-sm font-medium",children:"العنوان"}),e.jsx(F,{id:"title",value:j.title,onChange:N=>g("title",N.target.value),placeholder:"عنوان الملاحظة",className:t.title?"border-red-500":""}),t.title&&e.jsx("p",{className:"text-sm text-red-500",children:t.title})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"content",className:"text-sm font-medium",children:"المحتوى"}),e.jsx(S,{id:"content",value:j.content,onChange:N=>g("content",N.target.value),placeholder:"محتوى الملاحظة",rows:5,className:t.content?"border-red-500":""}),t.content&&e.jsx("p",{className:"text-sm text-red-500",children:t.content})]})]}),e.jsxs(Y,{children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>{h(!1),d()},children:"إلغاء"}),e.jsx(o,{type:"submit",disabled:f,className:"bg-[#58d2c8] hover:bg-[#4AB8B3] text-white",children:f?"جاري الحفظ...":"حفظ"})]})]})]})]})}export{we as default};
