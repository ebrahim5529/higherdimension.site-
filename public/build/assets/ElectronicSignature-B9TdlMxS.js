import{u as N,r as o,b as _,j as e,H as v}from"./app-DC70pVjm.js";import{D as y}from"./DashboardLayout-hjp-9ivh.js";import{C as k,b as C,c as w,a as S}from"./card-DdBhtchT.js";import{B as g}from"./button-CCsAHJj1.js";import{I as d}from"./input-DMs8wDeE.js";import{s as u}from"./use-toast-weOckxar.js";import{D}from"./DigitalSignature-DRB3XMCE.js";/* empty css            */import"./createLucideIcon-gXsaNq4V.js";import"./triangle-alert-Dwooo7My.js";import"./file-text-j4Qn0fru.js";import"./eye-DDqfhxOU.js";import"./shield-5CH0y752.js";import"./circle-alert-CnKodfJj.js";import"./map-pin-BBAWf8o9.js";import"./mail-BERZcaE2.js";import"./download-BLwmAVtj.js";import"./trash-2-C7a61DKz.js";function K({signature:l}){const{flash:n}=N().props,[t,m]=o.useState(l?.signature_url??null),{data:c,setData:r,post:p,processing:i,errors:a,reset:h}=_({company_name:l?.company_name??"",signer_name:l?.signer_name??"",signer_title:l?.signer_title??"",signature_file:null,signature:""});o.useEffect(()=>{n?.success&&u.success("نجح",n.success),n?.error&&u.error("خطأ",n.error)},[n]),o.useEffect(()=>()=>{t&&t.startsWith("blob:")&&URL.revokeObjectURL(t)},[t]);const j=o.useMemo(()=>!!c.signature,[c.signature]),x=s=>{r("signature_file",s),r("signature",""),t&&t.startsWith("blob:")&&URL.revokeObjectURL(t),m(s?URL.createObjectURL(s):l?.signature_url??null)},b=s=>{r("signature",s),r("signature_file",null),t&&t.startsWith("blob:")&&URL.revokeObjectURL(t),m(s)},f=s=>{s.preventDefault(),p("/dashboard/electronic-signature",{forceFormData:!0,onSuccess:()=>{h("signature_file")}})};return e.jsxs(y,{children:[e.jsx(v,{title:"التوقيع الإلكتروني"}),e.jsxs("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"التوقيع الإلكتروني"})}),e.jsxs(k,{children:[e.jsx(C,{children:e.jsx(w,{className:"text-xl",children:"إعدادات توقيع الشركة"})}),e.jsx(S,{children:e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"اسم الشركة"}),e.jsx(d,{value:c.company_name,onChange:s=>r("company_name",s.target.value),disabled:i}),a.company_name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.company_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"اسم الموقّع"}),e.jsx(d,{value:c.signer_name,onChange:s=>r("signer_name",s.target.value),disabled:i}),a.signer_name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.signer_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"منصب الموقّع"}),e.jsx(d,{value:c.signer_title,onChange:s=>r("signer_title",s.target.value),disabled:i}),a.signer_title&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.signer_title})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium",children:"رفع صورة التوقيع"}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/jpg",onChange:s=>x(s.target.files?.[0]??null),disabled:i,className:"block w-full text-sm text-gray-700 dark:text-gray-200"}),a.signature_file&&e.jsx("p",{className:"text-red-500 text-xs",children:a.signature_file}),e.jsx(g,{type:"button",variant:"outline",onClick:()=>x(null),disabled:i,children:"إزالة الملف"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium",children:"أو ارسم التوقيع"}),e.jsx("div",{className:"border rounded-lg p-3 bg-white dark:bg-gray-900",children:e.jsx(D,{onSignatureComplete:b,onSignatureClear:()=>{r("signature",""),m(l?.signature_url??null)},width:420,height:160,strokeColor:"#000000",strokeWidth:2})}),a.signature&&e.jsx("p",{className:"text-red-500 text-xs",children:a.signature}),j&&e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"تم التقاط توقيع مرسوم وسيتم حفظه."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"معاينة التوقيع"}),e.jsx("div",{className:"border rounded-lg p-3 bg-white dark:bg-gray-900 min-h-[120px] flex items-center justify-center",children:t?e.jsx("img",{src:t,alt:"معاينة التوقيع",className:"max-h-[140px] max-w-full object-contain"}):e.jsx("span",{className:"text-sm text-gray-500",children:"لا يوجد توقيع حالياً"})})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(g,{type:"submit",className:"bg-[#58d2c8] hover:bg-[#4AB8B3]",disabled:i,children:i?"جاري الحفظ...":"حفظ"})})]})})]})]})]})}export{K as default};
