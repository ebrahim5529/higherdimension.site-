import{a as c,j as e,H as f,r as y}from"./app-CONDmo9A.js";import{D as v,S as C,U as w,c as m}from"./DashboardLayout-BPsSLmbd.js";import{C as h,b as o,c as k,a as j}from"./card-Cxh3cW5F.js";import{B as E}from"./button-B6dOx6gm.js";import{I as L}from"./input-B65q9l4a.js";import{T,a as D,b as g,c as t,d as S,e as r}from"./table-BujgOMvA.js";import{H}from"./hash-Cd2ZaRu_.js";import{P as I}from"./phone-CqiMiX5T.js";import{M as P}from"./mail-DiqatmSx.js";import{F as u}from"./file-text-n36sxuUg.js";import{E as A}from"./eye-CoNGtWIh.js";/* empty css            */import"./createLucideIcon-DGnkID90.js";import"./triangle-alert-BtrJKYoD.js";import"./map-pin-mbm9Cvun.js";function Q({customers:n}){const[l,b]=c.useState(""),i=c.useMemo(()=>l?n.filter(s=>s.name.toLowerCase().includes(l.toLowerCase())||s.customerNumber.toLowerCase().includes(l.toLowerCase())||s.phone?.toLowerCase().includes(l.toLowerCase())||s.email?.toLowerCase().includes(l.toLowerCase())):n,[n,l]),d=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"OMR"}).format(s),x=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),N=s=>{switch(s){case"ACTIVE":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"COMPLETED":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"CANCELLED":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"EXPIRED":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},p=s=>{switch(s){case"ACTIVE":return"نشط";case"COMPLETED":return"مكتمل";case"CANCELLED":return"ملغي";case"EXPIRED":return"منتهي";default:return s}};return e.jsxs(v,{children:[e.jsx(f,{title:"سجل العقود الخاصة بالعملاء"}),e.jsxs("div",{className:"space-y-6 pb-8 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"سجل العقود الخاصة بالعملاء"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"عرض جميع العملاء مع عدد العقود الخاصة بكل عميل"})]})}),e.jsxs(h,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{children:"العملاء والعقود"}),e.jsxs("div",{className:"relative w-64",children:[e.jsx(C,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500"}),e.jsx(L,{placeholder:"ابحث عن عميل...",value:l,onChange:s=>b(s.target.value),className:"pl-9"})]})]})}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-6",children:[i.map(s=>e.jsxs(h,{className:"border-2",children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:e.jsx(w,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:s.name}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{children:s.customerNumber})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:s.phone})]}),s.email&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx("span",{children:s.email})]})]})]})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:s.contractsCount}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["عقد ",s.activeContractsCount>0&&`(${s.activeContractsCount} نشط)`]})]})]})}),e.jsxs(j,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"إجمالي قيمة العقود"}),e.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:d(s.totalContractsValue)})]}),e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"المبلغ المدفوع"}),e.jsx("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:d(s.totalPaid)})]}),e.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"المبلغ المتبقي"}),e.jsx("div",{className:"text-lg font-bold text-red-600 dark:text-red-400",children:d(s.totalRemaining)})]})]}),s.contracts.length>0&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(T,{children:[e.jsx(D,{children:e.jsxs(g,{children:[e.jsx(t,{children:"رقم العقد"}),e.jsx(t,{children:"عنوان العقد"}),e.jsx(t,{children:"الحالة"}),e.jsx(t,{children:"المبلغ الإجمالي"}),e.jsx(t,{children:"المدفوع"}),e.jsx(t,{children:"المتبقي"}),e.jsx(t,{children:"تاريخ البدء"}),e.jsx(t,{children:"تاريخ الانتهاء"}),e.jsx(t,{className:"text-right",children:"الإجراءات"})]})}),e.jsx(S,{children:s.contracts.map(a=>e.jsxs(g,{children:[e.jsx(r,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-4 w-4 text-gray-500"}),a.contractNumber]})}),e.jsx(r,{children:a.title}),e.jsx(r,{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${N(a.status)}`,children:p(a.status)})}),e.jsx(r,{children:e.jsx("span",{className:"font-semibold",children:d(a.amount)})}),e.jsx(r,{children:e.jsx("span",{className:"font-semibold text-green-600",children:d(a.paidAmount)})}),e.jsx(r,{children:e.jsx("span",{className:"font-semibold text-red-600",children:d(a.remainingAmount)})}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(m,{className:"h-4 w-4 text-gray-500"}),x(a.startDate)]})}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(m,{className:"h-4 w-4 text-gray-500"}),a.endDate?x(a.endDate):"-"]})}),e.jsx(r,{className:"text-right",children:e.jsx(E,{variant:"outline",size:"sm",onClick:()=>y.visit(`/contracts/${a.id}`),children:e.jsx(A,{className:"h-4 w-4"})})})]},a.id))})]})})]})]},s.id)),i.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(u,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:l?"لا توجد نتائج للبحث":"لا توجد عملاء"})]})]})})]})]})]})}export{Q as default};
