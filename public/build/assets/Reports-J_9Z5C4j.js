import{u as H,a as p,j as e,H as L,r as i}from"./app-CgSVc5Wn.js";import{D as P,f as v,T as B,C as j}from"./DashboardLayout-BIO_sjjx.js";import{C as n,b as g,c as u,a as x}from"./card-Dywtg_PO.js";import{B as w}from"./button-BGcazaoI.js";import{I as C}from"./input-CkIX0MbD.js";import{s as N}from"./use-toast-DoooC-Gp.js";import{C as D}from"./combobox-pUWr8itd.js";import{F as R,C as k}from"./user-GZG2W0xx.js";import{D as $}from"./download-BmoDfSjl.js";import{C as A}from"./circle-check-big-CZPbl506.js";import{C as M}from"./circle-x-BvYG1huA.js";/* empty css            */import"./eye-Cjz6YKgE.js";import"./dialog-ptjPhv06.js";import"./index-CBa_YVis.js";import"./check-Bj4NjL_D.js";const V={present:"حاضر",absent:"غائب",late:"متأخر",half_day:"نصف يوم",on_leave:"في إجازة"},Y={present:"bg-green-100 text-green-800",absent:"bg-red-100 text-red-800",late:"bg-yellow-100 text-yellow-800",half_day:"bg-blue-100 text-blue-800",on_leave:"bg-purple-100 text-purple-800"};function xe({attendances:b,employees:F,employeeStats:l,filters:_}){const{flash:c}=H().props,[a,d]=p.useState(_),[U,r]=p.useState(!1);p.useEffect(()=>{c?.success&&N.success("نجح",c.success),c?.error&&N.error("خطأ",c.error)},[c]);const S=s=>{const t=new Date;let m="",o="";switch(s){case"daily":m=t.toISOString().split("T")[0],o=t.toISOString().split("T")[0];break;case"weekly":const h=new Date(t);h.setDate(t.getDate()-t.getDay());const y=new Date(h);y.setDate(h.getDate()+6),m=h.toISOString().split("T")[0],o=y.toISOString().split("T")[0];break;case"monthly":default:const O=new Date(t.getFullYear(),t.getMonth(),1),E=new Date(t.getFullYear(),t.getMonth()+1,0);m=O.toISOString().split("T")[0],o=E.toISOString().split("T")[0];break}const f={...a,period:s,start_date:m,end_date:o};d(f),r(!0),i.get("/employees/attendance/reports",f,{preserveState:!0,preserveScroll:!0,onFinish:()=>r(!1)})},T=s=>new Date(s).toLocaleDateString("ar-SA",{year:"numeric",month:"long",day:"numeric"}),I=()=>{N.success("نجح","سيتم تصدير التقرير قريباً")};return e.jsxs(P,{children:[e.jsx(L,{title:"تقارير الحضور والانصراف"}),e.jsxs("div",{className:"space-y-6 mt-2 -mx-1 sm:-mx-2 lg:-mx-3 xl:-mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"تقارير الحضور والانصراف"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(w,{variant:"outline",onClick:I,children:[e.jsx($,{className:"h-4 w-4"}),"تصدير التقرير"]}),e.jsx(w,{variant:"outline",onClick:()=>i.visit("/employees/attendance"),children:"العودة"})]})]}),e.jsxs(n,{children:[e.jsx(g,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-5 w-5"}),"الفلاتر"]})}),e.jsx(x,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"الموظف"}),e.jsx(D,{options:[{value:"",label:"جميع الموظفين"},...F.map(s=>({value:s.id.toString(),label:`${s.name} (${s.employee_number})`}))],value:a.employee_id||"",onValueChange:s=>{const t={...a,employee_id:s||null};d(t),r(!0),i.get("/employees/attendance/reports",t,{preserveState:!0,preserveScroll:!0,onFinish:()=>r(!1)})},placeholder:"اختر الموظف",searchPlaceholder:"ابحث عن الموظف...",emptyText:"لا يوجد موظفين"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"الفترة"}),e.jsx(D,{options:[{value:"daily",label:"يومي"},{value:"weekly",label:"أسبوعي"},{value:"monthly",label:"شهري"}],value:a.period,onValueChange:s=>S(s),placeholder:"اختر الفترة",searchPlaceholder:"ابحث...",emptyText:"لا توجد نتائج"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"تاريخ البدء"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(C,{type:"date",value:a.start_date,onChange:s=>{const t={...a,start_date:s.target.value};d(t),r(!0),i.get("/employees/attendance/reports",t,{preserveState:!0,preserveScroll:!0,onFinish:()=>r(!1)})},className:"pr-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"تاريخ الانتهاء"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(C,{type:"date",value:a.end_date,onChange:s=>{const t={...a,end_date:s.target.value};d(t),r(!0),i.get("/employees/attendance/reports",t,{preserveState:!0,preserveScroll:!0,onFinish:()=>r(!1)})},className:"pr-10"})]})]})]})})]}),l.employeeName&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(n,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"معدل الحضور"}),e.jsxs("p",{className:"text-2xl font-bold text-[#913D95]",children:[l.attendanceRate?.toFixed(1)||0,"%"]})]}),e.jsx(B,{className:"h-8 w-8 text-[#913D95]"})]})})}),e.jsx(n,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"حاضر"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:l.presentCount||0})]}),e.jsx(A,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(n,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"غائب"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:l.absentCount||0})]}),e.jsx(M,{className:"h-8 w-8 text-red-600"})]})})}),e.jsx(n,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"إجمالي الساعات"}),e.jsx("p",{className:"text-2xl font-bold text-[#913D95]",children:l.totalHours||0})]}),e.jsx(j,{className:"h-8 w-8 text-[#913D95]"})]})})})]}),l.employeeName&&e.jsxs(n,{children:[e.jsx(g,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-5 w-5"}),"إحصائيات تفصيلية - ",l.employeeName]})}),e.jsx(x,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"إجمالي الأيام"}),e.jsx("p",{className:"text-xl font-bold",children:l.totalDays||0})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"حاضر"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:l.presentCount||0})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"غائب"}),e.jsx("p",{className:"text-xl font-bold text-red-600",children:l.absentCount||0})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"متأخر"}),e.jsx("p",{className:"text-xl font-bold text-yellow-600",children:l.lateCount||0})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"نصف يوم"}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:l.halfDayCount||0})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"في إجازة"}),e.jsx("p",{className:"text-xl font-bold text-purple-600",children:l.onLeaveCount||0})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"إجمالي الساعات"}),e.jsxs("p",{className:"text-xl font-bold",children:[l.totalHours||0," ساعة"]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"ساعات إضافية"}),e.jsxs("p",{className:"text-xl font-bold text-green-600",children:[l.totalOvertime||0," ساعة"]})]})]})})]}),e.jsxs(n,{children:[e.jsx(g,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-5 w-5"}),"تفاصيل الحضور والانصراف"]})}),e.jsx(x,{children:b.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-900",children:"التاريخ"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-900",children:"الموظف"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-900",children:"وقت الدخول"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-900",children:"وقت الخروج"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-900",children:"إجمالي الساعات"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-900",children:"ساعات إضافية"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-900",children:"الحالة"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:b.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:T(s.date)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.employeeName}),e.jsx("div",{className:"text-xs text-gray-500",children:s.employeeId})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.checkIn||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.checkOut||"-"}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[s.totalHours||0," ساعة"]}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[s.overtime||0," ساعة"]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Y[s.status]}`,children:V[s.status]})})]},s.id))})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(j,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"لا توجد سجلات حضور في الفترة المحددة"})]})})]})]})]})}export{xe as default};
