import{r as s,u as f,j as e,H as p,a as l}from"./app-84_vxQdS.js";import{B as d}from"./button-BjYYNMND.js";import{I as j}from"./input-Cl715XOF.js";import{C as y,a as N,b as k,c as v,d as w}from"./card-eaxFl7Bs.js";import{s as o}from"./use-toast-CojTFCbM.js";import{A as C}from"./arrow-left-EPoubND8.js";import{S as M}from"./shield-CpYDa7Ju.js";import{M as S}from"./mail-Ti8-EjQn.js";import{c as E}from"./createLucideIcon-BXz5zsdN.js";/* empty css            */const F=E("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function _({email:c,flash:r}){const[n,i]=s.useState(""),[x,u]=s.useState(!1),a=f({code:""});s.useEffect(()=>{u(!0)},[]),s.useEffect(()=>{r?.success&&o.success("نجح",r.success),r?.error&&o.error("خطأ",r.error)},[r]),s.useEffect(()=>{const t=window.location.pathname;if(t!=="/two-factor/challenge"){console.log("TwoFactorChallenge: Path mismatch",{currentPath:t,expected:"/two-factor/challenge"});return}console.log("TwoFactorChallenge: Component mounted and visible",{email:c})},[c]);const h=t=>{t.preventDefault(),a.post("/two-factor/challenge",{preserveScroll:!0,onSuccess:()=>{l.visit("/dashboard")},onError:()=>{i("")}})},g=()=>{l.post("/two-factor/resend",{},{onSuccess:()=>{o.success("نجح","تم إرسال رمز التحقق إلى بريدك الإلكتروني")},onError:()=>{o.error("خطأ","فشل إرسال الرمز. يرجى المحاولة مرة أخرى")}})},b=()=>{l.visit("/login",{onBefore:()=>{}})};return x?e.jsxs(e.Fragment,{children:[e.jsx(p,{title:"التحقق من المصادقة الثنائية"}),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(d,{type:"button",variant:"ghost",onClick:b,className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:[e.jsx(C,{className:"h-4 w-4 ml-2"}),"الرجوع إلى تسجيل الدخول"]})}),e.jsxs(y,{className:"shadow-xl border-0 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm",children:[e.jsxs(N,{className:"space-y-1 text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mb-4",children:e.jsx(M,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"})}),e.jsx(k,{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"التحقق من المصادقة الثنائية"}),e.jsx(v,{className:"text-gray-600 dark:text-gray-400",children:"تم إرسال رمز التحقق إلى بريدك الإلكتروني"})]}),e.jsx(w,{children:e.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx(S,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"البريد الإلكتروني"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:c})]})]}),e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 text-center",children:"يرجى فتح بريدك الإلكتروني وإدخال رمز التحقق المكون من 6 أرقام"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"code",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"رمز التحقق (6 أرقام)"}),e.jsx(j,{id:"code",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:6,placeholder:"000000",value:n,onChange:t=>{const m=t.target.value.replace(/\D/g,"").slice(0,6);i(m),a.setData("code",m)},className:"text-center text-2xl font-mono tracking-widest bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600",required:!0,autoFocus:!0}),a.errors.code&&e.jsx("p",{className:"text-sm text-red-500",children:a.errors.code})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs(d,{type:"button",variant:"ghost",onClick:g,className:"text-sm",children:[e.jsx(F,{className:"h-4 w-4 ml-2"}),"إعادة إرسال الرمز"]})}),e.jsx(d,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white",disabled:n.length!==6,children:"تحقق"})]})})]})]})})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"جاري التحميل..."})]})})}export{_ as default};
