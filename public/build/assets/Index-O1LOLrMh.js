import{r as p,j as e,H as w,a as h}from"./app-DC70pVjm.js";import{D as k,q as C,P as S,i as _,d as D,e as P}from"./DashboardLayout-hjp-9ivh.js";import{C as l,a as d,b as I,c as L}from"./card-DdBhtchT.js";import{B as i}from"./button-CCsAHJj1.js";import{I as n}from"./input-DMs8wDeE.js";import{L as r}from"./label-vs7EW7ob.js";import{s as u}from"./use-toast-weOckxar.js";import{C as T}from"./circle-check-big-Cvk465Yi.js";import{P as q}from"./pen-ClsSBSbJ.js";import{T as E}from"./trash-2-C7a61DKz.js";/* empty css            */import"./createLucideIcon-gXsaNq4V.js";import"./triangle-alert-Dwooo7My.js";import"./file-text-j4Qn0fru.js";import"./eye-DDqfhxOU.js";import"./shield-5CH0y752.js";import"./circle-alert-CnKodfJj.js";import"./map-pin-BBAWf8o9.js";import"./mail-BERZcaE2.js";const F={pending:"قيد الانتظار",completed:"مكتمل",cancelled:"ملغي"},B={pending:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",completed:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",cancelled:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"};function te({purchases:j,stats:c,suppliers:N}){const[g,m]=p.useState(!1),[o,y]=p.useState(null),[t,a]=p.useState({title:"",description:"",amount:"",purchase_date:new Date().toISOString().split("T")[0],status:"completed",supplier_id:"",payment_method:"cash",notes:""}),x=()=>{a({title:"",description:"",amount:"",purchase_date:new Date().toISOString().split("T")[0],status:"completed",supplier_id:"",payment_method:"cash",notes:""}),y(null),m(!1)},v=s=>{s.preventDefault(),o?h.put(`/purchases/${o}`,t,{preserveScroll:!0,onSuccess:()=>{u.success("تم تحديث المشتريات بنجاح"),x()}}):h.post("/purchases",t,{preserveScroll:!0,onSuccess:()=>{u.success("تم تسجيل المشتريات بنجاح"),x()}})},f=s=>{a({title:s.title,description:s.description||"",amount:String(s.amount),purchase_date:s.purchaseDate,status:s.status,supplier_id:String(s.supplierId),payment_method:"cash",notes:s.notes||""}),y(s.id),m(!0)},b=s=>{confirm("هل أنت متأكد من حذف هذه المشتريات؟")&&h.delete(`/purchases/${s}`,{preserveScroll:!0,onSuccess:()=>u.success("تم حذف المشتريات بنجاح")})};return e.jsxs(k,{children:[e.jsx(w,{title:"المشتريات"}),e.jsxs("div",{className:"p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900 rounded-lg",children:e.jsx(C,{className:"h-6 w-6 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"المشتريات"}),e.jsx("p",{className:"text-sm text-gray-500",children:"إدارة المشتريات من الموردين"})]})]}),e.jsxs(i,{onClick:()=>{x(),m(!g)},className:"gap-2",children:[e.jsx(S,{className:"h-4 w-4"}),"تسجيل مشتريات جديدة"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(l,{children:e.jsxs(d,{className:"p-4 flex items-center gap-3",children:[e.jsx(_,{className:"h-8 w-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"إجمالي المشتريات"}),e.jsx("p",{className:"text-xl font-bold",children:c.totalPurchases})]})]})}),e.jsx(l,{children:e.jsxs(d,{className:"p-4 flex items-center gap-3",children:[e.jsx(D,{className:"h-8 w-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"إجمالي المبالغ"}),e.jsxs("p",{className:"text-xl font-bold",children:[c.totalAmount.toLocaleString()," ر.ع"]})]})]})}),e.jsx(l,{children:e.jsxs(d,{className:"p-4 flex items-center gap-3",children:[e.jsx(P,{className:"h-8 w-8 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"قيد الانتظار"}),e.jsx("p",{className:"text-xl font-bold",children:c.pendingPurchases})]})]})}),e.jsx(l,{children:e.jsxs(d,{className:"p-4 flex items-center gap-3",children:[e.jsx(T,{className:"h-8 w-8 text-emerald-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"مكتملة"}),e.jsx("p",{className:"text-xl font-bold",children:c.completedPurchases})]})]})})]}),g&&e.jsxs(l,{children:[e.jsx(I,{children:e.jsx(L,{children:o?"تعديل المشتريات":"تسجيل مشتريات جديدة"})}),e.jsx(d,{children:e.jsxs("form",{onSubmit:v,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"العنوان *"}),e.jsx(n,{value:t.title,onChange:s=>a({...t,title:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"المورد *"}),e.jsxs("select",{value:t.supplier_id,onChange:s=>a({...t,supplier_id:s.target.value}),className:"w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-3 py-2 text-sm",required:!0,children:[e.jsx("option",{value:"",children:"-- اختر المورد --"}),N.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"المبلغ *"}),e.jsx(n,{type:"number",step:"0.01",value:t.amount,onChange:s=>a({...t,amount:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"تاريخ الشراء *"}),e.jsx(n,{type:"date",value:t.purchase_date,onChange:s=>a({...t,purchase_date:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"الحالة"}),e.jsxs("select",{value:t.status,onChange:s=>a({...t,status:s.target.value}),className:"w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-3 py-2 text-sm",children:[e.jsx("option",{value:"pending",children:"قيد الانتظار"}),e.jsx("option",{value:"completed",children:"مكتمل"}),e.jsx("option",{value:"cancelled",children:"ملغي"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"طريقة الدفع"}),e.jsxs("select",{value:t.payment_method,onChange:s=>a({...t,payment_method:s.target.value}),className:"w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-3 py-2 text-sm",children:[e.jsx("option",{value:"cash",children:"نقداً"}),e.jsx("option",{value:"bank_transfer",children:"تحويل بنكي"}),e.jsx("option",{value:"check",children:"شيك"})]})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(r,{children:"الوصف"}),e.jsx(n,{value:t.description,onChange:s=>a({...t,description:s.target.value})})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(r,{children:"ملاحظات"}),e.jsx(n,{value:t.notes,onChange:s=>a({...t,notes:s.target.value})})]}),e.jsxs("div",{className:"md:col-span-2 flex gap-2",children:[e.jsx(i,{type:"submit",children:o?"تحديث":"حفظ"}),e.jsx(i,{type:"button",variant:"outline",onClick:x,children:"إلغاء"})]})]})})]}),e.jsx(l,{children:e.jsx(d,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-right font-medium",children:"رقم الفاتورة"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium",children:"العنوان"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium",children:"المورد"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium",children:"المبلغ"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium",children:"التاريخ"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium",children:"الحالة"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium",children:"إجراءات"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:j.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"لا توجد مشتريات مسجلة"})}):j.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:s.purchaseNumber}),e.jsx("td",{className:"px-4 py-3",children:s.title}),e.jsx("td",{className:"px-4 py-3",children:s.supplierName}),e.jsxs("td",{className:"px-4 py-3 font-medium",children:[s.amount.toLocaleString()," ر.ع"]}),e.jsx("td",{className:"px-4 py-3",children:s.purchaseDate}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${B[s.status]||""}`,children:F[s.status]||s.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(i,{size:"sm",variant:"ghost",onClick:()=>f(s),children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx(i,{size:"sm",variant:"ghost",className:"text-red-500",onClick:()=>b(s.id),children:e.jsx(E,{className:"h-4 w-4"})})]})})]},s.id))})]})})})})]})]})}export{te as default};
